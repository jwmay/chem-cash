(this["webpackJsonpchem-cash"]=this["webpackJsonpchem-cash"]||[]).push([[0],{10:function(e,t,a){"use strict";(function(e){var n=a(439),r=a.n(n),o=a(440),c=a.n(o),s=r()(c.a,e.Promise),l="https://chem-cash.herokuapp.com/api",i=encodeURIComponent,u=function(e){return e.body},d=null,m=function(e){d&&e.set("authorization","Token ".concat(d))},p=function(e,t){return s.del("".concat(l).concat(e),t).use(m).then(u)},E=function(e){return s.get("".concat(l).concat(e)).use(m).then(u)},f=function(e,t){return s.post("".concat(l).concat(e),t).use(m).then(u)},b=function(e,t){return s.put("".concat(l).concat(e),t).use(m).then(u)},g={current:function(){return E("/user")},login:function(e,t){return f("/users/login",{user:{username:e,password:t}})},register:function(e){return f("/users",{user:e})},save:function(e){return b("/user",{user:e})}},h={add:function(e){return f("/bonuses",{bonus:e})},delete:function(e){return p("/bonuses/".concat(e._id))},getAll:function(){return E("/bonuses")},update:function(e){return b("/bonuses/".concat(e._id),{bonus:e})}},O={add:function(e){return f("/courses",{course:e})},delete:function(e){return p("/courses/".concat(e))},enroll:function(e){return f("/courses/".concat(e.slug,"/enroll"),{course:e})},getAll:function(){return E("/courses")},unenroll:function(e){return p("/courses/".concat(e.slug,"/enroll"),{course:e})},update:function(e){return b("/courses/".concat(e.slug),{course:e})}},v={clearAll:function(){return p("/notifications")},getAll:function(){return E("/notifications")}},y={add:function(e){return f("/products",{product:e})},delete:function(e){return p("/products/".concat(e))},getAll:function(){return E("/products")},update:function(e){return b("/products/".concat(e.slug),{product:e})}},j={add:function(e){return f("/purchases",{purchase:e})},delete:function(e){return p("/purchases/".concat(e))},forStudent:function(){return E("/purchases/student")},forTeacher:function(){return E("/purchases/teacher")},update:function(e){return b("/purchases/".concat(e.id),{purchase:e})}},S={getAll:function(){return E("/scores/all")},getStudentScores:function(e){return E("/scores?username=".concat(e))},import:function(e){return f("/scores/import",{data:e})}},A={update:function(e){return b("/user/settings",{settings:e})}},D={delete:function(e){return p("/songs/".concat(e))},forStudent:function(){return E("/songs/student")},forTeacher:function(){return E("/songs/teacher")},request:function(e){return f("/songs",{song:e})},update:function(e){return b("/songs/".concat(e.id),{song:e})}},C={getAuthUrl:function(){return E("/spotify/auth")},removeAuth:function(){return p("/spotify/auth")}},T={add:function(e,t){return f("/users?courseId=".concat(i(t)),{user:e})},delete:function(e){return p("/users/student/".concat(e.username))},import:function(e,t){return f("/users/import?courseId=".concat(i(t)),{users:e})},update:function(e){return b("/users/".concat(e.username),{user:e})}},N={getAll:function(e){return E("/tasks?courseId=".concat(e))},delete:function(e){return p("/tasks/".concat(e.slug))},update:function(e){return b("/tasks/".concat(e.slug),{task:e})}},_={getAll:function(){return E("/users?role=teacher")},delete:function(e){return p("/users/teacher/".concat(e.username))},resetFlags:function(e){return b("/users/reset?role=".concat(e))},update:function(e){return b("/users/".concat(e.username),{user:e})}},P={add:function(e){return f("/transactions",{transaction:e})},addMany:function(e){return f("/transactions/bulk",{transactions:e})},delete:function(e){return p("/transactions/".concat(e._id))},update:function(e){return b("/transactions/".concat(e._id),{transaction:e})}};t.a={Auth:g,Bonuses:h,Courses:O,Notifications:v,Products:y,Purchases:j,Scores:S,Settings:A,Songs:D,Spotify:C,Students:T,Tasks:N,Teachers:_,Transactions:P,setToken:function(e){d=e}}}).call(this,a(81))},278:function(e,t,a){e.exports=a.p+"static/media/chemistry-background.11d1d297.jpg"},434:function(e,t,a){e.exports=a.p+"static/media/chem-cash-logo.30174016.png"},442:function(e,t,a){e.exports=a.p+"static/media/songs-background.cfcd4ce6.jpg"},447:function(e,t,a){e.exports=a.p+"static/media/doc-may-profile.f927335d.jpg"},460:function(e,t,a){e.exports=a(573)},555:function(e,t){},557:function(e,t){},573:function(e,t,a){"use strict";a.r(t);var n=a(158),r=a(8),o=a(0),c=a.n(o),s=a(25),l=a.n(s),i=a(39),u=a(61),d=a(619),m=a(624),p=a(157),E=a(432),f=a.n(E),b=a(433),g=a.n(b),h=Object(p.a)({breakpoints:{values:{md:768,lg:1024}},palette:{primary:f.a,secondary:g.a},overrides:{MuiDialogActions:{root:{padding:"16px 24px"}}}}),O=h,v=a(600),y=a(320),j=a(599),S=a(387),A=a(93),D=a(321),C=a(434),T=a.n(C),N=function(e){return c.a.createElement("img",Object.assign({alt:"Chem Cash Logo",src:T.a},e))},_="ASYNC_START",P="LOGIN",w=Object(y.a)((function(e){return{title:{color:"white",flexGrow:1},logo:{height:65,marginTop:e.spacing(2),marginRight:e.spacing(3),marginBottom:e.spacing(2)}}})),U=Object(r.c)((function(e){return{navTabValue:e.nav.navTabValue}}),(function(e){return{onClickLogout:function(){return e({type:"LOGOUT"})}}}))((function(e){var t=w(),a=e.navTabValue;return e.currentUser?c.a.createElement(j.a,{position:"static"},c.a.createElement(v.a,null,c.a.createElement(S.a,null,c.a.createElement(N,{className:t.logo}),c.a.createElement(A.a,{variant:"h5",align:"center",className:t.title},a&&a.charAt(0).toUpperCase()+a.slice(1)),c.a.createElement(D.a,{color:"inherit",onClick:e.onClickLogout},"Logout")))):null})),R=a(601),k=a(602),x=a(603),L=a(604),I=a(605),q=a(606),B=a(607),F=a(608),G=Object(y.a)({nav:{position:"fixed",bottom:0,width:"100%",zIndex:"1000"}}),W=Object(r.c)((function(e){return{currentUser:e.common.currentUser,navTabValue:e.nav.navTabValue,path:e.router.location.pathname,settings:e.common.settings}}),(function(e){return{onLoad:function(t,a){return e({type:"NAV_LOADED",value:t,redirectTo:a})},onTabChange:function(t,a){return e({type:"NAV_TAB_CHANGE",value:t,redirectTo:a})},onUnload:function(){return e({type:"NAV_UNLOADED"})}}}))((function(e){var t=G(),a=e.currentUser.role,n={beta:e.settings.enableBetaFeatures,products:e.settings.productsEnabled,songs:e.settings.songRequestEnabled,store:e.settings.storeEnabled},r=function(t){e.onTabChange(t,"/".concat(a,"/").concat(t))};return Object(o.useEffect)((function(){var t=e.path.split("/")[2],r=null!==t&&void 0!==t?t:"student"===a?"account":"admin"===a?"teachers":"accounts",o="/".concat(a,"/").concat(r);return n.store&&"products"===r?e.onLoad("store",o):e.onLoad(r,o),function(){e.onUnload()}}),[]),"student"===a?c.a.createElement(R.a,{className:t.nav,onChange:function(e,t){return r(t)},showLabels:!0,value:e.navTabValue},c.a.createElement(k.a,{label:"Account",icon:c.a.createElement(x.a,null),value:"account"}),n.songs&&c.a.createElement(k.a,{label:"Songs",icon:c.a.createElement(L.a,null),value:"songs"}),(n.products||n.store)&&c.a.createElement(k.a,{label:n.store?"Store":"Products",icon:c.a.createElement(I.a,null),value:"store"}),c.a.createElement(k.a,{label:"Settings",icon:c.a.createElement(q.a,null),value:"settings"})):"admin"===a?c.a.createElement(R.a,{className:t.nav,onChange:function(e,t){return r(t)},showLabels:!0,value:e.navTabValue},c.a.createElement(k.a,{label:"Teachers",icon:c.a.createElement(B.a,null),value:"teachers"}),c.a.createElement(k.a,{label:"Settings",icon:c.a.createElement(q.a,null),value:"settings"})):c.a.createElement(R.a,{className:t.nav,onChange:function(e,t){return r(t)},showLabels:!0,value:e.navTabValue},c.a.createElement(k.a,{label:"Accounts",icon:c.a.createElement(x.a,null),value:"accounts"}),n.songs&&c.a.createElement(k.a,{label:"Songs",icon:c.a.createElement(L.a,null),value:"songs"}),(n.products||n.store)&&c.a.createElement(k.a,{label:n.store?"Store":"Products",icon:c.a.createElement(I.a,null),value:n.store?"store":"products"}),c.a.createElement(k.a,{label:"Courses",icon:c.a.createElement(F.a,null),value:"courses"}),c.a.createElement(k.a,{label:"Settings",icon:c.a.createElement(q.a,null),value:"settings"}))})),M=Object(y.a)((function(e){return{wrapper:{marginTop:e.spacing(4),marginBottom:e.spacing(11)}}})),H=function(e){var t=M();return c.a.createElement("div",{className:t.wrapper},e.children)},V=function(e){return c.a.createElement(H,null,c.a.createElement(v.a,null,c.a.createElement(A.a,{variant:"h2"},"Error 404: Page Not Found")))},z=Object(r.c)((function(e){return{currentUser:e.common.currentUser}}),(function(){return{}}))((function(e){return e.currentUser?c.a.createElement(i.b,{exact:!0,path:e.path,component:e.component}):c.a.createElement(i.a,{to:"/"})})),Y=a(28),Q=a.n(Y),K=a(40),J=a(2),$=a(14),Z=a(23),X=a(19),ee=a(611),te=a(150),ae=a(610),ne=a(262),re=a(263),oe=a(389),ce=a(612),se=a(7),le=function(e){var t=e.controlledBy,a=e.disabled,n=e.label,r=e.name,s=Object($.f)(),l=s.values,i=s.setFieldValue,u=Object($.e)({name:r,type:"checkbox"}),d=Object(se.a)(u,1)[0];return Object(o.useEffect)((function(){!0===l[t]&&i(r,!0)}),[l[t],i,r]),c.a.createElement($.a,Object.assign({component:Z.b,disabled:a,label:n},d))},ie=a(667),ue=Object(y.a)((function(e){return{alert:{width:"100%","&:not(:last-of-type)":{marginBottom:e.spacing(1)}},alertList:{marginBottom:e.spacing(2)}}})),de=function(e){var t=e.errors,a=ue();return t?c.a.createElement("div",{className:a.alertList},Object.keys(t).map((function(e){var n=e.replace(/([a-z0-9])([A-Z])/g,"$1 $2").toLowerCase();return c.a.createElement(ie.a,{className:a.alert,severity:"error",key:e},n," ",t[e])}))):null},me=Object(y.a)((function(e){return{headerLeft:{alignItems:"center",display:"flex"},headerRight:{alignItems:"center",display:"flex",justifyContent:"flex-end"},pageHeader:{marginBottom:e.spacing(4),"& button:not(:last-of-type)":{marginRight:e.spacing(2)}}}})),pe=function(e){var t=e.children,a=e.title,n=me();return c.a.createElement(ae.a,{container:!0,spacing:2,className:n.pageHeader},c.a.createElement(ae.a,{item:!0,xs:12,md:6,className:n.headerLeft},c.a.createElement(A.a,{variant:"h4"},a)),c.a.createElement(ae.a,{item:!0,xs:12,md:6,className:n.headerRight},t))},Ee=a(10),fe=Object(y.a)((function(e){return{icon:{marginRight:e.spacing(1)},paper:{padding:e.spacing(2),marginBottom:e.spacing(4)}}})),be=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.settings),{},{currentUser:e.common.currentUser,settings:e.common.settings})}),(function(e){return{onSubmitForm:function(t){return e({type:"SETTINGS_SAVED",payload:Promise.all([Ee.a.Auth.save(t),Ee.a.Settings.update(t)]),snackbar:{message:"Settings saved",variant:"success"}})},onUnload:function(){return e({type:"SETTINGS_PAGE_UNLOADED"})},onWhatsNewClick:function(){return e({type:"WHATS_NEW_DIALOG_LOADED",payload:Ee.a.Auth.save({viewedChanges:!1})})}}}))((function(e){var t,a,n,r,s,l,i=e.currentUser,u=e.errors,d=e.inProgress,m=e.onSubmitForm,p=e.onUnload,E=e.onWhatsNewClick,f=e.settings,b=fe();Object(o.useEffect)((function(){return function(){p()}}),[]);var g=function(e){var t=e.status,a=e.value;return"".concat(a," ").concat(t?"enabled":"disabled")};return c.a.createElement($.c,{enableReinitialize:!0,initialValues:{allowPurchasesWithInsufficientFunds:(null===f||void 0===f?void 0:f.allowPurchasesWithInsufficientFunds)||!1,defaultStudentPassword:(null===f||void 0===f?void 0:f.defaultStudentPassword)||"",enableBetaFeatures:(null===f||void 0===f?void 0:f.enableBetaFeatures)||!1,firstName:i.firstName,lastName:i.lastName,password:"",productsEnabled:(null===f||void 0===f?void 0:f.productsEnabled)||!1,schoolDistrict:f.schoolDistrict||"ccsd",score100:(null===f||void 0===f||null===(t=f.scoreConverter)||void 0===t?void 0:t[100])||1200,score90:(null===f||void 0===f||null===(a=f.scoreConverter)||void 0===a?void 0:a[90])||1e3,score80:(null===f||void 0===f||null===(n=f.scoreConverter)||void 0===n?void 0:n[80])||800,score70:(null===f||void 0===f||null===(r=f.scoreConverter)||void 0===r?void 0:r[70])||600,score60:(null===f||void 0===f||null===(s=f.scoreConverter)||void 0===s?void 0:s[60])||0,score50:(null===f||void 0===f||null===(l=f.scoreConverter)||void 0===l?void 0:l[50])||0,songRemovalPurchaseAmount:(null===f||void 0===f?void 0:f.songRemovalPurchaseAmount)||0,songRemovalRequestEnabled:(null===f||void 0===f?void 0:f.songRemovalRequestEnabled)||!1,songRemovalRefundAmount:(null===f||void 0===f?void 0:f.songRemovalRefundAmount)||0,songRequestEnabled:(null===f||void 0===f?void 0:f.songRequestEnabled)||!1,songRequestPurchaseAmount:(null===f||void 0===f?void 0:f.songRequestPurchaseAmount)||0,storeEnabled:(null===f||void 0===f?void 0:f.storeEnabled)||!1,taxRate:(null===f||void 0===f?void 0:f.taxRate)||0},validationSchema:X.c({allowPurchasesWithInsufficientFunds:X.a(),defaultStudentPassword:X.d(),enableBetaFeatures:X.a(),firstName:X.d(),lastName:X.d(),password:X.d(),productsEnabled:X.a(),schoolDistrict:X.d(),score100:X.b().typeError("Numbers only"),score90:X.b().typeError("Numbers only"),score80:X.b().typeError("Numbers only"),score70:X.b().typeError("Numbers only"),score60:X.b().typeError("Numbers only"),score50:X.b().typeError("Numbers only"),songRemovalPurchaseAmount:X.b().typeError("Numbers only"),songRemovalRequestEnabled:X.a(),songRemovalRefundAmount:X.b().typeError("Numbers only"),songRequestEnabled:X.a(),songRequestPurchaseAmount:X.b().typeError("Numbers only"),storeEnabled:X.a(),taxRate:X.b().typeError("Numbers only")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t,a){var n;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=Object(J.a)({},t)).password||"student"===i.role||delete n.password,"student"!==i.role&&(n.scoreConverter={100:t.score100,90:t.score90,80:t.score80,70:t.score70,60:t.score60,50:t.score50,40:0,30:0,20:0,10:0,0:0}),m(n),a.resetForm({values:Object(J.a)(Object(J.a)({},n),{},{password:""})});case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},(function(e){return c.a.createElement($.b,null,c.a.createElement(pe,{title:"Manage Account"},c.a.createElement(D.a,{onClick:E,size:"small"},"See What's New"),c.a.createElement(ee.a,{color:"primary",disabled:d,type:"sumbit",variant:"extended"},c.a.createElement(ce.a,{className:b.icon}),d?"Saving...":"Save settings")),c.a.createElement(de,{errors:u}),"teacher"===i.role&&c.a.createElement(te.a,{className:b.paper},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Song Requests")),c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement("label",null,c.a.createElement($.a,{component:Z.b,name:"songRequestEnabled",type:"checkbox"}),c.a.createElement(g,{status:e.values.songRequestEnabled,value:"Song requests"}))),e.values.songRequestEnabled&&c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement($.a,{component:Z.c,label:"Song request purchase amount",name:"songRequestPurchaseAmount",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h6",gutterBottom:!0},"Song Removal Requests")),c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement("label",null,c.a.createElement($.a,{component:Z.b,name:"songRemovalRequestEnabled",type:"checkbox"}),c.a.createElement(g,{status:e.values.songRemovalRequestEnabled,value:"Song removal requests"}))),e.values.songRemovalRequestEnabled&&c.a.createElement(c.a.Fragment,null,c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement($.a,{component:Z.c,label:"Song removal purchase amount",name:"songRemovalPurchaseAmount",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement($.a,{component:Z.c,label:"Song removal refund amount",name:"songRemovalRefundAmount",type:"number",variant:"outlined",fullWidth:!0}))))),"teacher"===i.role&&c.a.createElement(te.a,{className:b.paper},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Products and Online Purchases")),c.a.createElement(ae.a,{item:!0,xs:12,md:e.values.storeEnabled?6:12},c.a.createElement("label",null,c.a.createElement($.a,{component:Z.b,name:"storeEnabled",type:"checkbox"}),c.a.createElement(g,{status:e.values.storeEnabled,value:"Online purchases"}))),e.values.storeEnabled&&c.a.createElement(ae.a,{item:!0,xs:12,md:3},c.a.createElement($.a,{component:Z.c,label:"Tax rate",name:"taxRate",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("label",null,c.a.createElement(le,{controlledBy:"storeEnabled",disabled:e.values.storeEnabled,name:"productsEnabled"}),c.a.createElement(g,{status:e.values.productsEnabled,value:"Products page"}),e.values.storeEnabled&&c.a.createElement("em",null," (required for online purchases)"))),e.values.storeEnabled&&c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("label",null,c.a.createElement($.a,{component:Z.b,name:"allowPurchasesWithInsufficientFunds",type:"checkbox"}),c.a.createElement(g,{status:e.values.allowPurchasesWithInsufficientFunds,value:"Purchases with insufficient funds"}))))),"teacher"===i.role&&c.a.createElement(te.a,{className:b.paper},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Student Accounts")),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{component:Z.c,label:"Default student password",name:"defaultStudentPassword",type:"text",variant:"outlined",fullWidth:!0})))),"teacher"===i.role&&c.a.createElement(te.a,{className:b.paper},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Score Conversions")),c.a.createElement(ae.a,{item:!0,xs:12,md:2},c.a.createElement($.a,{component:Z.c,label:"100% and up",name:"score100",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:2},c.a.createElement($.a,{component:Z.c,label:"90% and up",name:"score90",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:2},c.a.createElement($.a,{component:Z.c,label:"80% and up",name:"score80",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:2},c.a.createElement($.a,{component:Z.c,label:"70% and up",name:"score70",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:2},c.a.createElement($.a,{component:Z.c,label:"60% and up",name:"score60",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:2},c.a.createElement($.a,{component:Z.c,label:"50% and up",name:"score50",type:"number",variant:"outlined",fullWidth:!0})))),"student"!==i.role&&c.a.createElement(te.a,{className:b.paper},c.a.createElement(ae.a,{container:!0,spacing:2,style:{alignItems:"center"}},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Account Details")),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{component:Z.c,label:"First name",name:"firstName",type:"text",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{component:Z.c,label:"Last name",name:"lastName",type:"text",variant:"outlined",fullWidth:!0})),"teacher"===i.role&&c.a.createElement(c.a.Fragment,null,c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement(ne.a,{fullWidth:!0},c.a.createElement(re.a,null,"School district"),c.a.createElement($.a,{component:Z.a,label:"School district",name:"schoolDistrict"},c.a.createElement(oe.a,{value:"ccsd"},"CCSD"),c.a.createElement(oe.a,{value:"evergreen"},"Evergreen")))),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("label",null,c.a.createElement($.a,{component:Z.b,name:"enableBetaFeatures",type:"checkbox"}),c.a.createElement(g,{status:e.values.enableBetaFeatures,value:"Beta features"})))))),c.a.createElement(te.a,{className:b.paper},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Account Security")),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{component:Z.c,label:"New password",name:"password",type:"password",variant:"outlined",fullWidth:!0})))))}))})),ge=a(24),he=a(36),Oe=a(52),ve=a.n(Oe),ye=a(640),je=a(647),Se=a(394),Ae=a(267),De=Object(y.a)((function(e){return{actionButton:{color:e.palette.text.disabled}}})),Ce=function(e){var t=e.action,a=e.children,n=e.className,r=e.disabled,o=e.onClick,s=e.size,l=De();return c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,title:t},c.a.createElement("span",null,c.a.createElement(Ae.a,{"aria-label":t,className:"".concat(l.actionButton," ").concat(n||""),disabled:r,onClick:function(e){e.stopPropagation(),o()},onFocus:function(e){return e.stopPropagation()},size:s},a)))},Te=a(27),Ne=a(592),_e=a(613),Pe=a(626),we=a(614),Ue=a(615),Re=a(642),ke=a(276),xe=function(e){var t=e.suffix,a=e.value;return c.a.createElement(ke.a,{displayType:"text",suffix:t||" pts",thousandSeparator:!0,value:Math.round(a)})},Le=Object(y.a)((function(e){return{insufficient:{backgroundColor:e.palette.error.light},sufficient:{backgroundColor:e.palette.success.light},root:{borderRadius:e.spacing(1),color:e.palette.common.white,padding:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px"),textAlign:"center"}}})),Ie=Object(r.c)((function(e){return Object(J.a)({},e.scores.balance)}),(function(e){return{onLoad:function(t){return e({type:"ACCOUNT_BALANCE_LOADED",payload:Ee.a.Scores.getStudentScores(t)})},onUnload:function(){return e({type:"ACCOUNT_BALANCE_UNLOADED"})}}}))((function(e){var t=e.balance,a=e.cost,n=e.count,r=e.onLoad,s=e.onUnload,l=e.username,i=Le();return Object(o.useEffect)((function(){return r(l),function(){s()}}),[]),Object(o.useEffect)((function(){r(l)}),[n,l]),c.a.createElement("div",{className:"".concat(i.root," ").concat(t>=a?i.sufficient:i.insufficient)},c.a.createElement(A.a,{variant:"h5"},c.a.createElement(xe,{value:t})),c.a.createElement(A.a,{variant:"subtitle2"},c.a.createElement("em",null,"Account Balance")))})),qe=a(322),Be=Object(y.a)((function(e){return{root:{backgroundColor:e.palette.grey[100],borderRadius:e.spacing(1),marginTop:e.spacing(2),padding:e.spacing(2)}}})),Fe=function(e){var t=e.label,a=e.name,n=e.onChange,r=Object(o.useState)(""),s=Object(se.a)(r,2),l=s[0],i=s[1],u=Be();return c.a.createElement("div",{className:u.root},c.a.createElement(qe.a,{fullWidth:!0,label:t,name:a,onChange:function(e){var t=e.target.value;n(t),i(t)},value:l}))},Ge=a(637),We=a(407),Me=a(402),He=a(398),Ve=a(393),ze=a(397),Ye=a(282),Qe=a(638),Ke=a(639),Je=a(641),$e=a(669),Ze=a(179),Xe=a.n(Ze),et=a(180),tt=a.n(et),at=Object(r.c)((function(e){return Object(J.a)({},e.products)}),(function(e){return{onLoad:function(){return e({type:"PRODUCT_SELECTOR_LOADED",payload:Ee.a.Products.getAll()})},onUnload:function(){return e({type:"PRODUCT_SELECTOR_UNLOADED"})}}}))((function(e){var t=e.allowAny,a=e.onChange,n=e.onLoad,r=e.onUnload,s=e.products;Object(o.useEffect)((function(){return n(),function(){r()}}),[]);var l=s.map((function(e){return Object(J.a)(Object(J.a)({},e),{},{status:e.quantity>0?"In Stock":"Out of Stock"})})).sort((function(e,t){return-t.status.localeCompare(e.status)}));return c.a.createElement($e.a,{autoHighlight:!0,freeSolo:null===t||void 0===t||t,getOptionLabel:function(e){return e.name},getOptionSelected:function(e,t){return e._id===t._id},groupBy:function(e){return e.status},noOptionsText:"No products have been added",onInputChange:function(e,t){a(t)},onChange:function(e,t){a(t)},options:l,renderInput:function(e){return c.a.createElement(qe.a,Object.assign({},e,{label:"Description",placeholder:"Type or select a product",required:!0}))},renderOption:function(e,t){var a=t.inputValue,n=tt()(e.name,a),r=Xe()(e.name,n);return c.a.createElement("div",null,r.map((function(e,t){return c.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})))}})})),nt=function(e,t,a){if(e&&t){var n=e.map((function(e){return{desc:e.name,imgUrl:e.photoUrl,max:e.maxPurchaseQuantity,onHand:e.quantity,price:t[e._id]*e.cost,qty:t[e._id],unit:e.cost,_id:e._id}})),r=n.map((function(e){return e.price})).reduce((function(e,t){return e+t}),0),o=a/100*r;return{items:n,invoice:{subtotal:r,taxes:o,total:o+r}}}return{}},rt=function(e){if(e.includes("drive.google.com")){var t=e.match(/file\/d\/(.*)\/view*/);if(null!==t)return"https://drive.google.com/uc?export=view&id=".concat(t[1])}return e},ot=function(e,t){var a=e.task.totalPoints,n=e.task.multiplier,r=0===a?1:a,o=Math.round(e.value/r*100);return t[10*Math.floor((o>100?100:o)/10)]*n},ct=Object(y.a)((function(e){return{emptyCart:{textAlign:"center"},icon:{marginRight:e.spacing(1)},tableCellImg:{alignItems:"center",display:"flex","& img":{height:"50px",marginRight:e.spacing(2)}}}})),st=Object(r.c)((function(e){return Object(J.a)({},e.common.settings)}),{})((function(e){var t=e.actions,a=e.products,n=e.quantities,r=e.taxRate,s=ct(),l=nt(a,n,r),i=l.items,u=l.invoice,d=Object(o.useState)(!1),m=Object(se.a)(d,2),p=m[0],E=m[1],f=Object(o.useState)({}),b=Object(se.a)(f,2),g=b[0],h=b[1],O=function(){E(!p),h({})},v=function(e){return t.update(e.target.name,e.target.value)};return Object(o.useEffect)((function(){t&&t.hasOwnProperty("setInvoice")&&t.setInvoice(u)}),[a,n,r]),c.a.createElement(Ge.a,null,c.a.createElement(We.a,null,c.a.createElement(Me.a,null,c.a.createElement(He.a,null,c.a.createElement(Ve.a,{align:"center",colSpan:3},"Purchase Details"),c.a.createElement(Ve.a,{align:"right"},"Cost")),c.a.createElement(He.a,null,c.a.createElement(Ve.a,null,"Items"),c.a.createElement(Ve.a,{align:"right"},"Quantity"),c.a.createElement(Ve.a,{align:"right"},"Item Cost"),c.a.createElement(Ve.a,{align:"right"},"Total Cost"))),c.a.createElement(ze.a,null,i.length>0?i.map((function(e){return c.a.createElement(He.a,{key:e.desc},c.a.createElement(Ve.a,{className:s.tableCellImg},c.a.createElement("img",{height:"50px",src:rt(e.imgUrl)}),e.desc),c.a.createElement(Ve.a,{align:"right"},t?c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Remove from cart",onClick:function(){return a=e._id,t.delete(a);var a}},c.a.createElement(Qe.a,null)),c.a.createElement(Ye.a,{name:e._id,onChange:v,value:e.qty},function(e){for(var t=0===e?100:e,a=[],n=1;n<=t;n++)a.push(c.a.createElement(oe.a,{value:n,key:n},n));return a}(e.onHand<e.max||0===e.max?e.onHand:e.max))):e.qty),c.a.createElement(Ve.a,{align:"right"},c.a.createElement(xe,{value:e.unit})),c.a.createElement(Ve.a,{align:"right"},c.a.createElement(xe,{value:e.price})))})):c.a.createElement(He.a,null,c.a.createElement(Ve.a,{colSpan:4,className:s.emptyCart},"Your cart is empty")),p&&c.a.createElement(He.a,null,c.a.createElement(Ve.a,{colSpan:3},c.a.createElement(at,{allowAny:!1,onChange:function(e){return h(e||{})}})),c.a.createElement(Ve.a,{align:"right"},c.a.createElement(Ce,{action:"Add to cart",disabled:!g.hasOwnProperty("name"),onClick:function(){t.add(g),O()}},c.a.createElement(Ke.a,null)),c.a.createElement(Ce,{action:"Cancel",onClick:O},c.a.createElement(ye.a,null)))),c.a.createElement(He.a,null,c.a.createElement(Ve.a,{rowSpan:3},t&&t.hasOwnProperty("add")&&c.a.createElement(D.a,{color:"primary",disabled:p,onClick:O,size:"small",variant:"outlined"},c.a.createElement(Je.a,{className:s.icon}),"Add item")),c.a.createElement(Ve.a,{colSpan:2},"Subtotal"),c.a.createElement(Ve.a,{align:"right"},c.a.createElement(xe,{value:u.subtotal}))),c.a.createElement(He.a,null,c.a.createElement(Ve.a,null,"Taxes & Fees"),c.a.createElement(Ve.a,{align:"right"},"".concat(r,"%")),c.a.createElement(Ve.a,{align:"right"},c.a.createElement(xe,{value:u.taxes}))),c.a.createElement(He.a,null,c.a.createElement(Ve.a,{colSpan:2},"Total"),c.a.createElement(Ve.a,{align:"right"},c.a.createElement(xe,{value:u.total}))))))})),lt=Object(r.c)((function(e){return Object(J.a)({},e.purchases)}),(function(e){return{onAddItem:function(t){return e({type:"ADD_TO_CART",product:t})},onDeleteItem:function(t){return e({type:"DELETE_CART_PRODUCT",productId:t})},onExit:function(){return e({type:"ADD_PURCHASE_DIALOG_UNLOADED"})},onSubmit:function(t){return e({type:"ADD_PURCHASE",payload:Ee.a.Purchases.add(t),snackbar:{message:"Purchase added",variant:"success"}})},onUpdateItem:function(t,a){return e({type:"UPDATE_CART_PRODUCT_QUANTITY",productId:t,qty:a})}}}))((function(e){var t=e.cart,a=e.errors,n=e.inProgress,r=e.onAddItem,s=e.onDeleteItem,l=e.onExit,i=e.onSubmit,u=e.onUpdateItem,d=e.student,m=Object(o.useState)(!1),p=Object(se.a)(m,2),E=p[0],f=p[1],b=Object(o.useState)({}),g=Object(se.a)(b,2),h=g[0],O=g[1],v=Object(o.useState)(""),y=Object(se.a)(v,2),j=y[0],S=y[1],A=Object(Te.a)(),C=Object(Ne.a)(A.breakpoints.down("md")),T=function(){f(!1),O({}),S("")};return Object(o.useEffect)((function(){n||a||f(!1)}),[n]),c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Add purchase",onClick:function(){return f(!0)}},c.a.createElement(Re.a,null)),c.a.createElement(_e.a,{fullScreen:C,fullWidth:!0,maxWidth:"md",onClick:function(e){return e.stopPropagation()},onClose:T,onExit:l,onFocus:function(e){return e.stopPropagation()},open:E},c.a.createElement(Pe.a,null,"Add Purchase"),c.a.createElement(we.a,null,c.a.createElement(de,{errors:a}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(st,{actions:{add:r,delete:s,setInvoice:function(e){return O(e)},update:u},products:t.products,quantities:t.quantities}),c.a.createElement(Fe,{label:"Notes (optional)",name:"purchaseNote",onChange:S})))),c.a.createElement(Ue.a,null,c.a.createElement("div",{style:{marginRight:"auto"}},c.a.createElement(Ie,{cost:h.total,username:d.username})),c.a.createElement(D.a,{disabled:n||0===t.products.length,color:"primary",onClick:function(){i({note:j,products:t.products,quantities:t.quantities,status:"approved",student:d}),T()},type:"submit",variant:"contained"},n?"Adding...":"Add"),c.a.createElement(D.a,{disabled:n,onClick:T,variant:"contained"},"Cancel"))))})),it=a(643),ut=Object(y.a)((function(e){return{alert:{"&:not(:last-of-type)":{marginBottom:e.spacing(2)}}}})),dt=Object(r.c)((function(e){return Object(J.a)({},e.notifications)}),(function(e){return{onLoad:function(){return e({type:"NOTIFICATION_DIALOG_LOADED",payload:Ee.a.Notifications.getAll()})},onUnload:function(){return e({type:"NOTIFICATION_DIALOG_UNLOADED",payload:Ee.a.Notifications.clearAll()})}}}))((function(e){var t=e.errors,a=e.notifications,n=e.onLoad,r=e.onUnload,s=Object(o.useState)(!1),l=Object(se.a)(s,2),i=l[0],u=l[1],d=ut(),m=Object(Te.a)(),p=Object(Ne.a)(m.breakpoints.down("md")),E=function(){u(!1),r()};return Object(o.useEffect)((function(){n()}),[]),Object(o.useEffect)((function(){a.length>0&&u(!0)}),[a]),c.a.createElement(_e.a,{fullScreen:p,fullWidth:!0,maxWidth:"md",open:i,onClose:E,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Notification Center"),c.a.createElement(we.a,null,c.a.createElement(de,{errors:t}),a.length>0?a.map((function(e,t){return c.a.createElement(ie.a,{className:d.alert,key:t,severity:e.type},c.a.createElement(it.a,null,e.title),e.content)})):c.a.createElement(ie.a,{severity:"info"},c.a.createElement(it.a,null,"All caught up!"),"You have no notifications at this time")),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{onClick:E,variant:"contained"},"Close")))})),mt=a(625),pt=a(644),Et=Object(r.c)((function(e){return{defaultStudentPassword:e.common.settings.defaultStudentPassword}}),(function(e){return{onSubmit:function(t){return e({type:"RESET_STUDENT_PASSWORD",payload:Ee.a.Students.update(t),snackbar:{message:"Password reset",variant:"success"}})}}}))((function(e){var t=e.btnSize,a=e.defaultStudentPassword,n=e.onSubmit,r=e.student,s=Object(o.useState)(!1),l=Object(se.a)(s,2),i=l[0],u=l[1],d=function(){u(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Reset password",onClick:function(){u(!0)},size:null!==t&&void 0!==t?t:"small"},c.a.createElement(pt.a,{fontSize:"inherit"})),c.a.createElement(_e.a,{open:i,onClose:d,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Reset Password"),c.a.createElement(we.a,null,c.a.createElement(mt.a,null,"Do you want to reset"," ",c.a.createElement("b",null,r.firstName," ",r.lastName),"'s password to ",c.a.createElement("strong",null,a),"?")),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{onClick:function(){var e=Object(J.a)(Object(J.a)({},r),{},{password:a});n(e),u(!1)},color:"primary",variant:"contained",autoFocus:!0},"Reset"),c.a.createElement(D.a,{onClick:d,variant:"contained"},"Cancel"))))})),ft=a(645),bt=a(646),gt=function(e){var t=e.allowAny,a=e.bonuses,n=e.onChange;return c.a.createElement($e.a,{autoHighlight:!0,freeSolo:null===t||void 0===t||t,getOptionLabel:function(e){return e.description},getOptionSelected:function(e,t){return e._id===t._id},noOptionsText:"No bonuses have been added",onInputChange:function(e,t){n(t)},onChange:function(e,t){n(t)},options:a,renderInput:function(e){return c.a.createElement(qe.a,Object.assign({},e,{label:"Description",placeholder:"Type or select a bonus",required:!0}))},renderOption:function(e,t){var a=t.inputValue,n=tt()(e.description,a),r=Xe()(e.description,n);return c.a.createElement("div",null,r.map((function(e,t){return c.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})))}})},ht=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.scores),{},{bonuses:e.bonuses.bonuses,products:e.products.products,taxRate:e.common.settings.taxRate})}),(function(e){return{onAdd:function(t){return e({type:"ADD_TRANSACTION",payload:Ee.a.Transactions.add(t),snackbar:{message:"".concat(t.typeTitle," added"),variant:"success"}})},onExit:function(){return e({type:"TRANSACTION_DIALOG_UNLOADED"})}}}))((function(e){var t=e.bonuses,a=e.errors,n=e.inProgress,r=e.onAdd,s=e.onExit,l=e.student,i=e.taxRate,u=e.type,d=Object(o.useState)(!1),m=Object(se.a)(d,2),p=m[0],E=m[1],f=Object(Te.a)(),b=Object(Ne.a)(f.breakpoints.down("md")),g=function(){E(!1)},h=function(e){r(Object(J.a)(Object(J.a)({},e),{},{student:l,type:u.toLowerCase(),typeTitle:u}))};return Object(o.useEffect)((function(){n||a||E(!1)}),[n]),c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Add ".concat("Purchase"===u?"quick":""," ").concat(u.toLowerCase()),onClick:function(){E(!0)}},"Bonus"===u&&c.a.createElement(ft.a,null),"Purchase"===u&&c.a.createElement(bt.a,null)),c.a.createElement(_e.a,{fullScreen:b,fullWidth:!0,maxWidth:"md",onClick:function(e){return e.stopPropagation()},onClose:g,onExit:s,onFocus:function(e){return e.stopPropagation()},open:p},c.a.createElement($.c,{initialValues:{amount:"",description:"",productId:""},validationSchema:X.c({amount:X.b().typeError("Numbers only").required("Required"),description:X.d().required("Required"),productId:X.d()}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},(function(e){return c.a.createElement($.b,null,c.a.createElement(Pe.a,null,"Add ","Purchase"===u&&"Quick"," ",u),c.a.createElement(we.a,null,c.a.createElement(de,{errors:a}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:6},"Bonus"===u?c.a.createElement(gt,{bonuses:t,onChange:function(t){"string"===typeof t?e.setFieldValue("description",t):t&&"object"===typeof t?(e.setFieldValue("amount",t.amount),e.setFieldValue("description",t.description)):(e.setFieldValue("amount",""),e.setFieldValue("description",""))}}):c.a.createElement(at,{onChange:function(t){var a;"string"===typeof t?e.setFieldValue("description",t):t&&"object"===typeof t?(e.setFieldValue("amount",(a=t.cost,Math.round(a*(i/100+1)))),e.setFieldValue("description",t.name),e.setFieldValue("productId",t._id)):(e.setFieldValue("amount",""),e.setFieldValue("description",""))}})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:n,label:"Amount",name:"amount",type:"text",fullWidth:!0})))),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{disabled:n,color:"primary",type:"submit",variant:"contained"},n?"Adding...":"Add"),c.a.createElement(D.a,{disabled:n,onClick:g,variant:"contained"},"Cancel")))}))))})),Ot=Object(y.a)((function(e){return{actions:Object(he.a)({alignItems:"flex-start",display:"flex"},e.breakpoints.up("lg"),{justifyContent:"flex-end"}),balance:{textAlign:"center","& > h6":{borderTop:"1px solid #ccc",fontStyle:"italic",textTransform:"lowercase"}},edit:{backgroundColor:e.palette.primary.main},paper:{padding:e.spacing(2)},subtotal:{position:"relative",textAlign:"center","& > p":{position:"relative",bottom:-e.spacing(1)},"& > h6":{fontSize:e.typography.pxToRem(12),fontStyle:"italic",textTransform:"lowercase"}},unit:{fontSize:e.typography.pxToRem(12)}}})),vt=function(e){var t=e.doEdit,a=e.onEditClick,n=e.storeEnabled,r=e.student,o=e.total,s=e.userRole,l=Ot();return c.a.createElement(te.a,{className:l.paper},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement(A.a,{gutterBottom:!0,variant:"h5"},r.firstName," ",r.lastName),r.course&&c.a.createElement(A.a,{gutterBottom:!0,color:"textSecondary",variant:"subtitle1"},r.course," \xb7 Period ",r.period),c.a.createElement(A.a,{color:"textSecondary",variant:"subtitle2"},r.username)),c.a.createElement(ae.a,{item:!0,xs:12,md:4,container:!0},c.a.createElement(ae.a,{item:!0,xs:12,className:l.balance},c.a.createElement(A.a,{color:(null===o||void 0===o?void 0:o.balance)>=0?"primary":"secondary",variant:"h4"},c.a.createElement(xe,{suffix:" ",value:null===o||void 0===o?void 0:o.balance}),c.a.createElement("span",{className:l.unit},"pts")),c.a.createElement(A.a,{color:"textSecondary",variant:"subtitle2"},"Balance")),c.a.createElement(ae.a,{item:!0,xs:4,className:l.subtotal},c.a.createElement(A.a,{color:"primary",variant:"body1"},c.a.createElement(xe,{suffix:" ",value:null===o||void 0===o?void 0:o.bonuses}),c.a.createElement("span",{className:l.unit},"pts")),c.a.createElement(A.a,{color:"primary",variant:"subtitle2"},"Bonuses")),c.a.createElement(ae.a,{item:!0,xs:4,className:l.subtotal},c.a.createElement(A.a,{color:"secondary",variant:"body1"},c.a.createElement(xe,{suffix:" ",value:null===o||void 0===o?void 0:o.purchases}),c.a.createElement("span",{className:l.unit},"pts")),c.a.createElement(A.a,{color:"secondary",variant:"subtitle2"},"Purchases")),c.a.createElement(ae.a,{item:!0,xs:4,className:l.subtotal},c.a.createElement(A.a,{color:"primary",variant:"body1"},c.a.createElement(xe,{suffix:" ",value:null===o||void 0===o?void 0:o.scores}),c.a.createElement("span",{className:l.unit},"pts")),c.a.createElement(A.a,{color:"primary",variant:"subtitle2"},"Assessments"))),c.a.createElement(ae.a,{item:!0,xs:12,md:4,className:l.actions},"teacher"===s?c.a.createElement(c.a.Fragment,null,c.a.createElement(ht,{student:r,type:"Bonus"}),c.a.createElement(ht,{student:r,type:"Purchase"}),n&&c.a.createElement(lt,{student:r}),c.a.createElement(Ce,{action:t?"Finish editing":"Edit transactions",className:t&&l.edit,onClick:a},t?c.a.createElement(ye.a,null):c.a.createElement(je.a,null)),c.a.createElement(Et,{btnSize:"medium",student:r})):c.a.createElement(dt,null))))},yt=function(e){var t=e.conversions,a=e.doEdit,n=e.onDelete,r=e.onUpdate,s=e.transactions,l=Object(o.useState)([]),i=Object(se.a)(l,2),u=i[0],d=i[1],m=function(e){return{amount:e.amount,createdAt:new Date(e.createdAt).toDateString(),description:e.description,type:e.type,_id:e._id}},p=function(e){var n=e.bonuses,r=e.purchases,o=e.scores,c=[].concat(Object(ge.a)(n.map((function(e){return m(e)}))),Object(ge.a)(r.map((function(e){return m(e)}))));return a?c:[].concat(Object(ge.a)(c),Object(ge.a)(o.map((function(e){return function(e){return{amount:ot(e,t),createdAt:new Date(e.createdAt).toDateString(),description:e.task.title,type:"assessment"}}(e)}))))},E=Object(o.useState)([{title:"Date",field:"createdAt",editable:"never",defaultSort:"desc"},{title:"Description",field:"description"},{title:"Amount",field:"amount",render:function(e){return c.a.createElement(xe,{value:e.amount})}},{title:"Type",field:"type",editable:"never"}]),f=Object(se.a)(E,1)[0];return Object(o.useEffect)((function(){s&&d(p(s))}),[a,s]),c.a.createElement(ve.a,{columns:f,data:u,localization:{body:{emptyDataSourceMessage:a?"No editable transactions available":"No transactions have posted",editRow:{deleteText:"Delete this transaction?"}}},options:{actionsColumnIndex:-1,paging:!1,toolbar:!1},editable:a?{onRowUpdate:function(e,t){return new Promise((function(a,n){var o=Object(ge.a)(u);o[t.tableData.id]=e,d(Object(ge.a)(o)),r(e),a()}))},onRowDelete:function(e){return new Promise((function(t,a){var r=Object(ge.a)(u),o=e.tableData.id;r.splice(o,1),d(Object(ge.a)(r)),n(e),t()}))}}:{}})},jt=Object(r.c)((function(e){return{conversions:e.scores.conversions,storeEnabled:e.common.settings.storeEnabled,total:e.scores.total,transactions:e.scores.transactions,userRole:e.common.currentUser.role}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_TRANSACTION",payload:Ee.a.Transactions.delete(t),snackbar:{message:"Transaction deleted",variant:"success"}})},onLoad:function(t){return e({type:"ACCOUNT_VIEW_LOADED",payload:Ee.a.Scores.getStudentScores(t)})},onUnload:function(){return e({type:"ACCOUNT_VIEW_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_TRANSACTION",payload:Ee.a.Transactions.update(t),snackbar:{message:"Transaction updated",variant:"success"}})}}}))((function(e){var t=e.conversions,a=e.onDelete,n=e.onLoad,r=e.onUnload,s=e.onUpdate,l=e.storeEnabled,i=e.student,u=e.total,d=e.transactions,m=e.userRole,p=Object(o.useState)(!1),E=Object(se.a)(p,2),f=E[0],b=E[1];return Object(o.useEffect)((function(){return function(){r()}}),[]),Object(o.useEffect)((function(){n(i.username)}),[i]),c.a.createElement(c.a.Fragment,null,d&&c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(vt,{doEdit:f,onEditClick:function(){b(!f)},storeEnabled:l,student:i,total:u,userRole:m})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(yt,{conversions:t,doEdit:f,onDelete:a,onUpdate:s,transactions:d}))))})),St=Object(r.c)((function(e){return{currentUser:e.common.currentUser}}),(function(){return{}}))((function(e){var t=e.currentUser;return c.a.createElement(jt,{student:t})})),At=a(323),Dt=a(280),Ct=a(648),Tt=a(442),Nt=a.n(Tt),_t=Object(y.a)((function(e){return{button:{marginBottom:e.spacing(2),marginRight:e.spacing(2)},dialog:{backgroundImage:"url(".concat(Nt.a,")"),backgroundPosition:"center bottom",backgroundSize:"cover",color:"white",padding:e.spacing(4)},icon:{marginRight:e.spacing(1)},input:{backgroundColor:"rgba(0,65,91,0.8)",borderRadius:e.spacing(1),height:78,"& input":{color:e.palette.secondary.main}},inputLabel:{color:"white"}}})),Pt=Object(r.c)((function(e){return{settings:e.common.settings}}),(function(e){return{onSubmit:function(t){return e({type:"SUBMIT_SONG_REQUEST",payload:Ee.a.Songs.request(t),snackbar:{message:"Song requested",variant:"success"}})}}}))((function(e){var t=e.onSubmit,a=e.settings,n=Object(o.useState)(!1),r=Object(se.a)(n,2),s=r[0],l=r[1],i=Object(Te.a)(),u=Object(Ne.a)(i.breakpoints.down("md")),d=_t(),m=function(){l(!1)},p=function(e){t(e),l(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(ee.a,{color:"primary",onClick:function(){l(!0)},variant:"extended"},c.a.createElement(Je.a,{className:d.icon}),"Buy a song"),c.a.createElement(_e.a,{classes:{paper:d.dialog},fullScreen:u,open:s,onClose:m},c.a.createElement(A.a,{variant:"h3",align:"center",color:"secondary",gutterBottom:!0},"Purchase a Song"),c.a.createElement(A.a,{variant:"body1",gutterBottom:!0},"Please provide the song and artist title for your request. If approved, ",a.songRequestPurchaseAmount," points will be charged to your account."),c.a.createElement($.c,{initialValues:{artist:"",title:""},validationSchema:X.c({artist:X.d().required("Required"),title:X.d().required("Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement($.b,null,c.a.createElement(ae.a,{container:!0,spacing:4},c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{autoFocus:!0,className:d.input,color:"primary",component:Z.c,InputLabelProps:{classes:{root:d.inputLabel}},label:"Song Title",name:"title",type:"text",variant:"filled",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{className:d.input,color:"primary",component:Z.c,InputLabelProps:{classes:{root:d.inputLabel}},label:"Artist",name:"artist",type:"text",variant:"filled",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(D.a,{className:d.button,color:"primary",type:"submit",variant:"contained"},"Buy"),c.a.createElement(D.a,{className:d.button,onClick:m,variant:"contained"},"Cancel")))))))})),wt=Object(y.a)((function(e){return{icon:{marginLeft:e.spacing(1)},paper:{paddingLeft:e.spacing(2),marginBottom:e.spacing(4)},status:{alignItems:"center",display:"flex"}}})),Ut=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.songs),{},{currentUser:e.common.currentUser,settings:e.common.settings})}),(function(e){return{onDelete:function(t){return e({type:"SUBMIT_SONG_REMOVAL_REQUEST",payload:Ee.a.Songs.update(t),snackbar:{message:"Song removal request submitted",variant:"success"}})},onLoad:function(){return e({type:"STUDENT_SONGS_PAGE_LOADED",payload:Ee.a.Songs.forStudent()})},onUnload:function(){return e({type:"SONGS_PAGE_UNLOADED"})}}}))((function(e){var t=e.course,a=e.courseSongs,n=e.currentUser,r=e.onDelete,s=e.onLoad,l=e.onUnload,i=e.settings,u=e.userSongs,d=Object(o.useState)(!0),m=Object(se.a)(d,2),p=m[0],E=m[1],f=Object(o.useState)([]),b=Object(se.a)(f,2),g=b[0],h=b[1],O=Object(o.useState)([]),v=Object(se.a)(O,2),y=v[0],j=v[1],S=wt();return Object(o.useEffect)((function(){return s(),function(){return l()}}),[]),Object(o.useEffect)((function(){j([{title:"Request Date",field:"createdAt",editable:"never"},{title:"Song Title",field:"title"},{title:"Song Artist",field:"artist"}].concat(Object(ge.a)(p?[]:[{title:"Purchased by",field:"purchasedBy",editable:"never"}]),[{title:"Status",field:"status",lookup:{approved:"approved",pending:"pending",pendingApproval:"pending approval",pendingRemoval:"pending removal",rejected:"rejected",removed:"removed"},render:function(e,t){return"row"===t?c.a.createElement("span",{style:{alignItems:"center",display:"flex"}},e.statusDescription?c.a.createElement(c.a.Fragment,null,e.status,c.a.createElement(Se.a,{arrow:!0,color:"primary",enterTouchDelay:0,title:e.statusDescription},c.a.createElement(Ct.a,{style:{marginLeft:"8px"}}))):e.status):c.a.createElement("span",null,e)}}])),h((p?u:a).map((function(e){return{createdAt:new Date(e.createdAt).toDateString(),title:e.title,artist:e.artist,purchasedBy:"".concat(e.student.firstName," ").concat(e.student.lastName),status:e.status,statusDescription:e.statusDescription,_id:e._id}})))}),[a,p,u]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Songs for "+(p?n.firstName:"Period "+t.period)},c.a.createElement(Pt,null)),c.a.createElement(te.a,{className:S.paper},c.a.createElement(ae.a,{container:!0,spacing:2,className:S.grid},c.a.createElement(ae.a,{item:!0,xs:12,className:S.grid},c.a.createElement(At.a,{control:c.a.createElement(Dt.a,{checked:p,onChange:function(e){E(e.target.checked)},name:"mySongsOnly"}),label:"show only my songs"})))),c.a.createElement(ve.a,{title:"Class Playlist",columns:y,data:g,localization:{body:{emptyDataSourceMessage:"No songs have been added to this class playlist",editRow:{deleteText:"Delete this song for ".concat(i.songRemovalPurchaseAmount," points?"),saveTooltip:"Delete song"}}},options:{actionsColumnIndex:-1,paging:!1,toolbar:!1},editable:{isDeletable:function(e){return"approved"===e.status},isDeleteHidden:function(){return!i.songRemovalRequestEnabled},onRowDelete:function(e){return new Promise((function(t){r({id:e._id,status:"pending removal",statusDescription:""}),t()}))}}}))})),Rt=a(590),kt=Object(y.a)((function(e){return{alert:{marginBottom:e.spacing(2)}}})),xt=Object(r.c)((function(){return{}}),(function(e){return{onClose:function(){return e({type:"ALERT_CLOSED"})}}}))((function(e){var t=e.children,a=e.disableClose,n=e.onClose,r=e.severity,s=e.variant,l=kt(),i=Object(o.useState)(!0),u=Object(se.a)(i,2),d=u[0],m=u[1];return c.a.createElement("div",{className:l.alert},c.a.createElement(Rt.a,{in:d},c.a.createElement(ie.a,{action:!a&&c.a.createElement(Ae.a,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){m(!1),n()}},c.a.createElement(ye.a,{fontSize:"inherit"})),severity:r||"info",variant:s||"outlined"},t)))})),Lt=a(649),It=a(650),qt=a(651),Bt=a(652),Ft=a(653),Gt=a(654),Wt=a(655),Mt=a(429),Ht=function(e){var t=e.accounts,a=Object(o.useState)([]),n=Object(se.a)(a,2),r=n[0],s=n[1],l=t.map((function(e){return{accountTotal:e.totals.account,assessmentTotal:e.totals.assessments,bonusTotal:e.totals.bonuses,course:e.course,firstName:e.firstName,id:e.id,lastName:e.lastName,period:e.period,purchaseTotal:e.totals.purchases,songTotal:e.totals.songs}})),i=Object(o.useState)([{title:"First Name",field:"firstName"},{title:"Last Name",field:"lastName"},{title:"Period",field:"period",render:function(e,t){return"row"===t?c.a.createElement(Mt.a,{label:e.period,color:"secondary"}):c.a.createElement(Mt.a,{label:e,color:"secondary"})}},{title:"Account Total",field:"accountTotal",render:function(e,t){return"row"===t?c.a.createElement(xe,{suffix:" ",value:e.accountTotal}):c.a.createElement(xe,{value:e})}},{title:"Assessment Total",field:"assessmentTotal",render:function(e,t){return"row"===t?c.a.createElement(xe,{suffix:" ",value:e.assessmentTotal}):c.a.createElement(xe,{value:e})}},{title:"Bonus Total",field:"bonusTotal",render:function(e,t){return"row"===t?c.a.createElement(xe,{suffix:" ",value:e.bonusTotal}):c.a.createElement(xe,{value:e})}},{title:"Purchase Total",field:"purchaseTotal",render:function(e,t){return"row"===t?c.a.createElement(xe,{suffix:" ",value:e.purchaseTotal}):c.a.createElement(xe,{value:e})}},{title:"Song Total",field:"songTotal"}]),u=Object(se.a)(i,1)[0];return Object(o.useEffect)((function(){s(l)}),[t]),c.a.createElement(ve.a,{columns:u,data:r,options:{grouping:!0,paging:!1,toolbar:!1},style:{boxShadow:"none"},title:"Account Summary"})},Vt=a(391),zt=Object(y.a)((function(e){return{message:{fontStyle:"italic"},root:{alignItems:"center",display:"flex",justifyContent:"center",minWidth:e.spacing(40)},spinner:{marginRight:e.spacing(2)}}})),Yt=function(e){var t=e.message,a=zt();return c.a.createElement("div",{className:a.root},c.a.createElement(Vt.a,{className:a.spinner}),c.a.createElement(A.a,{className:a.message},t||"Working..."))},Qt=a(622),Kt=a(623),Jt=a(670),$t=Object(y.a)((function(e){return{statAvatar:{backgroundColor:e.palette.primary.main,height:e.spacing(6),marginBottom:e.spacing(2),width:e.spacing(6)},statCard:{alignItems:"center",display:"flex",flexFlow:"column nowrap",justifyContent:"center"}}})),Zt=function(e){var t=e.children,a=e.icon,n=e.title,r=e.value,o=$t();return c.a.createElement(ae.a,{item:!0,xs:12,md:6,lg:4},c.a.createElement(Qt.a,{variant:"outlined"},c.a.createElement(Kt.a,{className:o.statCard},c.a.createElement(Jt.a,{className:o.statAvatar},a),c.a.createElement(A.a,{variant:"h5"},n),c.a.createElement(A.a,{variant:"h6"},c.a.createElement(ke.a,{displayType:"text",thousandSeparator:!0,value:Math.round(r)})),c.a.createElement(A.a,{variant:"h6"},t))))},Xt=a(591),ea=c.a.forwardRef((function(e,t){return c.a.createElement(Xt.a,Object.assign({direction:"up",ref:t},e))})),ta=Object(y.a)((function(e){return{title:{color:e.palette.common.white,margin:"0 auto"}}})),aa=function(e){var t,a,n=e.data;return c.a.createElement(ae.a,{container:!0,spacing:3},c.a.createElement(Zt,{icon:c.a.createElement(Lt.a,{fontSize:"large"}),title:"Total Points",value:n.reduce((function(e,t){return e+(t.totals.account||0)}),0)}),c.a.createElement(Zt,{icon:c.a.createElement(It.a,{fontSize:"large"}),title:"Top Student"},null===(t=n[0])||void 0===t?void 0:t.firstName," ",null===(a=n[0])||void 0===a?void 0:a.lastName),c.a.createElement(Zt,{icon:c.a.createElement(qt.a,{fontSize:"large"}),title:"Total Assessment Points",value:n.reduce((function(e,t){return e+(t.totals.assessments||0)}),0)}),c.a.createElement(Zt,{icon:c.a.createElement(Bt.a,{fontSize:"large"}),title:"Total Bonus Points",value:n.reduce((function(e,t){return e+(t.totals.bonuses||0)}),0)}),c.a.createElement(Zt,{icon:c.a.createElement(Ft.a,{fontSize:"large"}),title:"Total Purchase Points",value:n.reduce((function(e,t){return e+(t.totals.purchases||0)}),0)}),c.a.createElement(Zt,{icon:c.a.createElement(Gt.a,{fontSize:"large"}),title:"Total Song Requests",value:n.reduce((function(e,t){return e+t.totals.songs}),0)}),c.a.createElement(Zt,{icon:c.a.createElement(Wt.a,{fontSize:"large"}),title:"Total Students",value:n.length}),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(te.a,{elevation:3,style:{padding:"16px",overflow:"scroll"}},c.a.createElement(A.a,{gutterBottom:!0,variant:"h6"},"Account Summary"),c.a.createElement(Ht,{accounts:n}))))},na=Object(r.c)((function(e){return Object(J.a)({},e.economy)}),(function(e){return{onLoad:function(){return e({type:"ECONOMY_DIALOG_LOADED",payload:Ee.a.Scores.getAll()})},onUnload:function(){return e({type:"ECONOMY_DIALOG_UNLOADED"})}}}))((function(e){var t=e.errors,a=e.inProgress,n=e.onLoad,r=e.onUnload,s=e.students,l=Object(o.useState)([]),i=Object(se.a)(l,2),u=i[0],d=i[1],m=Object(o.useState)(!1),p=Object(se.a)(m,2),E=p[0],f=p[1],b=ta(),g=function(){f(!1),r()};return Object(o.useEffect)((function(){d(s.sort((function(e,t){return t.totals.account-e.totals.account})))}),[s]),c.a.createElement(c.a.Fragment,null,c.a.createElement(D.a,{onClick:function(){f(!0),n()},size:"small"},"View Economy"),c.a.createElement(_e.a,{fullScreen:!0,open:E,onClick:function(e){return e.stopPropagation()},onClose:g,onFocus:function(e){return e.stopPropagation()},TransitionComponent:ea},c.a.createElement(j.a,{position:"relative"},c.a.createElement(S.a,null,c.a.createElement(Ae.a,{edge:"start",onClick:g},c.a.createElement(ye.a,null)),c.a.createElement(A.a,{variant:"h5",className:b.title},"Accounts"))),c.a.createElement(H,null,c.a.createElement(v.a,null,c.a.createElement(pe,{title:"Economy View"}),c.a.createElement(de,{errors:t}),a?c.a.createElement(Yt,{message:"Computing..."}):u.length>0?c.a.createElement(aa,{data:u}):c.a.createElement(ie.a,{severity:"info"},c.a.createElement(it.a,null,"No data available"),"You must create at least one course, add students to that course, and add bonuses, purchases, or scores before any data will be visible here")))))})),ra=Object(y.a)((function(e){return{search:{padding:e.spacing(2)}}})),oa=Object(r.c)((function(e){return{courses:e.courses.courses}}),(function(e){return{onLoad:function(){return e({type:"STUDENT_SEARCH_LOADED",payload:Ee.a.Courses.getAll()})},onUnload:function(){return e({type:"STUDENT_SEARCH_UNLOADED"})}}}))((function(e){var t=e.courses,a=e.onChange,n=e.onLoad,r=e.onUnload,s=Object(o.useState)([]),l=Object(se.a)(s,2),i=l[0],u=l[1],d=ra();return Object(o.useEffect)((function(){return n(),function(){r()}}),[]),Object(o.useEffect)((function(){var e=t.map((function(e){return e.students.map((function(t){return Object(J.a)(Object(J.a)({},t),{},{course:e.name,period:e.period,name:"".concat(t.firstName," ").concat(t.lastName)})}))})).flat();u(e)}),[t]),c.a.createElement(te.a,{className:d.search},c.a.createElement($e.a,{autoHighlight:!0,getOptionLabel:function(e){return e.name},groupBy:function(e){return"Period ".concat(e.period," | ").concat(e.course)},noOptionsText:"No students have been added",onChange:function(e,t){return a(t)},options:i,renderInput:function(e){return c.a.createElement(qe.a,Object.assign({},e,{label:"Student",placeholder:"Type or select a name"}))},renderOption:function(e,t){var a=t.inputValue,n=tt()(e.name,a),r=Xe()(e.name,n);return c.a.createElement("div",null,r.map((function(e,t){return c.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})))}}))})),ca=a(245),sa=a(635),la=a(401),ia=a(627),ua=a(656),da=a(657),ma=Object(y.a)((function(e){return{courses:{"& div":{boxShadow:e.shadows[4],cursor:"pointer",marginBottom:e.spacing(1),padding:"".concat(e.spacing(3),"px ").concat(e.spacing(4),"px"),transition:"all 0.15s ease-in-out","&:focus":{backgroundColor:e.palette.primary.main,boxShadow:e.shadows[1]},"&:hover":{backgroundColor:e.palette.primary.light,boxShadow:e.shadows[1]}}}}})),pa=Object(r.c)((function(e){return{courses:e.courses.courses}}),(function(){return{}}))((function(e){var t=e.courses,a=e.onSelect,n=ma();return c.a.createElement("div",null,c.a.createElement(A.a,{gutterBottom:!0,variant:"h6"},"Select a course"),t.length>0?c.a.createElement("div",{className:n.courses},t.map((function(e){return c.a.createElement("div",{key:e.slug,onClick:function(){a(e)},tabIndex:"0"},c.a.createElement(A.a,{variant:"body1"},c.a.createElement("b",null,e.name)," \xb7 Period ",e.period))}))):c.a.createElement(ie.a,{severity:"info"},"You must create a course before continuing"))})),Ea=function(e){var t=e.course,a=e.onSelect,n=Object(o.useState)([]),r=Object(se.a)(n,2),s=r[0],l=r[1],i=t.students.map((function(e){return{username:e.username,firstName:e.firstName,lastName:e.lastName,fullName:"".concat(e.firstName," ").concat(e.lastName),role:e.role,_id:e._id}})),u=Object(o.useState)([{title:"Students",field:"fullName"}]),d=Object(se.a)(u,1)[0];return Object(o.useEffect)((function(){l(i)}),[t]),c.a.createElement(ve.a,{columns:d,data:s,localization:{body:{emptyDataSourceMessage:"No students found for this course"},toolbar:{nRowsSelected:"{0} student(s) selected"}},onSelectionChange:function(e){return a(e)},options:{paging:!1,selection:!0,toolbar:!0},title:"".concat(t.name," | Period ").concat(t.period)})},fa=Object(y.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(he.a)({},e.breakpoints.up("lg"),{width:e.spacing(80)})}}})),ba=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.scores),{},{bonuses:e.bonuses.bonuses,taxRate:e.common.settings.taxRate})}),(function(e){return{onAdd:function(t,a){return e({type:"ADD_TRANSACTIONS",payload:Ee.a.Transactions.addMany(t),curStudent:a,snackbar:{message:"".concat(t.typeTitle," added"),variant:"success"}})},onExit:function(){return e({type:"TRANSACTIONS_DIALOG_UNLOADED"})}}}))((function(e){var t=e.bonuses,a=e.curStudent,n=e.errors,r=e.inProgress,s=e.isClosed,l=e.isOpen,i=e.onAdd,u=e.onExit,d=e.taxRate,m=e.type,p=Object(o.useState)(!1),E=Object(se.a)(p,2),f=E[0],b=E[1],g=Object(o.useState)(null),h=Object(se.a)(g,2),O=h[0],v=h[1],y=Object(o.useState)([]),j=Object(se.a)(y,2),S=j[0],A=j[1],C=Object(Te.a)(),T=Object(Ne.a)(C.breakpoints.down("md")),N=fa(),_=function(){b(!1),v(null),s()},P=function(e){i(Object(J.a)(Object(J.a)({},e),{},{students:S.map((function(e){return e._id})),type:"Bonuses"===m?"bonus":"purchase",typeTitle:m}),a)},w=function(e){v(e)},U=function(e){A(e)};return Object(o.useEffect)((function(){r||n||_()}),[r]),Object(o.useEffect)((function(){b(l)}),[l]),c.a.createElement(_e.a,{className:N.dialog,fullScreen:T,onClick:function(e){return e.stopPropagation()},onClose:_,onExit:u,onFocus:function(e){return e.stopPropagation()},open:f},c.a.createElement($.c,{initialValues:{amount:"",description:"",productId:""},validationSchema:X.c({amount:X.b().typeError("Numbers only").required("Required"),description:X.d().required("Required"),productId:X.d()}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},(function(e){return c.a.createElement($.b,null,c.a.createElement(Pe.a,null,"Add ",m),c.a.createElement(we.a,null,c.a.createElement(de,{errors:n}),!O&&c.a.createElement(pa,{onSelect:w}),O&&c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:6},"Bonuses"===m?c.a.createElement(gt,{bonuses:t,onChange:function(t){"string"===typeof t?e.setFieldValue("description",t):t&&"object"===typeof t?(e.setFieldValue("amount",t.amount),e.setFieldValue("description",t.description)):(e.setFieldValue("amount",""),e.setFieldValue("description",""))}}):c.a.createElement(at,{onChange:function(t){var a;"string"===typeof t?e.setFieldValue("description",t):t&&"object"===typeof t?(e.setFieldValue("amount",(a=t.cost,Math.round(a*(d/100+1)))),e.setFieldValue("description",t.name),e.setFieldValue("productId",t._id)):(e.setFieldValue("amount",""),e.setFieldValue("description",""))}})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Amount",name:"amount",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(Ea,{course:O,onSelect:U})))),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{disabled:r||0===S.length,color:"primary",type:"submit",variant:"contained"},r?"Adding...":"Add"),c.a.createElement(D.a,{disabled:r,onClick:_,variant:"contained"},"Cancel")))})))})),ga=a(133),ha=a(583),Oa=a(450),va=a(444),ya=a.n(va),ja=Object(y.a)((function(e){return{filedrop:{alignItems:"center",backgroundColor:e.palette.grey[300],borderRadius:e.spacing(1),color:e.palette.grey[600],display:"flex",flexDirection:"column",outline:"none",padding:"20px",transition:"all 0.25s ease-in-out"},filedropActive:{backgroundColor:e.palette.primary.light,color:e.palette.primary.contrastText},filedropReject:{backgroundColor:e.palette.secondary.light,color:e.palette.secondary.contrastText}}}));var Sa=function(e){var t=e.onFiledrop,a=ja(),n=Object(o.useCallback)((function(e){e.forEach((function(e){var a=new FileReader;a.onabort=function(){return console.log("file reading was aborted")},a.onerror=function(){return console.log("file reading has failed")},a.onload=function(){var e=ya()(a.result,{columns:!0,skip_empty_lines:!0});t(e)},a.readAsBinaryString(e)}))}),[]),r=Object(Oa.a)({accept:"text/csv, text/plain",multiple:!1,onDropAccepted:n}),s=r.getRootProps,l=r.getInputProps,i=r.isDragActive,u=r.isDragReject;return c.a.createElement("div",s({className:"".concat(a.filedrop," ").concat(i?a.filedropActive:""," ").concat(u?a.filedropReject:"")}),c.a.createElement("input",l()),!i&&c.a.createElement(A.a,null,"Drop a .csv file here or click to select a .csv file"),i&&!u&&c.a.createElement(A.a,null,"Drop .csv file here"),u&&c.a.createElement(A.a,null,"File type not accepted"))},Aa=Object(y.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(he.a)({},e.breakpoints.up("lg"),{width:e.spacing(100)})}}})),Da=function(e){var t=e.onDataChange,a=e.onShowImport,n=Object(o.useState)(null),r=Object(se.a)(n,2),s=r[0],l=r[1],i=Object(o.useState)(null),u=Object(se.a)(i,2),d=u[0],m=u[1],p=Object(o.useState)(null),E=Object(se.a)(p,2),f=E[0],b=E[1],g=function(e){b(Object(J.a)(Object(J.a)({},f),{},Object(he.a)({},e.target.name,e.target.checked)))};return Object(o.useEffect)((function(){var e=!!f&&Object.values(f).some((function(e){return!0===e}));a(e)}),[f]),Object(o.useEffect)((function(){t({file:s,course:d,tasks:f})}),[s,d,f]),c.a.createElement(c.a.Fragment,null,!s&&!d&&!f&&c.a.createElement(pa,{onSelect:function(e){m(e)}}),!s&&d&&!f&&c.a.createElement("div",null,c.a.createElement(A.a,{gutterBottom:!0},"Scores must be imported from a .csv file exported from Infinite Campus"),c.a.createElement(Sa,{onFiledrop:function(e){var t={};Object.keys(e[0]).slice(1).forEach((function(e){t[e]=!1})),l(e),b(t)}})),s&&d&&f&&c.a.createElement(ne.a,{component:"fieldset"},c.a.createElement(A.a,{gutterBottom:!0,variant:"body1"},"Select the assignments to import"),c.a.createElement(ha.a,null,Object.keys(f).map((function(e){return c.a.createElement(At.a,{control:c.a.createElement(Dt.a,{checked:f[e],onChange:g,name:e}),key:e,label:e})})))))},Ca=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.settings),e.scores)}),(function(e){return{onImport:function(t,a){return e({type:"IMPORT_SCORES",payload:Ee.a.Scores.import(t),curStudent:a,snackbar:{message:"Scores imported",variant:"success"}})},onExit:function(){return e({type:"IMPORT_SCORES_DIALOG_UNLOADED"})}}}))((function(e){var t=e.curStudent,a=e.errors,n=e.inProgress,r=e.isClosed,s=e.isOpen,l=e.onExit,i=e.onImport,u=e.schoolDistrict,d=Object(o.useState)(!1),m=Object(se.a)(d,2),p=m[0],E=m[1],f=Object(o.useState)(!1),b=Object(se.a)(f,2),g=b[0],h=b[1],O=Object(o.useState)(null),v=Object(se.a)(O,2),y=v[0],j=v[1],S=Object(Te.a)(),C=Object(Ne.a)(S.breakpoints.down("md")),T=Aa(),N=function(){E(!1),r()};return Object(o.useEffect)((function(){n||a||N()}),[n]),Object(o.useEffect)((function(){E(s)}),[s]),c.a.createElement(_e.a,{className:T.dialog,fullScreen:C,onClick:function(e){return e.stopPropagation()},onClose:N,onExit:l,onFocus:function(e){return e.stopPropagation()},open:p},c.a.createElement(Pe.a,null,"Import Scores"),"ccsd"===u?c.a.createElement(we.a,null,c.a.createElement(de,{errors:a}),n?c.a.createElement(Yt,{message:"Importing..."}):c.a.createElement(Da,{onDataChange:function(e){j(e)},onShowImport:function(e){h(e)}})):c.a.createElement(we.a,null,c.a.createElement(A.a,null,"Please email a copy of your gradebook export file to Dr. May so he can setup a parser in the app")),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{color:"primary",disabled:!g||n,onClick:function(){var e=y.file.map((function(e,t){return t>1&&e["Assignment Name"].split("#").pop()})).filter((function(e){return!1!==e})),a={course:y.course,tasks:[]};for(var n in y.tasks){if(y.tasks[n]){var r,o={title:n,totalPoints:y.file[1][n],scores:{}},c=Object(ga.a)(e);try{var s=function(){var e=r.value,t=y.file.find((function(t){return t["Assignment Name"].endsWith(e)}));t&&(o.scores[e]=t[n])};for(c.s();!(r=c.n()).done;)s()}catch(l){c.e(l)}finally{c.f()}a.tasks.push(o)}}i(a,t)},variant:"contained"},n?"Importing...":"Import"),c.a.createElement(D.a,{disabled:n,onClick:N,variant:"contained"},"Cancel")))})),Ta=Object(r.c)((function(e){return Object(J.a)({},e.bonuses)}),(function(e){return{onAdd:function(t){return e({payload:Ee.a.Bonuses.add(t),snackbar:{message:"Bonus added",variant:"success"},type:"ADD_BONUS"})},onDelete:function(t){return e({payload:Ee.a.Bonuses.delete(t),snackbar:{message:"Bonus deleted",variant:"success"},type:"DELETE_BONUS"})},onUpdate:function(t){return e({payload:Ee.a.Bonuses.update(t),snackbar:{message:"Bonus updated",variant:"success"},type:"UPDATE_BONUS"})}}}))((function(e){var t=e.bonuses,a=e.onAdd,n=e.onDelete,r=e.onUpdate,s=Object(o.useState)([]),l=Object(se.a)(s,2),i=l[0],u=l[1],d=Object(o.useState)([{title:"Description",field:"description"},{title:"Amount",field:"amount"}]),m=Object(se.a)(d,1)[0];return Object(o.useEffect)((function(){u(t)}),[t]),c.a.createElement(ve.a,{title:"Bonuses",columns:m,data:i,localization:{body:{emptyDataSourceMessage:"No bonuses have been added",editRow:{deleteText:"Delete this bonus?"}}},options:{actionsColumnIndex:-1,paging:!1},editable:{onRowAdd:function(e){return new Promise((function(t){a(e),t()}))},onRowUpdate:function(e){return new Promise((function(t){r(e),t()}))},onRowDelete:function(e){return new Promise((function(t){n(e),t()}))}}})})),Na=Object(y.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(he.a)({},e.breakpoints.up("lg"),{width:e.spacing(100)})}}})),_a=Object(r.c)((function(e){return Object(J.a)({},e.bonuses)}),(function(e){return{onLoad:function(){return e({type:"LOAD_BONUSES",payload:Ee.a.Bonuses.getAll()})},onUnload:function(){return e({type:"UNLOAD_BONUSES"})}}}))((function(e){var t=e.errors,a=e.isOpen,n=e.onClose,r=e.onLoad,s=e.onUnload,l=Object(o.useState)(!1),i=Object(se.a)(l,2),u=i[0],d=i[1],m=Object(Te.a)(),p=Object(Ne.a)(m.breakpoints.down("md")),E=Na(),f=function(){d(!1),n()};return Object(o.useEffect)((function(){return r(),function(){s()}}),[]),Object(o.useEffect)((function(){d(a)}),[a]),c.a.createElement(_e.a,{className:E.dialog,fullScreen:p,onClick:function(e){return e.stopPropagation()},onClose:f,onFocus:function(e){return e.stopPropagation()},open:u},c.a.createElement(Pe.a,null,"Manage Bonuses"),c.a.createElement(we.a,null,c.a.createElement(de,{errors:t}),c.a.createElement(Ta,null)),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{onClick:f,variant:"contained"},"Cancel")))})),Pa=Object(y.a)((function(e){return{icon:{marginRight:e.spacing(1)}}})),wa=function(e){var t=e.curStudent,a=Object(o.useState)(null),n=Object(se.a)(a,2),r=n[0],s=n[1],l=Object(o.useState)(null),i=Object(se.a)(l,2),u=i[0],d=i[1],m=Pa(),p=function(e){d(e.currentTarget.dataset.type),s(null)},E=function(){d(null)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(ee.a,{color:"primary",onClick:function(e){s(e.currentTarget)},variant:"extended"},c.a.createElement(Bt.a,{className:m.icon}),"Update Accounts"),c.a.createElement(ca.a,{anchorEl:r,open:Boolean(r),onClose:function(){s(null)}},c.a.createElement(oe.a,{"data-type":"scores",onClick:p},c.a.createElement(sa.a,null,c.a.createElement(ua.a,null)),c.a.createElement(la.a,null,"Import scores")),c.a.createElement(oe.a,{"data-type":"bonuses",onClick:p},c.a.createElement(sa.a,null,c.a.createElement(ft.a,null)),c.a.createElement(la.a,null,"Add Bonuses")),c.a.createElement(oe.a,{"data-type":"purchases",onClick:p},c.a.createElement(sa.a,null,c.a.createElement(Ft.a,null)),c.a.createElement(la.a,null,"Add Purchases")),c.a.createElement(ia.a,null),c.a.createElement(oe.a,{"data-type":"manage",onClick:p},c.a.createElement(sa.a,null,c.a.createElement(da.a,null)),c.a.createElement(la.a,null,"Manage Bonuses"))),c.a.createElement(Ca,{curStudent:t,isClosed:E,isOpen:"scores"===u}),c.a.createElement(ba,{curStudent:t,isClosed:E,isOpen:"bonuses"===u,type:"Bonuses"}),c.a.createElement(ba,{curStudent:t,isClosed:E,isOpen:"purchases"===u,type:"Purchases"}),c.a.createElement(_a,{isOpen:"manage"===u,onClose:E}))},Ua=Object(r.c)((function(e){return{importSummary:e.scores.importSummary}}),(function(e){return{onUnload:function(){return e({type:"ACCOUNTS_PAGE_UNLOADED"})}}}))((function(e){var t=e.importSummary,a=e.onUnload,n=Object(o.useState)(null),r=Object(se.a)(n,2),s=r[0],l=r[1],i=function(e,t){return"".concat(e," ").concat(t).concat(1!==e?"s":"")};return Object(o.useEffect)((function(){return function(){a()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Manage Accounts"},c.a.createElement(na,null),c.a.createElement(wa,{curStudent:s})),t&&c.a.createElement(xt,null,"Created ",i(t.tasksCreated,"assignment"),", imported"," ",i(t.scoresImported,"score"),", and updated"," ",i(t.scoresUpdated,"score")),c.a.createElement(ae.a,{container:!0,spacing:4},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(oa,{onChange:function(e){l(e)}})),c.a.createElement(ae.a,{item:!0,xs:12},s&&c.a.createElement(jt,{student:s}))))})),Ra=Object(y.a)((function(e){return{icon:{marginRight:e.spacing(1)}}})),ka=Object(r.c)((function(e){return Object(J.a)({},e.courses)}),(function(e){return{onAdd:function(t){return e({type:"ADD_COURSE",payload:Ee.a.Courses.add(t),snackbar:{message:"Course added",variant:"success"}})},onExit:function(){return e({type:"COURSE_DIALOG_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_COURSE",payload:Ee.a.Courses.update(t),snackbar:{message:"Course updated",variant:"success"}})}}}))((function(e){var t=e.course,a=e.errors,n=e.inProgress,r=e.onAdd,s=e.onExit,l=e.onUpdate,i=Object(o.useState)(!1),u=Object(se.a)(i,2),d=u[0],m=u[1],p=Object(Te.a)(),E=Object(Ne.a)(p.breakpoints.down("md")),f=Ra(),b=function(){m(!0)},g=function(){m(!1)},h=function(e){r(Object(J.a)({},e))},O=function(e){l(Object(J.a)(Object(J.a)({},t),e))};return Object(o.useEffect)((function(){n||a||m(!1)}),[n]),c.a.createElement(c.a.Fragment,null,t?c.a.createElement(Ce,{action:"Edit course",onClick:b},c.a.createElement(je.a,null)):c.a.createElement(ee.a,{color:"primary",onClick:b,variant:"extended"},c.a.createElement(Je.a,{className:f.icon}),"Create course"),c.a.createElement(_e.a,{fullScreen:E,onClick:function(e){return e.stopPropagation()},onClose:g,onExit:s,onFocus:function(e){return e.stopPropagation()},open:d},c.a.createElement($.c,{initialValues:{name:(null===t||void 0===t?void 0:t.name)||"",period:(null===t||void 0===t?void 0:t.period)||""},validationSchema:X.c({name:X.d().required("Required"),period:X.b().typeError("Numbers only").required("Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(a){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?O(a):h(a);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement($.b,null,c.a.createElement(Pe.a,null,t?"Edit Course":"Create Course"),c.a.createElement(we.a,null,c.a.createElement(de,{errors:a}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{autoFocus:!t,color:"primary",component:Z.c,disabled:n,label:"Course Name",name:"name",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:n,label:"Period",name:"period",type:"text",fullWidth:!0})))),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{disabled:n,color:"primary",type:"submit",variant:"contained"},t?n?"Updating...":"Update":n?"Adding...":"Add"),c.a.createElement(D.a,{disabled:n,onClick:g,variant:"contained"},"Cancel"))))))})),xa=a(671),La=a(629),Ia=a(628),qa=a(660),Ba=Object(r.c)((function(){return{}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_STUDENT",payload:Ee.a.Students.delete(t),snackbar:{message:"Student deleted",variant:"success"}})}}}))((function(e){e.course;var t=e.onDelete,a=e.student,n=Object(o.useState)(!1),r=Object(se.a)(n,2),s=r[0],l=r[1],i=function(){l(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Delete student",onClick:function(){l(!0)},size:"small"},c.a.createElement(Qe.a,{fontSize:"inherit"})),c.a.createElement(_e.a,{open:s,onClose:i,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Delete Student"),c.a.createElement(we.a,null,c.a.createElement(mt.a,{component:"div"},"Are you sure you want to delete"," ",c.a.createElement("b",null,a.firstName," ",a.lastName),"? This action will permanently delete:",c.a.createElement("ul",null,c.a.createElement("li",null,"the student's account, and"),c.a.createElement("li",null,"all song requests"),c.a.createElement("li",null,"all transactions"),c.a.createElement("li",null,"all purchases"),c.a.createElement("li",null,"all scores")),"associated with this student. This action ",c.a.createElement("b",null,"cannot be undone"),".")),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{onClick:function(){l(!1),t(a)},color:"secondary",variant:"contained",autoFocus:!0},"Delete"),c.a.createElement(D.a,{onClick:i,variant:"contained"},"Cancel"))))})),Fa=a(658),Ga=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.settings),e.courses)}),(function(e){return{onAdd:function(t,a){return e({type:"ADD_STUDENT",payload:Ee.a.Students.add(t,a),courseId:a,snackbar:{message:"Student added",variant:"success"}})},onExit:function(){return e({type:"STUDENT_DIALOG_UNLOADED"})},onUpdate:function(t,a){return e({type:"UPDATE_STUDENT",payload:Ee.a.Students.update(t),courseId:a,snackbar:{message:"Student updated",variant:"success"}})}}}))((function(e){var t=e.course,a=e.defaultStudentPassword,n=e.errors,r=e.inProgress,s=e.onAdd,l=e.onExit,i=e.onUpdate,u=e.student,d=Object(o.useState)(!1),m=Object(se.a)(d,2),p=m[0],E=m[1],f=Object(Te.a)(),b=Object(Ne.a)(f.breakpoints.down("md")),g=function(){E(!0)},h=function(){E(!1)},O=function(e){var a=Object(J.a)({},e),n=t._id;a.role="student",s(a,n)},v=function(e){var a=Object(J.a)(Object(J.a)({},u),e),n=t._id;i(a,n)};return Object(o.useEffect)((function(){r||n||E(!1)}),[r]),c.a.createElement(c.a.Fragment,null,u?c.a.createElement(Ce,{action:"Edit student",onClick:g,size:"small"},c.a.createElement(je.a,{fontSize:"inherit"})):c.a.createElement(Ce,{action:"Add student",onClick:g},c.a.createElement(Fa.a,null)),c.a.createElement(_e.a,{fullScreen:b,onClick:function(e){return e.stopPropagation()},onClose:h,onExit:l,onFocus:function(e){return e.stopPropagation()},open:p},c.a.createElement($.c,{initialValues:{firstName:(null===u||void 0===u?void 0:u.firstName)||"",lastName:(null===u||void 0===u?void 0:u.lastName)||"",username:(null===u||void 0===u?void 0:u.username)||"",password:u?"":a},validationSchema:X.c({firstName:X.d().required("Required"),lastName:X.d().required("Required"),username:X.b().typeError("Numbers only").required("Required"),password:X.d().required(u?"":"Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u?v(t):O(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement($.b,null,c.a.createElement(Pe.a,null,u?"Edit Student":"Add Student"),c.a.createElement(we.a,null,c.a.createElement(de,{errors:n}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{autoFocus:!u,color:"primary",component:Z.c,disabled:r,label:"First Name",name:"firstName",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Last Name",name:"lastName",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:!!u||r,label:"Student Number",name:"username",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Password",name:"password",type:"text",fullWidth:!0})))),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{color:"primary",disabled:r,type:"submit",variant:"contained"},u?r?"Updating...":"Update":r?"Adding...":"Add"),c.a.createElement(D.a,{disabled:r,onClick:h,variant:"contained"},"Cancel"))))))})),Wa=a(659),Ma=Object(r.c)((function(e){return Object(J.a)({},e.courses)}),(function(e){return{onSubmit:function(t,a){return e({type:"MOVE_STUDENT",payload:Promise.all([Ee.a.Courses.unenroll(t),Ee.a.Courses.enroll(a)]),snackbar:{message:"Student moved",variant:"success"}})}}}))((function(e){var t=e.course,a=e.courses,n=e.errors,r=e.inProgress,s=e.onSubmit,l=e.student,i=Object(o.useState)(!1),u=Object(se.a)(i,2),d=u[0],m=u[1],p=function(){m(!1)},E=function(e){if(t.slug!==e.course){var a={usernames:[l.username],slug:t.slug},n={usernames:[l.username],slug:e.course};s(a,n)}};return Object(o.useEffect)((function(){r||n||m(!1)}),[r]),c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Move student",onClick:function(){m(!0)},size:"small"},c.a.createElement(Wa.a,{fontSize:"inherit"})),c.a.createElement(_e.a,{open:d,onClose:p,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement($.c,{initialValues:{course:t.slug||""},validationSchema:X.c({course:X.d().required("Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},(function(e){return c.a.createElement($.b,null,c.a.createElement(Pe.a,null,"Move Student"),c.a.createElement(we.a,null,c.a.createElement(de,{errors:n}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,ds:12},"Move"," ",c.a.createElement("b",null,l.firstName," ",l.lastName)," ","to..."),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,id:"course",label:"Course",name:"course",type:"select",select:!0,fullWidth:!0},a.map((function(e){return c.a.createElement(oe.a,{key:e.slug,value:e.slug},"Period ".concat(e.period," | ").concat(e.name))})))))),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{color:"primary",disabled:r||e.values.course===t.slug,type:"submit",variant:"contained"},r?"Moving...":"Move"),c.a.createElement(D.a,{onClick:p,variant:"contained"},"Cancel")))}))))})),Ha=Object(y.a)((function(e){return{row:{alignItems:"center",borderBottom:"solid 2px white",display:"flex",height:e.spacing(5),justifyContent:"space-between",padding:e.spacing(1),"&:hover":{borderBottomColor:e.palette.secondary.main}},rowHeader:{alignItems:"center",display:"flex"},studentUsername:{marginRight:e.spacing(2),minWidth:e.spacing(12)}}})),Va=function(e){var t=e.course,a=e.student,n=Ha();return c.a.createElement("div",{className:n.row},c.a.createElement("div",{className:n.rowHeader},c.a.createElement(Mt.a,{color:"primary",label:a.username,className:n.studentUsername}),c.a.createElement(A.a,null,a.lastName,", ",a.firstName)),c.a.createElement("div",null,c.a.createElement(Et,{student:a}),c.a.createElement(Ma,{course:t,student:a}),c.a.createElement(Ga,{course:t,student:a}),c.a.createElement(Ba,{course:t,student:a})))},za=function(e){var t=e.course;return c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{variant:"h6"},"Students")," ",t.students&&t.students.length>0?t.students.map((function(e){return c.a.createElement(Va,{key:e._id,course:t,student:e})})):c.a.createElement("div",null,c.a.createElement(A.a,null,"No students have been added to this course")))},Ya=Object(r.c)((function(){return{}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_COURSE",payload:Ee.a.Courses.delete(t),snackbar:{message:"Course deleted",variant:"success"}})}}}))((function(e){var t=e.course,a=e.onDelete,n=Object(o.useState)(!1),r=Object(se.a)(n,2),s=r[0],l=r[1],i=function(){l(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Delete course",onClick:function(){l(!0)}},c.a.createElement(Qe.a,null)),c.a.createElement(_e.a,{open:s,onClose:i,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Delete Course"),c.a.createElement(we.a,null,c.a.createElement(mt.a,{component:"div"},"Are you sure you want to delete"," ",c.a.createElement("b",null,t.name," Period ",t.period),"? This action will permanently delete:",c.a.createElement("ul",null,c.a.createElement("li",null,"all student accounts"),c.a.createElement("li",null,"all song requests"),c.a.createElement("li",null,"all transactions"),c.a.createElement("li",null,"all purchases"),c.a.createElement("li",null,"all scores")),"associated with this course. This action ",c.a.createElement("b",null,"cannot be undone"),".")),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{onClick:function(){l(!1),a(t.slug)},color:"secondary",variant:"contained",autoFocus:!0},"Delete"),c.a.createElement(D.a,{onClick:i,variant:"contained"},"Cancel"))))})),Qa=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.settings),e.courses)}),(function(e){return{onDrop:function(t,a){return e({type:"IMPORT_STUDENTS",payload:Ee.a.Students.import(t,a),snackbar:{message:"Students imported",variant:"success"}})},onExit:function(){return e({type:"STUDENT_DIALOG_UNLOADED"})}}}))((function(e){var t=e.course,a=e.defaultStudentPassword,n=e.errors,r=e.inProgress,s=e.onDrop,l=e.onExit,i=e.schoolDistrict,u=Object(o.useState)(!1),d=Object(se.a)(u,2),m=d[0],p=d[1],E=Object(Te.a)(),f=Object(Ne.a)(E.breakpoints.down("md")),b=function(){p(!1)};return Object(o.useEffect)((function(){r||n||p(!1)}),[r]),c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Import students",onClick:function(){p(!0)}},c.a.createElement(ua.a,null)),c.a.createElement(_e.a,{fullScreen:f,onClick:function(e){return e.stopPropagation()},onClose:b,onExit:l,onFocus:function(e){return e.stopPropagation()},open:m},c.a.createElement(Pe.a,null,"Import Students"),"ccsd"===i?c.a.createElement(we.a,null,r?c.a.createElement(Yt,{message:"Importing..."}):c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{gutterBottom:!0},"Students can be imported from a .csv file exported from Infinite Campus"),c.a.createElement(Sa,{onFiledrop:function(e){var n=Object.keys(e[0]),r=e.map((function(e,t){if(t<2)return null;var r=e[n[0]];return{firstName:r.split(",")[1].split(/(\s\w)*\s#/)[0].trim(),lastName:r.split(",")[0],username:r.split("#")[1],password:a,role:"student"}})).filter((function(e){return null!==e}));s(r,t._id)}}))):c.a.createElement(we.a,null,c.a.createElement(A.a,null,"Please email a copy of your gradebook export file to Dr. May so he can setup a parser in the app")),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{disabled:r,onClick:b,variant:"contained"},"Cancel"))))})),Ka=Object(r.c)((function(e){return{tasks:e.tasks.tasks}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_TASK",payload:Ee.a.Tasks.delete(t),snackbar:{message:"Assignment removed",variant:"success"}})},onLoad:function(t){return e({type:"TASKS_DIALOG_LOADED",payload:Ee.a.Tasks.getAll(t)})},onUpdate:function(t){return e({type:"UPDATE_TASK",payload:Ee.a.Tasks.update(t),snackbar:{message:"Assignment updated",variant:"success"}})}}}))((function(e){var t=e.course,a=e.onDelete,n=e.onLoad,r=e.onUpdate,s=e.tasks,l=Object(o.useState)([]),i=Object(se.a)(l,2),u=i[0],d=i[1],m=s.map((function(e){return{createdAt:new Date(e.createdAt).toDateString(),multiplier:e.multiplier,title:e.title,totalPoints:e.totalPoints,slug:e.slug}})),p=Object(o.useState)([{title:"Date",field:"createdAt",editable:"never"},{title:"Title",field:"title",editable:"never"},{title:"Total Points",field:"totalPoints"},{title:"Multiplier",field:"multiplier"}]),E=Object(se.a)(p,1)[0];return Object(o.useEffect)((function(){n(t._id)}),[]),Object(o.useEffect)((function(){d(m)}),[s]),c.a.createElement(ve.a,{columns:E,data:u,localization:{body:{emptyDataSourceMessage:"No assignments found for this course",editRow:{deleteText:"Delete assignment? This will delete all scores for this assignment.",saveTooltip:"Delete assignment"}}},options:{actionsColumnIndex:-1,paging:!1,toolbar:!1},editable:{onRowUpdate:function(e,t){return new Promise((function(a,n){var o=Object(ge.a)(u);o[t.tableData.id]=e,d(Object(ge.a)(o)),r(e),a()}))},onRowDelete:function(e){return new Promise((function(t,n){var r=Object(ge.a)(u),o=e.tableData.id;r.splice(o,1),d(Object(ge.a)(r)),a(e),t()}))}}})})),Ja=Object(y.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(he.a)({},e.breakpoints.up("lg"),{minHeight:e.spacing(54),width:e.spacing(100)})}}})),$a=Object(r.c)((function(e){return Object(J.a)({},e.tasks)}),(function(e){return{onExit:function(){return e({type:"TASKS_DIALOG_UNLOADED"})}}}))((function(e){var t=e.course,a=e.errors,n=e.inProgress,r=e.onExit,s=Object(o.useState)(!1),l=Object(se.a)(s,2),i=l[0],u=l[1],d=Object(Te.a)(),m=Object(Ne.a)(d.breakpoints.down("md")),p=Ja(),E=function(){u(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Manage assignments",onClick:function(){u(!0)}},c.a.createElement(qt.a,null)),c.a.createElement(_e.a,{className:p.dialog,fullScreen:m,onClick:function(e){return e.stopPropagation()},onClose:E,onExit:r,onFocus:function(e){return e.stopPropagation()},open:i},c.a.createElement(Pe.a,null,"Manage Assignments"),c.a.createElement(we.a,null,c.a.createElement(de,{errors:a}),c.a.createElement(Ka,{course:t})),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{disabled:n,onClick:E,variant:"contained"},"Close"))))})),Za=Object(y.a)((function(e){return{courseDetails:{display:"block"},courseHeader:{alignItems:"center",display:"flex",justifyContent:"space-between",width:"100%"},coursePeriod:{backgroundColor:e.palette.secondary.main,marginRight:e.spacing(2)},courseTitle:{flexGrow:"1"}}})),Xa=function(e){var t=e.courses,a=Object(o.useState)(!1),n=Object(se.a)(a,2),r=n[0],s=n[1],l=Za();return c.a.createElement(c.a.Fragment,null,(null===t||void 0===t?void 0:t.length)>0?t.map((function(e){return c.a.createElement(xa.a,{expanded:r===e._id,key:e._id,onChange:(t=e._id,function(e,a){s(!!a&&t)})},c.a.createElement(La.a,{expandIcon:c.a.createElement(qa.a,null)},c.a.createElement("div",{className:l.courseHeader},c.a.createElement(Jt.a,{className:l.coursePeriod},e.period),c.a.createElement(A.a,{className:l.courseTitle,variant:"h5"},e.name),c.a.createElement($a,{course:e}),c.a.createElement(Ga,{course:e}),c.a.createElement(Qa,{course:e}),c.a.createElement(ka,{course:e}),c.a.createElement(Ya,{course:e}))),c.a.createElement(Ia.a,{className:l.courseDetails},c.a.createElement(za,{course:e})));var t})):c.a.createElement(A.a,null,"You have no courses"))},en=Object(r.c)((function(e){return Object(J.a)({},e.courses)}),(function(e){return{onLoad:function(){return e({type:"COURSES_PAGE_LOADED",payload:Ee.a.Courses.getAll()})},onUnload:function(){return e({type:"COURSES_PAGE_UNLOADED"})}}}))((function(e){var t=e.courses,a=e.importCount,n=e.importFailed,r=e.onLoad,s=e.onUnload,l=e.pageLoaded;return Object(o.useEffect)((function(){return r(),function(){s()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Manage Courses"},c.a.createElement(ka,null)),null!==a&&c.a.createElement(xt,null,a," students imported",c.a.createElement("br",null),n>0&&"".concat(n," students not imported (already have accounts)")),l?c.a.createElement(Yt,{message:"Loading..."}):c.a.createElement(Xa,{courses:t}))})),tn=a(621),an=a(324),nn=a(668),rn=a(661),on=a(662),cn=a(663),sn=a(620),ln=Object(y.a)((function(e){return{badge:{left:"-6%",top:"-30%"}}})),un=function(e){var t=e.children,a=e.value,n=ln();return c.a.createElement(sn.a,{anchorOrigin:{horizontal:"left",vertical:"top"},badgeContent:a,classes:{badge:n.badge},color:"secondary",overlap:"circle"},t)},dn=Object(y.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(he.a)({},e.breakpoints.up("lg"),{minHeight:e.spacing(54),width:e.spacing(100)})},icon:{marginRight:e.spacing(1)},panel:{minWidth:e.spacing(40),maxWidth:e.spacing(60)},removalAlert:{backgroundColor:e.palette.error.light,border:"2px solid ".concat(e.palette.error.dark),borderRadius:e.spacing(2),color:e.palette.common.white,fontSize:e.typography.h6.fontSize,padding:e.spacing(1),textAlign:"center",textTransform:"uppercase"},selected:{backgroundColor:e.palette.primary.main},songInfo:{marginBottom:e.spacing(4)},statusButton:{"&:hover":{backgroundColor:e.palette.primary.light}},statusDescription:{backgroundColor:e.palette.grey[100],borderRadius:e.spacing(1),marginTop:e.spacing(2),padding:e.spacing(2)},studentInfo:Object(he.a)({alignItems:"center",display:"flex",justifyContent:"space-between",marginTop:e.spacing(4)},e.breakpoints.up("md"),{borderTopColor:e.palette.primary.main,borderTopStyle:"dotted",borderTopWidth:"4px",paddingTop:e.spacing(2)}),studentName:{alignItems:"center",display:"flex","& > div":{marginRight:e.spacing(1)}}}})),mn=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.songs),{},{songRemovalPurchaseAmount:e.common.settings.songRemovalPurchaseAmount,songRemovalRefundAmount:e.common.settings.songRemovalRefundAmount,songRequestPurchaseAmount:e.common.settings.songRequestPurchaseAmount})}),(function(e){return{onExit:function(){return e({type:"SONG_REQUESTS_DIALOG_UNLOADED"})},onSubmit:function(t){return e({type:"UPDATE_SONG_REQUEST",payload:Ee.a.Songs.update(t)})}}}))((function(e){var t,a,n=e.courses,r=e.errors,s=e.inProgress,l=e.onExit,i=e.onSubmit,u=e.songRemovalPurchaseAmount,d=e.songRemovalRefundAmount,m=e.songRequestPurchaseAmount,p=Object(o.useState)(0),E=Object(se.a)(p,2),f=E[0],b=E[1],g=Object(o.useState)(!1),h=Object(se.a)(g,2),O=h[0],v=h[1],y=Object(o.useState)(null),j=Object(se.a)(y,2),S=j[0],C=j[1],T=Object(o.useState)(null),N=Object(se.a)(T,2),_=N[0],P=N[1],w=Object(o.useState)(null),U=Object(se.a)(w,2),R=U[0],k=U[1],x=Object(o.useState)([]),L=Object(se.a)(x,2),I=L[0],q=L[1],B=Object(o.useState)(0),F=Object(se.a)(B,2),G=F[0],W=F[1],M=Object(Te.a)(),H=Object(Ne.a)(M.breakpoints.down("md")),V=dn(),z=function(){var e=0;if(n.length>0){var t,a=Object(ga.a)(n);try{for(a.s();!(t=a.n()).done;){e+=t.value.songs.filter((function(e){return e.status.startsWith("pending")})).length}}catch(r){a.e(r)}finally{a.f()}}return e},Y=function(){if(C(null),n.length>0){var e,t=Object(ga.a)(n);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(a.songs.length>0){var r=a.songs.find((function(e){return e.status.startsWith("pending")&&!I.includes(e._id)}));if(r){r.period=a.period,C(r),b(f+1);break}}}}catch(o){t.e(o)}finally{t.f()}}},J=function(){b(0),v(!1),P(null),k(null),q([])},$=function(e){P(e)},Z=function(e){k(e.target.value)},X=function(){var e=Object(K.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i({amount:m,id:S._id,status:_,statusDescription:R}),P(null),k(null);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(K.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i({id:S._id,purchaseAmount:u,refundAmount:d,status:"removed",statusDescription:"".concat(S.removedBy.firstName," ").concat(S.removedBy.lastName," paid to remove this song")});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){W(z())})),Object(o.useEffect)((function(){Y()}),[n]),Object(o.useEffect)((function(){Y()}),[I]),c.a.createElement(c.a.Fragment,null,c.a.createElement(ee.a,{color:"primary",onClick:function(){v(!0),W(z())},variant:"extended"},c.a.createElement(un,{value:G},c.a.createElement(rn.a,{className:V.icon}),"Process requests")),c.a.createElement(_e.a,{className:V.dialog,fullScreen:H,onClick:function(e){return e.stopPropagation()},onClose:J,onExit:l,onFocus:function(e){return e.stopPropagation()},open:O},c.a.createElement(Pe.a,null,"Process Song Requests"),c.a.createElement(we.a,null,c.a.createElement(de,{errors:r}),S?"pending removal"!==S.status?c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("div",{className:V.panel},c.a.createElement("div",{className:V.songInfo},c.a.createElement(A.a,{variant:"h6"},S.title),c.a.createElement(A.a,{color:"textSecondary",variant:"body1",gutterBottom:!0},"Song"),c.a.createElement(A.a,{variant:"h6"},S.artist),c.a.createElement(A.a,{color:"textSecondary",variant:"body1"},"Artist")),c.a.createElement(tn.a,null,c.a.createElement(D.a,{href:(t=S.artist,a=S.title,"http://www.google.com/search?q=".concat(encodeURIComponent("lyrics: ".concat(a," by ").concat(t)))),target:"_blank"},"Search Lyrics"),c.a.createElement(D.a,{href:function(e,t){return"https://open.spotify.com/search/".concat(encodeURIComponent("".concat(t," ").concat(e)))}(S.artist,S.title),target:"_blank"},"Search Spotify")),c.a.createElement("div",{className:V.studentInfo},c.a.createElement("div",{className:V.studentName},c.a.createElement(Mt.a,{color:"secondary",label:S.period}),c.a.createElement(A.a,null,S.student.firstName," ",S.student.lastName)),c.a.createElement(Ie,{cost:m,count:f,username:S.student.username})))),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("div",{className:V.panel},c.a.createElement(A.a,{variant:"h6"},"Status"),c.a.createElement(tn.a,{fullWidth:!0,size:"large"},c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,title:"Approve"},c.a.createElement(D.a,{className:"".concat(V.statusButton," ").concat("approved"===_&&V.selected),onClick:function(){return $("approved")}},c.a.createElement(on.a,null))),c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,title:"Reject"},c.a.createElement(D.a,{className:"".concat(V.statusButton," ").concat("rejected"===_&&V.selected),onClick:function(){return $("rejected")}},c.a.createElement(cn.a,null)))),"approved"===_&&c.a.createElement("div",{className:V.statusDescription},c.a.createElement(A.a,{gutterBottom:!0},c.a.createElement("strong",null,"Condition for Approval")," (optional)"),c.a.createElement(ne.a,{component:"fieldset"},c.a.createElement(an.a,{name:"statusDescription",value:R,onChange:Z},c.a.createElement(At.a,{value:"Clean version",control:c.a.createElement(nn.a,null),label:"Clean version"}),c.a.createElement(At.a,{value:"Instrumental version",control:c.a.createElement(nn.a,null),label:"Instrumental version"}),c.a.createElement(At.a,{value:"Picked my best guess",control:c.a.createElement(nn.a,null),label:"Picked my best guess"})))),"rejected"===_&&c.a.createElement("div",{className:V.statusDescription},c.a.createElement(A.a,{gutterBottom:!0},c.a.createElement("strong",null,"Reason for Rejection")," (optional)"),c.a.createElement(ne.a,{component:"fieldset"},c.a.createElement(an.a,{name:"statusDescription",value:R,onChange:Z},c.a.createElement(At.a,{value:"Inappropriate content (language, drugs, sex, and/or violence)",control:c.a.createElement(nn.a,null),label:"Inappropriate content (language, drugs, sex, and/or violence)"}),c.a.createElement(At.a,{value:"Not available on Spotify",control:c.a.createElement(nn.a,null),label:"Not available on Spotify"}),c.a.createElement(At.a,{value:"other",control:c.a.createElement(nn.a,null),label:"Other"}))))))):c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement("div",{className:V.panel},c.a.createElement("div",{className:V.songInfo},c.a.createElement(A.a,{variant:"h6"},S.title),c.a.createElement(A.a,{color:"textSecondary",variant:"body1",gutterBottom:!0},"Song"),c.a.createElement(A.a,{variant:"h6"},S.artist),c.a.createElement(A.a,{color:"textSecondary",variant:"body1"},"Artist")),c.a.createElement("div",{className:V.removalAlert},"Removal Requested by"," ","".concat(S.removedBy.firstName," ").concat(S.removedBy.lastName)),c.a.createElement("div",{className:V.studentInfo},c.a.createElement("div",{className:V.studentName},c.a.createElement(Mt.a,{color:"secondary",label:S.period}),c.a.createElement(A.a,null,S.student.firstName," ",S.student.lastName)),c.a.createElement(Ie,{cost:u,count:f,username:S.removedBy.username}))))):c.a.createElement(ie.a,{severity:"info"},c.a.createElement(it.a,null,"All caught up!"),"There are no songs to process at this time")),c.a.createElement(Ue.a,null,S&&c.a.createElement(A.a,{style:{marginRight:"auto"},variant:"subtitle2"},"Song ".concat(f," of ").concat(G)),S&&("pending removal"!==S.status?c.a.createElement(D.a,{color:"primary",disabled:s||!_,onClick:X,variant:"contained"},s?"Saving...":"Save & Continue"):c.a.createElement(D.a,{color:"secondary",disabled:s,onClick:te,variant:"contained"},s?"Removing...":"Remove & Continue")),S&&c.a.createElement(D.a,{disabled:s,onClick:function(){q([].concat(Object(ge.a)(I),[S._id]))},variant:"contained"},"Skip"),c.a.createElement(D.a,{disabled:s,onClick:J,variant:"contained"},S?"Cancel":"Close"))))})),pn=Object(r.c)((function(e){return Object(J.a)({},e.songs)}),(function(e){return{onDelete:function(t){return e({type:"DELETE_SONG_REQUEST",payload:Ee.a.Songs.delete(t),snackbar:{message:"Song request removed",variant:"success"}})},onLoad:function(){return e({type:"TEACHER_SONGS_PAGE_LOADED",payload:Ee.a.Songs.forTeacher()})},onUnload:function(){return e({type:"SONGS_PAGE_UNLOADED"})}}}))((function(e){var t=e.courses,a=e.onDelete,n=e.onLoad,r=e.onUnload,s=Object(o.useState)([]),l=Object(se.a)(s,2),i=l[0],u=l[1],d=t.map((function(e){return e.songs.map((function(t){return{createdAt:new Date(t.createdAt).toDateString(),title:t.title,artist:t.artist,purchasedBy:"".concat(t.student.firstName," ").concat(t.student.lastName),period:e.period,status:t.status,statusDescription:t.statusDescription,_id:t._id}}))})).flat(),m=Object(o.useState)([{title:"Request Date",field:"createdAt",editable:"never"},{title:"Song Title",field:"title"},{title:"Song Artist",field:"artist"},{title:"Purchased by",field:"purchasedBy",editable:"never"},{title:"Period",field:"period",editable:"never",render:function(e,t){return"row"===t?c.a.createElement(Mt.a,{label:e.period,color:"secondary"}):c.a.createElement(Mt.a,{label:e,color:"secondary"})}},{title:"Status",field:"status",lookup:{approved:"approved",pending:"pending","pending approval":"pending approval","pending removal":"pending removal",rejected:"rejected",removed:"removed"},render:function(e,t){return"row"===t?c.a.createElement("span",{style:{alignItems:"center",display:"flex"}},e.statusDescription?c.a.createElement(c.a.Fragment,null,e.status,c.a.createElement(Se.a,{arrow:!0,color:"primary",enterTouchDelay:0,title:e.statusDescription},c.a.createElement(Ct.a,{style:{marginLeft:"8px"}}))):e.status):c.a.createElement("span",null,e)}}]),p=Object(se.a)(m,1)[0];return Object(o.useEffect)((function(){return n(),function(){return r()}}),[]),Object(o.useEffect)((function(){u(d)}),[t]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Manage Song Requests"},c.a.createElement(mn,null)),c.a.createElement(ve.a,{title:"Song Requests",columns:p,data:i,localization:{body:{emptyDataSourceMessage:"No song requests have been submitted",editRow:{deleteText:"Delete song request?",saveTooltip:"Delete song"}}},options:{actionsColumnIndex:-1,paging:!1,grouping:!0},editable:{onRowDelete:function(e){return new Promise((function(t,n){var r=Object(ge.a)(i),o=e.tableData.id;r.splice(o,1),u(Object(ge.a)(r)),a(e._id),t()}))}}}))})),En=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.settings),e.purchases)}),(function(e){return{onDelete:function(t){return e({type:"DELETE_PURCHASE",payload:Ee.a.Purchases.delete(t),snackbar:{message:"Purchase removed",variant:"success"}})}}}))((function(e){var t=e.courses,a=e.onDelete,n=e.taxRate,r=Object(o.useState)([]),s=Object(se.a)(r,2),l=s[0],i=s[1],u=t.map((function(e){return e.purchases.map((function(t){return{createdAt:new Date(t.createdAt).toDateString(),note:t.note,period:e.period,products:t.products,purchasedBy:"".concat(t.student.firstName," ").concat(t.student.lastName),quantities:t.quantities,status:t.status,totalCost:t.products.reduce((function(e,a){return e+a.cost*t.quantities[a._id]*(n/100+1)}),0),totalItems:Object.values(t.quantities).reduce((function(e,t){return e+t}),0),_id:t._id}}))})).flat(),d=Object(o.useState)([{title:"Purchase Date",field:"createdAt",editable:"never"},{title:"Total Items",field:"totalItems"},{title:"Total Cost",field:"totalCost",render:function(e,t){return"row"===t?c.a.createElement(xe,{value:e.totalCost}):c.a.createElement(xe,{value:e})}},{title:"Purchased by",field:"purchasedBy"},{title:"Period",field:"period",editable:"never",render:function(e,t){return"row"===t?c.a.createElement(Mt.a,{label:e.period,color:"secondary"}):c.a.createElement(Mt.a,{label:e,color:"secondary"})}},{title:"Notes",field:"note"},{title:"Status",field:"status"}]),m=Object(se.a)(d,1)[0];return Object(o.useEffect)((function(){i(u)}),[t]),c.a.createElement(ve.a,{title:"Purchases",columns:m,data:l,localization:{body:{emptyDataSourceMessage:"No purchases have been made",editRow:{deleteText:"Delete purchase?",saveTooltip:"Delete purchase"}}},options:{actionsColumnIndex:-1,paging:!1,grouping:!0},detailPanel:function(e){return c.a.createElement(st,{products:e.products,quantities:e.quantities})},onRowClick:function(e,t,a){return a()},editable:{onRowDelete:function(e){return new Promise((function(t,n){var r=Object(ge.a)(l),o=e.tableData.id;r.splice(o,1),i(Object(ge.a)(r)),a(e._id),t()}))}}})})),fn=Object(y.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(he.a)({},e.breakpoints.up("lg"),{minHeight:e.spacing(54),width:e.spacing(100)})},icon:{marginRight:e.spacing(1)},panel:{minWidth:e.spacing(40),maxWidth:e.spacing(60)},purchaseNote:{backgroundColor:e.palette.grey[100],borderRadius:e.spacing(1),marginTop:e.spacing(2),padding:e.spacing(2)},removalAlert:{backgroundColor:e.palette.error.light,border:"2px solid ".concat(e.palette.error.dark),borderRadius:e.spacing(2),color:e.palette.common.white,fontSize:e.typography.h6.fontSize,padding:e.spacing(1),textAlign:"center",textTransform:"uppercase"},selected:{backgroundColor:e.palette.primary.main},songInfo:{marginBottom:e.spacing(4)},statusButton:{"&:hover":{backgroundColor:e.palette.primary.light}},studentInfo:Object(he.a)({alignItems:"center",display:"flex",justifyContent:"space-between",marginTop:e.spacing(4)},e.breakpoints.up("md"),{borderTopColor:e.palette.primary.main,borderTopStyle:"dotted",borderTopWidth:"4px",paddingTop:e.spacing(2)}),studentName:{alignItems:"center",display:"flex","& > div":{marginRight:e.spacing(1)}}}})),bn=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.settings),e.purchases)}),(function(e){return{onExit:function(){return e({type:"PURCHASES_DIALOG_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_PURCHASE",payload:Ee.a.Purchases.update(t)})}}}))((function(e){var t=e.courses,a=e.errors,n=e.inProgress,r=e.onExit,s=e.onUpdate,l=e.taxRate,i=Object(o.useState)(0),u=Object(se.a)(i,2),d=u[0],m=u[1],p=Object(o.useState)({}),E=Object(se.a)(p,2),f=E[0],b=E[1],g=Object(o.useState)(!1),h=Object(se.a)(g,2),O=h[0],v=h[1],y=Object(o.useState)(null),j=Object(se.a)(y,2),S=j[0],C=j[1],T=Object(o.useState)(""),N=Object(se.a)(T,2),_=N[0],P=N[1],w=Object(o.useState)([]),U=Object(se.a)(w,2),R=U[0],k=U[1],x=Object(o.useState)(null),L=Object(se.a)(x,2),I=L[0],q=L[1],B=Object(o.useState)(0),F=Object(se.a)(B,2),G=F[0],W=F[1],M=Object(Te.a)(),H=Object(Ne.a)(M.breakpoints.down("md")),V=fn(),z=function(){var e=0;if(t.length>0){var a,n=Object(ga.a)(t);try{for(n.s();!(a=n.n()).done;){e+=a.value.purchases.filter((function(e){return e.status.startsWith("pending")})).length}}catch(r){n.e(r)}finally{n.f()}}return e},Y=function(){m(0),v(!1),q(null),P(""),k([])},$=function(){var e=Object(K.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(Object(J.a)(Object(J.a)({},S),{},{id:S._id,note:_,status:I})),q(null),P("");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(e){q(e)};return Object(o.useEffect)((function(){W(z())})),Object(o.useEffect)((function(){!function(){var e=null===S||void 0===S?void 0:S._id;if(C(null),t.length>0){var a,n=Object(ga.a)(t);try{for(n.s();!(a=n.n()).done;){var r=a.value;if(r.purchases.length>0){var o=r.purchases.find((function(e){return e.status.startsWith("pending")&&!R.includes(e._id)}));if(o){o.period=r.period,C(o),e!==o._id&&m(d+1);break}}}}catch(c){n.e(c)}finally{n.f()}}}()}),[t,R]),c.a.createElement(c.a.Fragment,null,c.a.createElement(ee.a,{color:"primary",onClick:function(){v(!0),W(z())},variant:"extended"},c.a.createElement(un,{value:G},c.a.createElement(Ft.a,{className:V.icon}),"Process purchases")),c.a.createElement(_e.a,{className:V.dialog,fullScreen:H,onClick:function(e){return e.stopPropagation()},onClose:Y,onExit:r,onFocus:function(e){return e.stopPropagation()},open:O},c.a.createElement(Pe.a,null,"Process Purchases"),c.a.createElement(we.a,null,c.a.createElement(de,{errors:a}),S?c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(st,{actions:{add:function(e){return function(e){var t=Object(J.a)(Object(J.a)({},S),{},{products:S.products.findIndex((function(t){return t._id===e._id}))>-1?S.products:[].concat(Object(ge.a)(S.products),[e]),quantities:Object(J.a)(Object(J.a)({},S.quantities),{},Object(he.a)({},e._id,1)),id:S._id});s(t)}(e)},delete:function(e){return function(e,t){var a=t.products.filter((function(t){return t._id!==e})),n=Object(J.a)({},t.quantities);delete n[e],s(Object(J.a)(Object(J.a)({},t),{},{products:a,quantities:n,id:t._id}))}(e,S)},setInvoice:function(e){return b(e)},update:function(e,t){return function(e,t){var a=Object(J.a)(Object(J.a)({},S.quantities),{},Object(he.a)({},e,t));s(Object(J.a)(Object(J.a)({},S),{},{quantities:a,id:S._id}))}(e,t)}},products:S.products,quantities:S.quantities,taxRate:l})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("div",{className:V.panel},c.a.createElement("div",{className:V.studentInfo},c.a.createElement("div",{className:V.studentName},c.a.createElement(Mt.a,{color:"secondary",label:S.period}),c.a.createElement(A.a,null,S.student.firstName," ",S.student.lastName)),c.a.createElement(Ie,{cost:f.total,count:d,username:S.student.username})))),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("div",{className:V.panel},c.a.createElement(A.a,{variant:"h6"},"Status"),c.a.createElement(tn.a,{fullWidth:!0,size:"large"},c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,title:"Approve"},c.a.createElement(D.a,{className:"".concat(V.statusButton," ").concat("approved"===I&&V.selected),onClick:function(){return Z("approved")}},c.a.createElement(on.a,null))),c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,title:"Decline"},c.a.createElement(D.a,{className:"".concat(V.statusButton," ").concat("declined"===I&&V.selected),onClick:function(){return Z("declined")}},c.a.createElement(cn.a,null)))),c.a.createElement(Fe,{label:"Notes (optional)",name:"purchaseNote",onChange:P})))):c.a.createElement(ie.a,{severity:"info"},c.a.createElement(it.a,null,"All caught up!"),"There are no purchases to process at this time")),c.a.createElement(Ue.a,null,S&&c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{style:{marginRight:"auto"},variant:"subtitle2"},"Purchase ".concat(d," of ").concat(G)),c.a.createElement(D.a,{color:"primary",disabled:n||!I,onClick:$,variant:"contained"},n?"Saving...":"Save & Continue"),c.a.createElement(D.a,{disabled:n,onClick:function(){k([].concat(Object(ge.a)(R),[S._id])),q(null)},variant:"contained"},"Skip")),c.a.createElement(D.a,{disabled:n,onClick:Y,variant:"contained"},S?"Cancel":"Close"))))})),gn=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.currentUser),e.purchases)}),(function(e){return{onLoad:function(){return e({type:"TEACHER_PURCHASES_LOADED",payload:Ee.a.Purchases.forTeacher()})},onPageChange:function(t,a){return e({type:"NAV_TAB_CHANGE",value:t,redirectTo:a})},onUnload:function(){return e({type:"TEACHER_PURCHASES_UNLOADED"})}}}))((function(e){var t=e.onLoad,a=e.onPageChange,n=e.onUnload,r=e.role;return Object(o.useEffect)((function(){return t(),function(){n()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Manage Purchases"},c.a.createElement(D.a,{onClick:function(){return a("store","/".concat(r,"/products"))},size:"small"},"Manage Products"),c.a.createElement(bn,null)),c.a.createElement(En,null))})),hn=Object(y.a)((function(e){return{button:{marginRight:e.spacing(2)}}})),On=Object(r.c)((function(){return{}}),(function(e){return{onReset:function(t){return e({type:"WHATS_NEW_FLAGS_RESET",payload:Ee.a.Teachers.resetFlags(t),snackbar:{message:"".concat(t.charAt(0).toUpperCase()+t.slice(1)," flags reset"),variant:"success"}})}}}))((function(e){var t=e.onReset,a=Object(o.useState)(!1),n=Object(se.a)(a,2),r=n[0],s=n[1],l=hn(),i=function(){s(!1)},u=function(e){s(!1),t(e)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(D.a,{className:l.button,onClick:function(){s(!0)},size:"small"},"Reset Viewed Changes"),c.a.createElement(_e.a,{open:r,onClick:function(e){return e.stopPropagation()},onClose:i,onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Reset Viewed Changes"),c.a.createElement(we.a,null,c.a.createElement(mt.a,null,"Reset viewed changes flag for all student or teacher accounts?")),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{onClick:function(){return u("student")},color:"secondary",variant:"contained",autoFocus:!0},"Reset Students"),c.a.createElement(D.a,{onClick:function(){return u("teacher")},color:"secondary",variant:"contained",autoFocus:!0},"Reset Teachers"),c.a.createElement(D.a,{onClick:i,variant:"contained"},"Cancel"))))})),vn=Object(y.a)((function(e){return{icon:{marginRight:e.spacing(1)}}})),yn=Object(r.c)((function(e){return Object(J.a)({},e.teachers)}),(function(e){return{onAdd:function(t){return e({type:"ADD_TEACHER",payload:Ee.a.Auth.register(t),snackbar:{message:"Teacher added",variant:"success"}})},onExit:function(){return e({type:"TEACHER_DIALOG_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_TEACHER",payload:Ee.a.Teachers.update(t),snackbar:{message:"Teacher updated",variant:"success"}})}}}))((function(e){var t=e.errors,a=e.inProgress,n=e.onAdd,r=e.onExit,s=e.onUpdate,l=e.teacher,i=Object(o.useState)(!1),u=Object(se.a)(i,2),d=u[0],m=u[1],p=Object(Te.a)(),E=Object(Ne.a)(p.breakpoints.down("md")),f=vn(),b=function(){m(!0)},g=function(){m(!1)},h=function(e){n(Object(J.a)(Object(J.a)({},e),{},{role:"teacher"}))},O=function(e){s(Object(J.a)(Object(J.a)({},l),e))};return Object(o.useEffect)((function(){a||t||m(!1)}),[a]),c.a.createElement(c.a.Fragment,null,l?c.a.createElement(Ce,{action:"Update teacher",onClick:b},c.a.createElement(je.a,null)):c.a.createElement(ee.a,{color:"primary",onClick:b,variant:"extended"},c.a.createElement(Je.a,{className:f.icon}),"Add teacher"),c.a.createElement(_e.a,{fullScreen:E,open:d,onClose:g,onClick:function(e){return e.stopPropagation()},onExit:r,onFocus:function(e){return e.stopPropagation()}},c.a.createElement($.c,{initialValues:{firstName:(null===l||void 0===l?void 0:l.firstName)||"",lastName:(null===l||void 0===l?void 0:l.lastName)||"",username:(null===l||void 0===l?void 0:l.username)||"",password:""},validationSchema:X.c({firstName:X.d().required("Required"),lastName:X.d().required("Required"),username:X.d().required("Required"),password:X.d().required(l?"":"Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l?O(t):h(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement($.b,null,c.a.createElement(Pe.a,null,l?"Edit Teacher":"Add Teacher"),c.a.createElement(we.a,null,c.a.createElement(de,{errors:t}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{autoFocus:!l,color:"primary",component:Z.c,disabled:a,label:"First Name",name:"firstName",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:a,label:"Last Name",name:"lastName",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:!!l||a,label:"Username",name:"username",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:a,label:"Password",name:"password",type:"text",fullWidth:!0})))),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{color:"primary",disabled:a,type:"submit",variant:"contained"},l?a?"Updating...":"Update":a?"Adding...":"Add"),c.a.createElement(D.a,{disabled:a,onClick:g,variant:"contained"},"Cancel"))))))})),jn=a(584),Sn=a(634),An=a(581),Dn=Object(r.c)((function(){return{}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_TEACHER",payload:Ee.a.Teachers.delete(t),snackbar:{message:"Teacher deleted",variant:"success"}})}}}))((function(e){var t=e.onDelete,a=e.teacher,n=Object(o.useState)(!1),r=Object(se.a)(n,2),s=r[0],l=r[1],i=function(){l(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Delete teacher",onClick:function(){l(!0)}},c.a.createElement(Qe.a,null)),c.a.createElement(_e.a,{open:s,onClick:function(e){return e.stopPropagation()},onClose:i,onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Delete Teacher"),c.a.createElement(we.a,null,c.a.createElement(mt.a,{component:"div"},"Are you sure you want to delete"," ",c.a.createElement("b",null,a.firstName," ",a.lastName),"? This action will permanently delete:",c.a.createElement("ul",null,c.a.createElement("li",null,"all student accounts"),c.a.createElement("li",null,"all song requests"),c.a.createElement("li",null,"all transactions"),c.a.createElement("li",null,"all purchases"),c.a.createElement("li",null,"all products"),c.a.createElement("li",null,"all scores")),"associated with this teacher. This action ",c.a.createElement("b",null,"cannot be undone"),".")),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{onClick:function(){l(!1),t(a)},color:"secondary",variant:"contained",autoFocus:!0},"Delete"),c.a.createElement(D.a,{onClick:i,variant:"contained"},"Cancel"))))})),Cn=Object(y.a)((function(e){return{teacherDetails:{display:"block"},teacherHeader:{alignItems:"center",display:"flex",justifyContent:"space-between",width:"100%"},teacherUsername:{marginRight:e.spacing(2),minWidth:e.spacing(12)},teacherName:{flexGrow:"1"}}})),Tn=function(e){var t=e.teacher,a=function(e){return e?Object.values(e).flat().length:0};return c.a.createElement("div",null,c.a.createElement(A.a,{variant:"h6",gutterBottom:!0},"Teacher Stats"),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(Zt,{icon:c.a.createElement(qt.a,{fontSize:"large"}),title:"Assignments",value:a(t.tasks)}),c.a.createElement(Zt,{icon:c.a.createElement(Ft.a,{fontSize:"large"}),title:"Online Purchases",value:a(t.purchases)}),c.a.createElement(Zt,{icon:c.a.createElement(I.a,{fontSize:"large"}),title:"Products",value:t.products?t.products.length:0}),c.a.createElement(Zt,{icon:c.a.createElement(Bt.a,{fontSize:"large"}),title:"Scores",value:a(t.scores)}),c.a.createElement(Zt,{icon:c.a.createElement(rn.a,{fontSize:"large"}),title:"Songs",value:a(t.songs)}),c.a.createElement(Zt,{icon:c.a.createElement(x.a,{fontSize:"large"}),title:"Transactions",value:a(t.transactions)})))},Nn=function(e){var t=e.teacher,a=function(e){var t=e.icon,a=e.primary,n=e.secondary;return c.a.createElement(jn.a,{alignItems:"flex-start"},c.a.createElement(Sn.a,null,c.a.createElement(Jt.a,null,t)),c.a.createElement(la.a,{primary:a,secondary:n}))};return c.a.createElement("div",null,c.a.createElement(A.a,{variant:"h6",gutterBottom:!0},"Courses"),c.a.createElement(ae.a,{container:!0,spacing:2},t.courses&&t.courses.length>0?t.courses.map((function(e,n){return c.a.createElement(ae.a,{item:!0,xs:12,md:6,lg:4,key:n},c.a.createElement(Qt.a,{variant:"outlined"},c.a.createElement(Kt.a,null,c.a.createElement(A.a,{gutterBottom:!0,variant:"h5"},e.name),c.a.createElement(Mt.a,{color:"secondary",label:"Period ".concat(e.period),size:"small",style:{color:"white",marginRight:"8px"}}),c.a.createElement(Mt.a,{color:"primary",label:"".concat(e.students.length," student").concat(1===e.students.length?"":"s"),size:"small",variant:"outlined"}),c.a.createElement(An.a,null,c.a.createElement(a,{icon:c.a.createElement(qt.a,null),primary:"Assignments",secondary:t.tasks[e._id].length}),c.a.createElement(a,{icon:c.a.createElement(Ft.a,null),primary:"Online Purchases",secondary:t.purchases[e._id].length}),c.a.createElement(a,{icon:c.a.createElement(Bt.a,null),primary:"Scores",secondary:t.scores[e._id].length}),c.a.createElement(a,{icon:c.a.createElement(rn.a,null),primary:"Song Requests",secondary:t.songs[e._id].length}),c.a.createElement(a,{icon:c.a.createElement(x.a,null),primary:"Transactions",secondary:t.transactions[e._id].length})))))})):c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,null,"No courses have been created"))))},_n=function(e){var t=e.settings,a=function(e){var t=e.value,a=typeof t,n=JSON.stringify(t);return"boolean"===a?c.a.createElement(Mt.a,{color:t?"primary":"secondary",label:n,style:{color:"white"}}):"object"===a&&t.hasOwnProperty("_id")?t._id:n};return c.a.createElement("div",null,c.a.createElement(A.a,{variant:"h6",gutterBottom:!0},"Settings"),c.a.createElement(We.a,null,c.a.createElement(Me.a,null,c.a.createElement(He.a,null,c.a.createElement(Ve.a,null,"Setting"),c.a.createElement(Ve.a,null,"Value"))),c.a.createElement(ze.a,null,Object.keys(t).map((function(e,n){return c.a.createElement(He.a,{key:n},c.a.createElement(Ve.a,null,e),c.a.createElement(Ve.a,null,c.a.createElement(a,{value:t[e]})))})))))},Pn=function(e){var t=e.teachers,a=Object(o.useState)(!1),n=Object(se.a)(a,2),r=n[0],s=n[1],l=Cn();return c.a.createElement(c.a.Fragment,null,(null===t||void 0===t?void 0:t.length)>0?t.map((function(e){return c.a.createElement(xa.a,{expanded:r===e.username,key:e.username,onChange:(t=e.username,function(e,a){s(!!a&&t)})},c.a.createElement(La.a,{expandIcon:c.a.createElement(qa.a,null)},c.a.createElement("div",{className:l.teacherHeader},c.a.createElement(Mt.a,{color:"secondary",label:e.username,className:l.teacherUsername}),c.a.createElement(A.a,{className:l.teacherName,variant:"h5"},e.firstName," ",e.lastName),c.a.createElement(yn,{teacher:e}),c.a.createElement(Dn,{teacher:e}))),c.a.createElement(Ia.a,{className:l.teacherDetails},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(Tn,{teacher:e})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(Nn,{teacher:e})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(_n,{settings:e.settings})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,null,c.a.createElement("b",null,"Viewed Changes"),":"," ",e.viewedChanges?"yes":"no")))));var t})):c.a.createElement(A.a,null,"No teachers found"))},wn=Object(r.c)((function(e){return Object(J.a)({},e.teachers)}),(function(e){return{onLoad:function(){return e({type:"MANAGE_TEACHERS_PAGE_LOADED",payload:Ee.a.Teachers.getAll()})},onUnload:function(){return e({type:"MANAGE_TEACHERS_PAGE_UNLOADED"})}}}))((function(e){var t=e.onLoad,a=e.onUnload,n=e.pageLoaded,r=e.teachers;return Object(o.useEffect)((function(){return t(),function(){a()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Manage Teachers"},c.a.createElement(On,null),c.a.createElement(yn,null)),n?c.a.createElement(Pn,{teachers:r}):c.a.createElement(Yt,{message:"Loading..."}))})),Un=Object(y.a)((function(e){return{header:{backgroundColor:"white",paddingLeft:e.spacing(1),paddingRight:e.spacing(1),position:"absolute",top:"-18px"},img:{maxHeight:"100%",maxWidth:"100%",minWidth:"20px"},window:{alignItems:"center",display:"flex",borderColor:e.palette.secondary.main,borderStyle:"solid",borderWidth:"4px",height:"300px",justifyContent:"center",padding:e.spacing(2),position:"relative"}}})),Rn=function(e){var t=e.src,a=Un();return c.a.createElement("div",{className:a.window},c.a.createElement(A.a,{variant:"h6",className:a.header},"Image Preview"),t?c.a.createElement("img",{className:a.img,src:rt(t)}):c.a.createElement(A.a,null,"No photo url provided"))},kn=function(e){return c.a.createElement(qe.a,Object.assign({error:Boolean(e.errors),inputProps:{maxLength:e.limit},helperText:e.errors?"".concat(e.errors," | ").concat(e.value.length,"/").concat(e.limit):"".concat(e.value.length,"/").concat(e.limit)},e))},xn=Object(y.a)((function(e){return{addIcon:{marginRight:e.spacing(1)},updateIcon:{color:"rgba(255, 255, 255, 0.7)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.3)",color:"white"}}}})),Ln=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.products),{},{currentUser:e.common.currentUser})}),(function(e){return{onAdd:function(t){return e({type:"ADD_PRODUCT",payload:Ee.a.Products.add(t),snackbar:{message:"Product added",variant:"success"}})},onExit:function(){return e({type:"PRODUCT_DIALOG_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_PRODUCT",payload:Ee.a.Products.update(t),snackbar:{message:"Product updated",variant:"success"}})}}}))((function(e){var t=e.currentUser,a=e.product,n=e.errors,r=e.inProgress,s=e.onAdd,l=e.onExit,i=e.onUpdate,u=60,d=140,m=Object(o.useState)(!1),p=Object(se.a)(m,2),E=p[0],f=p[1],b=Object(Te.a)(),g=Object(Ne.a)(b.breakpoints.down("md")),h=xn(),O=function(){f(!0)},v=function(){f(!1)},y=function(e){s(Object(J.a)({},e))},j=function(e){i(Object(J.a)(Object(J.a)({},a),e))};return Object(o.useEffect)((function(){r||n||f(!1)}),[r]),c.a.createElement(c.a.Fragment,null,a?"teacher"===t.role&&c.a.createElement(Ce,{action:"Edit product",onClick:O,className:h.updateIcon},c.a.createElement(je.a,null)):c.a.createElement(ee.a,{color:"primary",onClick:O,variant:"extended"},c.a.createElement(Je.a,{className:h.addIcon}),"Add product"),c.a.createElement(_e.a,{fullScreen:g,maxWidth:"lg",onClick:function(e){return e.stopPropagation()},onClose:v,onExit:l,onFocus:function(e){return e.stopPropagation()},open:E},c.a.createElement($.c,{initialValues:{name:(null===a||void 0===a?void 0:a.name)||"",description:(null===a||void 0===a?void 0:a.description)||"",photoUrl:(null===a||void 0===a?void 0:a.photoUrl)||"",cost:(null===a||void 0===a?void 0:a.cost)||0,maxPurchaseQuantity:(null===a||void 0===a?void 0:a.maxPurchaseQuantity)||0,quantity:(null===a||void 0===a?void 0:a.quantity)||0},validationSchema:X.c({name:X.d().max(u,"Cannot be longer than ".concat(u," characters")).required("Required"),description:X.d().max(d,"Cannot be longer than ".concat(d," characters")),photoUrl:X.d().url("Not a valid url").required("Required"),cost:X.b().typeError("Numbers only").required("Required"),maxPurchaseQuantity:X.b().typeError("Numbers only").required("Required"),quantity:X.b().typeError("Numbers only").required("Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a?j(t):y(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},(function(e){return c.a.createElement($.b,null,c.a.createElement(Pe.a,null,a?"Edit product":"Add product"),c.a.createElement(we.a,null,c.a.createElement(de,{errors:n}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement($.a,{as:kn,autoFocus:!a,color:"primary",disabled:r,label:"Product Name",name:"name",type:"text",limit:u,errors:e.errors.name,fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement($.a,{as:kn,color:"primary",disabled:r,label:"Product Description",name:"description",type:"text",limit:d,errors:e.errors.description,fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Photo Url",name:"photoUrl",type:"url",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Cost",name:"cost",type:"number",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Quantity",name:"quantity",type:"number",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Max purchase quantity",name:"maxPurchaseQuantity",type:"number",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement(Rn,{src:e.values.photoUrl})))),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{disabled:r,color:"primary",type:"submit",variant:"contained"},a?r?"Updating...":"Update":r?"Adding...":"Add"),c.a.createElement(D.a,{disabled:r,onClick:v,variant:"contained"},"Cancel")))}))))})),In=a(630),qn=a(631),Bn=a(632),Fn=a(664),Gn=Object(y.a)((function(e){return{icon:{color:"rgba(255, 255, 255, 0.7)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.3)",color:"white"}}}})),Wn=Object(r.c)((function(e){return{currentUser:e.common.currentUser}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_PRODUCT",payload:Ee.a.Products.delete(t),snackbar:{message:"Product deleted",variant:"success"}})}}}))((function(e){var t=e.currentUser,a=e.product,n=e.onDelete,r=Gn(),s=Object(o.useState)(!1),l=Object(se.a)(s,2),i=l[0],u=l[1],d=function(){u(!1)};return c.a.createElement(c.a.Fragment,null,"teacher"===t.role&&c.a.createElement(Ce,{action:"Delete product",onClick:function(){u(!0)},className:r.icon},c.a.createElement(Qe.a,null)),c.a.createElement(_e.a,{open:i,onClose:d,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Delete Product"),c.a.createElement(we.a,null,c.a.createElement(mt.a,{component:"div"},"Are you sure you want to delete ",c.a.createElement("b",null,a.name),"? This action"," ",c.a.createElement("b",null,"cannot be undone"),".")),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{onClick:function(){u(!1),n(a.slug)},color:"secondary",variant:"contained",autoFocus:!0},"Delete"),c.a.createElement(D.a,{onClick:d,variant:"contained"},"Cancel"))))})),Mn=Object(y.a)((function(e){return{actionIcon:{display:"flex"},cost:{color:"white"},description:{marginBottom:"-1.5rem",opacity:0,transition:"opacity 0s ease-in-out"},icon:{color:"rgba(255, 255, 255, 0.7)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.3)",color:"white"}},name:{color:e.palette.secondary.main,fontSize:e.typography.h5.fontSize,marginBottom:e.spacing(.5),whiteSpace:"nowrap"},quantity:{marginLeft:e.spacing(2)},tile:{"&:hover .MuiGridListTileBar-root":{height:"100%","& #description":{marginBottom:0,opacity:1,transition:"margin-bottom 0.35s ease-in-out, opacity 0.5s ease-in-out"}}},tileBar:{alignItems:"flex-end",paddingBottom:e.spacing(1),paddingRight:e.spacing(1),transition:"height 0.35s ease-in-out"},title:{whiteSpace:"normal"}}})),Hn=function(e){var t=e.onAddToCart,a=e.onInventoryChange,n=e.cart,r=e.products,o=e.storeEnabled,s=e.userRole,l=Mn(),i=Object(Te.a)(),u=Object(Ne.a)(i.breakpoints.down("sm")),d=Object(Ne.a)(i.breakpoints.down("md")),m=u?1:d||"teacher"===s?2:3,p=function(e,t){return a(Object(J.a)(Object(J.a)({},e),{},{quantity:"add"===t?e.quantity+1:e.quantity-1}))};return c.a.createElement("div",null,c.a.createElement(In.a,{cols:m,spacing:8},(null===r||void 0===r?void 0:r.length)>0?r.map((function(e){var a=e.maxPurchaseQuantity<e.quantity&&0!==e.maxPurchaseQuantity?e.maxPurchaseQuantity:e.quantity,r=a>0&&(null===n||void 0===n?void 0:n.quantities[e._id])>=a;return c.a.createElement(qn.a,{key:e.slug,className:l.tile},c.a.createElement("img",{src:rt(e.photoUrl),alt:e.name}),c.a.createElement(Bn.a,{classes:{actionIcon:l.actionIcon,title:l.title},className:l.tileBar,title:c.a.createElement("div",null,c.a.createElement("div",{className:l.description,id:"description"},e.description," ",e.maxPurchaseQuantity>0&&c.a.createElement("em",null,"(Limit ",e.maxPurchaseQuantity,")")),c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,placement:"bottom-start",title:e.name},c.a.createElement("div",{className:l.name},e.name))),subtitle:c.a.createElement("div",null,c.a.createElement(Mt.a,{className:l.cost,color:"primary",label:c.a.createElement(xe,{value:e.cost}),size:"small"}),("teacher"===s||e.quantity<5)&&c.a.createElement(Mt.a,{className:l.quantity,color:"secondary",label:"teacher"===s?"".concat(e.quantity," available"):"only ".concat(e.quantity," left"),size:"small",variant:"outlined"})),actionIcon:"teacher"===s?c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Remove inventory",className:l.icon,onClick:function(){return p(e,"remove")}},c.a.createElement(Fn.a,null)),c.a.createElement(Ce,{action:"Add inventory",className:l.icon,onClick:function(){return p(e,"add")}},c.a.createElement(Je.a,null)),c.a.createElement(Ln,{product:e}),c.a.createElement(Wn,{product:e})):o&&c.a.createElement(Ce,{action:r?"Max limit reached":"Add to cart",disabled:r,onClick:function(){return function(e){return t(e)}(e)},className:l.icon},c.a.createElement(sn.a,{badgeContent:n.quantities[e._id],color:"secondary"},c.a.createElement(Re.a,null)))}))})):c.a.createElement(A.a,null,"teacher"===s?"You have no products":"Your teacher has not added any products")))},Vn=a(446),zn=a.n(Vn),Yn=a(445),Qn=a.n(Yn),Kn=Object(y.a)((function(e){return{title:{color:e.palette.common.white,margin:"0 auto"}}})),Jn=function(e){var t=e.onClose,a=e.title,n=Kn();return c.a.createElement(j.a,{position:"relative"},c.a.createElement(S.a,null,c.a.createElement(Ae.a,{edge:"start",onClick:t},c.a.createElement(ye.a,null)),c.a.createElement(A.a,{variant:"h5",className:n.title},a)))},$n=Object(y.a)((function(e){return{cartIcon:{marginRight:e.spacing(1)}}})),Zn=Object(r.c)((function(e){return Object(J.a)(Object(J.a)(Object(J.a)(Object(J.a)({},e.common.currentUser),e.common.settings),e.purchases),e.scores.total)}),(function(e){return{onDelete:function(t){return e({type:"DELETE_CART_PRODUCT",productId:t})},onLoad:function(t){return e({type:"STUDENT_CART_LOADED",payload:Ee.a.Scores.getStudentScores(t)})},onSubmit:function(t){return e({type:"SUBMIT_PURCHASE",payload:Ee.a.Purchases.add(t),snackbar:{message:"Order submitted",variant:"success"}})},onUnload:function(){return e({type:"STUDENT_CART_UNLOADED"})},onUpdate:function(t,a){return e({type:"UPDATE_CART_PRODUCT_QUANTITY",productId:t,qty:a})}}}))((function(e){var t=e.allowPurchasesWithInsufficientFunds,a=e.balance,n=e.cart,r=e.errors,s=e.inProgress,l=e.onDelete,i=e.onLoad,u=e.onSubmit,d=e.onUnload,m=e.onUpdate,p=e.taxRate,E=e.username,f=Object(o.useState)(!1),b=Object(se.a)(f,2),g=b[0],h=b[1],O=nt(n.products,n.quantities,p).invoice,y=$n(),j=function(){return h(!1)},S=Object.values(n.quantities).reduce((function(e,t){return e+t}),0),A=!t&&O.total>a;return Object(o.useEffect)((function(){return i(E),function(){d()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(ee.a,{color:"primary",disabled:0===n.products.length,onClick:function(){return h(!0)},variant:"extended"},c.a.createElement(un,{value:S},c.a.createElement(Qn.a,{className:y.cartIcon}),"Checkout")),c.a.createElement(_e.a,{fullScreen:!0,open:g,onClick:function(e){return e.stopPropagation()},onClose:j,onFocus:function(e){return e.stopPropagation()},TransitionComponent:ea},c.a.createElement(Jn,{onClose:j,title:"Store"}),c.a.createElement(H,null,c.a.createElement(v.a,null,c.a.createElement(pe,{title:"Complete Your Order"},c.a.createElement(ee.a,{color:"primary",disabled:0===n.products.length||A,onClick:function(){u({products:n.products,quantities:n.quantities,status:"pending"}),j()},variant:"extended"},c.a.createElement(zn.a,{className:y.cartIcon}),"Place Your Order")),c.a.createElement(de,{errors:r}),(A||O.total>a)&&c.a.createElement(xt,{disableClose:!0,severity:"warning"},"Insufficient funds! You have ",c.a.createElement(xe,{value:a})),s?c.a.createElement(Yt,{message:"Loading..."}):c.a.createElement(st,{actions:{delete:l,update:m},products:n.products,quantities:n.quantities})))))})),Xn=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.settings),e.purchases)}),(function(e){return{onDelete:function(t){return e({type:"STUDENT_DELETE_PURCHASE",payload:Ee.a.Purchases.delete(t),snackbar:{message:"Purchase deleted",variant:"success"}})}}}))((function(e){var t=e.onDelete,a=e.purchases,n=e.taxRate,r=Object(o.useState)([]),s=Object(se.a)(r,2),l=s[0],i=s[1],u=a.map((function(e){return{createdAt:new Date(e.createdAt).toDateString(),note:e.note,quantities:e.quantities,products:e.products,status:e.status,totalCost:e.products.reduce((function(t,a){return t+a.cost*e.quantities[a._id]*(n/100+1)}),0),totalItems:Object.values(e.quantities).reduce((function(e,t){return e+t}),0),_id:e._id}})),d=Object(o.useState)([{title:"Purchase Date",field:"createdAt",editable:"never"},{title:"Total Items",field:"totalItems"},{title:"Total Cost",field:"totalCost",render:function(e){return c.a.createElement(xe,{value:e.totalCost})}},{title:"Notes",field:"note"},{title:"Status",field:"status"}]),m=Object(se.a)(d,1)[0];return Object(o.useEffect)((function(){i(u)}),[a]),c.a.createElement(ve.a,{title:"Orders",columns:m,data:l,localization:{body:{emptyDataSourceMessage:"No purchases have been made",editRow:{deleteText:"Delete purchase? This will cancel your order",saveTooltip:"Delete purchase"}}},options:{actionsColumnIndex:-1,paging:!1,showTitle:!1},detailPanel:function(e){return c.a.createElement(st,{products:e.products,quantities:e.quantities})},onRowClick:function(e,t,a){return a()},editable:{isDeletable:function(e){return"pending"===e.status},onRowDelete:function(e){return new Promise((function(a,n){var r=Object(ge.a)(l),o=e.tableData.id;r.splice(o,1),i(Object(ge.a)(r)),t(e._id),a()}))}}})})),er=Object(r.c)((function(e){return Object(J.a)({},e.purchases)}),(function(e){return{onLoad:function(){return e({type:"STUDENT_PURCHASES_LOADED",payload:Ee.a.Purchases.forStudent()})},onUnload:function(){return e({type:"STUDENT_PURCHASES_UNLOADED"})}}}))((function(e){var t=e.errors,a=e.inProgress,n=e.onLoad,r=e.onUnload,s=Object(o.useState)(!1),l=Object(se.a)(s,2),i=l[0],u=l[1],d=function(){u(!1),r()};return c.a.createElement(c.a.Fragment,null,c.a.createElement(D.a,{onClick:function(){u(!0),n()},size:"small"},"Your orders"),c.a.createElement(_e.a,{fullScreen:!0,open:i,onClick:function(e){return e.stopPropagation()},onClose:d,onFocus:function(e){return e.stopPropagation()},TransitionComponent:ea},c.a.createElement(Jn,{onClose:d,title:"Store"}),c.a.createElement(H,null,c.a.createElement(v.a,null,c.a.createElement(pe,{title:"Your Orders"}),c.a.createElement(de,{errors:t}),a?c.a.createElement(Yt,{message:"Loading..."}):c.a.createElement(Xn,null)))))})),tr=Object(r.c)((function(e){return Object(J.a)(Object(J.a)(Object(J.a)({settings:e.common.settings},e.common.currentUser),e.products),e.purchases)}),(function(e){return{onAddToCart:function(t){return e({type:"ADD_TO_CART",product:t})},onLoad:function(){return e({type:"PRODUCTS_PAGE_LOADED",payload:Ee.a.Products.getAll()})},onPageChange:function(t,a){return e({type:"NAV_TAB_CHANGE",value:t,redirectTo:a})},onUnload:function(){return e({type:"PRODUCTS_PAGE_UNLOADED"})},onUpdateInventory:function(t){return e({type:"UPDATE_PRODUCT",payload:Ee.a.Products.update(t)})}}}))((function(e){var t=e.cart,a=e.onAddToCart,n=e.onLoad,r=e.onPageChange,s=e.onUnload,l=e.onUpdateInventory,i=e.pageLoaded,u=e.products,d=e.role,m=e.settings;Object(o.useEffect)((function(){return n(),function(){s()}}),[]);var p="teacher"===d,E=u.filter((function(e){return e.quantity>0})),f=u.filter((function(e){return e.quantity<=0})),b=function(e){return l(e)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:p?"Manage Products":"View Products"},p?c.a.createElement(c.a.Fragment,null,m.storeEnabled&&c.a.createElement(D.a,{onClick:function(){return r("store","/".concat(d,"/store"))},size:"small"},"Manage purchases"),c.a.createElement(Ln,null)):m.storeEnabled&&c.a.createElement(c.a.Fragment,null,c.a.createElement(er,null),c.a.createElement(Zn,null))),i?c.a.createElement(ae.a,{container:!0,spacing:8},c.a.createElement(ae.a,{item:!0,xs:12},p?c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"In Stock"),c.a.createElement(Hn,{onInventoryChange:b,products:E,userRole:d})):c.a.createElement(Hn,{cart:t,products:E,onAddToCart:function(e){return a(e)},storeEnabled:m.storeEnabled,userRole:d})),p&&c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Out of Stock"),c.a.createElement(Hn,{onInventoryChange:b,products:f,userRole:d}))):c.a.createElement(Yt,{message:"Loading..."}))})),ar=Object(r.c)((function(e){return{currentUser:e.common.currentUser}}),(function(){return{}}))((function(e){var t=e.currentUser;return t?c.a.createElement(c.a.Fragment,null,c.a.createElement(U,{currentUser:t}),c.a.createElement(H,null,c.a.createElement(v.a,null,c.a.createElement(i.d,null,c.a.createElement(z,{path:"/student/account",component:St}),c.a.createElement(z,{path:"/student/settings",component:be}),c.a.createElement(z,{path:"/student/songs",component:Ut}),c.a.createElement(z,{path:"/student/store",component:tr}),c.a.createElement(z,{path:"/teacher/accounts",component:Ua}),c.a.createElement(z,{path:"/teacher/courses",component:en}),c.a.createElement(z,{path:"/teacher/products",component:tr}),c.a.createElement(z,{path:"/teacher/settings",component:be}),c.a.createElement(z,{path:"/teacher/songs",component:pn}),c.a.createElement(z,{path:"/teacher/store",component:gn}),c.a.createElement(z,{path:"/admin/settings",component:be}),c.a.createElement(z,{path:"/admin/teachers",component:wn}),c.a.createElement(i.b,{component:V}))),c.a.createElement(W,null))):c.a.createElement(i.a,{to:"/login"})})),nr=a(277),rr=a.n(nr),or=a(278),cr=a.n(or),sr=Object(y.a)((function(e){return{background:{alignItems:"center",backgroundImage:"url(".concat(cr.a,")"),backgroundSize:"cover",display:"flex",height:"100%",justifyContent:"center"},logo:{marginBottom:e.spacing(4),width:160},panel:{alignItems:"center",borderRadius:"1rem",display:"flex",flexFlow:"column nowrap",overflowY:"scroll",padding:"2rem 4rem",position:"relative"},text:{color:e.palette.primary.main,fontStyle:"italic"}}})),lr=function(e){var t=sr();return c.a.createElement(rr.a,{className:t.background},c.a.createElement(te.a,{elevation:12,className:t.panel},c.a.createElement(N,{className:t.logo}),c.a.createElement(A.a,{className:t.text,variant:"h4"},"Loading...")))},ir=a(125),ur=a(406),dr=a(665),mr=a(633),pr=a(447),Er=a.n(pr),fr=Object(y.a)((function(e){return{page:{"& p:not(:last-of-type)":{marginBottom:e.spacing(2)}},profile:{borderRadius:"100%",boxShadow:e.shadows[10],float:"right",marginBottom:e.spacing(2),marginLeft:e.spacing(2),width:"120px"}}})),br=function(){var e=fr();return c.a.createElement(ae.a,{className:e.page,container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{align:"center",gutterBottom:!0,variant:"h5"},"What is Chem Cash?"),c.a.createElement("img",{className:e.profile,src:Er.a}),c.a.createElement(A.a,{variant:"body2"},"Hi! I'm Joseph May, a high school chemistry teacher from Las Vegas. While I love teaching chemistry, I also love programming for the web, so why not combine the two."),c.a.createElement(A.a,{variant:"body2"},"Chem Cash is a points-based rewards system I use in my classroom. The idea for this site came from a colleage who was inspired by one of his own high school science teachers."),c.a.createElement(A.a,{variant:"body2"},"Students earn points in two ways: (1) through payouts based on their assessment scores and (2) with bonus points earned for anything I deam worthy of reward such as winning in-class competitions or going above and beyond to help me or a student."),c.a.createElement(A.a,{variant:"body2"},'These points can be used to "purchase" goods such as school supplies, electronics, and anything I can find for cheap or get for free.'),c.a.createElement(A.a,{variant:"body2"},"However, the hottest-selling item is song requests. During work time in my class I play music for my students. Each class period has its own playlist and students can only add songs to the playlist by spending their Chem Cash points."),c.a.createElement(A.a,{variant:"body2"},"I created this program to help manage all of the logistics behind this system of incentives. While it can support multiple teachers, I am running it on no-cost servers, so it was not intended to be a public program. Although, if you are interested in learning more, please reach out to me"," ",c.a.createElement(mr.a,{href:"mailto:jwmay87+chemcash@gmail.com"},"here"),".")))},gr=Object(r.c)((function(e){return Object(J.a)({},e.auth)}),(function(e){return{onSubmit:function(t,a){return e({type:P,payload:Ee.a.Auth.login(t,a)})}}}))((function(e){return c.a.createElement($.c,{initialValues:{username:"",password:""},validationSchema:X.c({username:X.d().required("Required"),password:X.d().required("Required")}),onSubmit:function(t){!function(t,a){e.onSubmit(t,a)}(t.username,t.password)}},c.a.createElement($.b,null,c.a.createElement(ae.a,{container:!0,spacing:4},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(de,{errors:e.errors}),c.a.createElement($.a,{component:Z.c,disabled:e.inProgress,fullWidth:!0,label:"Username",name:"username",type:"text",variant:"outlined"})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement($.a,{component:Z.c,disabled:e.inProgress,fullWidth:!0,label:"Password",name:"password",type:"password",variant:"outlined"})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(D.a,{color:"primary",disabled:e.inProgress,size:"large",type:"submit",variant:"contained"},e.inProgress?"Loading...":"Login")))))})),hr=Object(y.a)((function(e){return{aboutLink:{bottom:e.spacing(2),position:"absolute",right:e.spacing(4)},loginLink:{marginBottom:e.spacing(2),"& > a":{textDecoration:"none"}},logo:{display:"block",margin:"0 auto",width:120},page:Object(he.a)({alignItems:"center",backgroundImage:"url(".concat(cr.a,")"),backgroundSize:"cover",display:"flex",height:"100%",justifyContent:"center"},e.breakpoints.up("lg"),{backgroundSize:"initial",justifyContent:"flex-end"}),panel:Object(he.a)({borderRadius:"1rem",maxHeight:"90%",overflowY:"scroll",padding:"4rem 2rem",position:"relative",width:"80%"},e.breakpoints.up("lg"),{borderRadius:"0",height:"100%",maxHeight:"100%",width:"40%"}),progress:{height:10,left:"0",position:"absolute",top:"0",width:"100%"}}})),Or=function(){var e=hr();return c.a.createElement("span",{className:e.aboutLink},c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,title:"Learn more"},c.a.createElement(ir.a,{to:"/about"},c.a.createElement(Ct.a,{color:"secondary",fontSize:"small"}))))},vr=function(){var e=hr();return c.a.createElement("div",{className:e.loginLink},c.a.createElement(ir.a,{to:"/login"},c.a.createElement(D.a,{color:"secondary",startIcon:c.a.createElement(dr.a,null)},"Login")))},yr=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.auth),{},{currentUser:e.common.currentUser,pathname:e.router.location.pathname})}),(function(e){return{onUnload:function(){return e({type:"LOGIN_PAGE_UNLOADED"})}}}))((function(e){var t=e.currentUser,a=e.inProgress,n=e.onUnload,r=e.pathname,s=hr();return Object(o.useEffect)((function(){return function(){return n()}}),[]),t?c.a.createElement(i.a,{to:"/"}):c.a.createElement(rr.a,null,c.a.createElement("div",{className:s.page},c.a.createElement(te.a,{elevation:12,className:s.panel},a&&c.a.createElement(ur.a,{className:s.progress}),c.a.createElement(ae.a,{container:!0,spacing:4},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(N,{className:s.logo})),c.a.createElement(ae.a,{item:!0,xs:12},r.includes("about")?c.a.createElement(c.a.Fragment,null,c.a.createElement(vr,null),c.a.createElement(br,null)):c.a.createElement(c.a.Fragment,null,c.a.createElement(Or,null),c.a.createElement(gr,null)))))))})),jr=a(331),Sr=function(e){var t=e.snackbar,a=Object(jr.b)().enqueueSnackbar;return Object(o.useEffect)((function(){t&&a(t.message,{variant:t.variant})}),[t]),e.children},Ar=Object(r.c)((function(e){return{snackbar:e.notifier.snackbar}}),(function(e){return{onSnackbarClose:function(){return e({type:"SNACKBAR_CLOSED"})}}}))((function(e){var t=c.a.createRef(),a=function(e){return function(){t.current.closeSnackbar(e)}};return c.a.createElement(jr.a,{maxSnack:3,ref:t,action:function(e){return c.a.createElement(D.a,{onClick:a(e)},"Dismiss")},onClose:function(){e.onSnackbarClose()}},c.a.createElement(Sr,{snackbar:e.snackbar},e.children))})),Dr=function(e){var t=e.date;return c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"body1"},c.a.createElement("em",null,t)))},Cr=function(e){var t=e.children,a=e.title;return c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"subtitle2"},a),c.a.createElement(A.a,{variant:"body2"},t))},Tr=function(){return c.a.createElement(ae.a,{container:!0,spacing:4},c.a.createElement(ae.a,{item:!0,xs:12,container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h6"},"Latest Updates"),c.a.createElement(Dr,{date:"August 22, 2022"}),c.a.createElement(Cr,{title:"Score and Transaction Notifications"},"You will now receive notifications when new or updated assessment scores post to your account and when new bonuses and quick purchases post to your account."))),c.a.createElement(ae.a,{item:!0,xs:12,container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h6"},"Previous Updates")),c.a.createElement(Dr,{date:"August 1, 2022"}),c.a.createElement(Cr,{title:"Notification Center"},"You will now see notifications when you first login if there are updates to your song and online purchase requests. You will see if your requests were approved or denied and will see any notes associted with your request."),c.a.createElement(Cr,{title:"Online Purchases"},"If your teacher has enabled the feature, you can now make purchases online! You can add items to your cart on the Store page, manage your cart, submit your order, and view your previous orders."),c.a.createElement(Cr,{title:"Product Quantities"},"You can now see when there are fewer than five items of any given product with a new badge shown on the Products or Store page."),c.a.createElement(Dr,{date:"Dec 30, 2021"}),c.a.createElement(Cr,{title:"Delete Songs"},"You can now request songs to be removed from your class playlist by going to the 'Songs' tab and clicking the trash can icon next to the song you want removed. This feature is only available if your teacher has activated it."),c.a.createElement(Cr,{title:"What's New Notifications"},"This notification is a new feature! When new Chem Cash udpates are released this notification will appear once on the first time you access the website after the update is released.")))},Nr=function(){return c.a.createElement(ae.a,{container:!0,spacing:4},c.a.createElement(ae.a,{item:!0,xs:12,container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h6"},"Latest Updates")),c.a.createElement(Dr,{date:"August 28, 2022"}),c.a.createElement(Cr,{title:"Create and Manage Pre-set Bonuses"},"You can now create and manage pre-set bonuses for quickly adding bonus points to a student's account. In the 'Update Accounts' menu on the 'Accounts' page, you can now select 'Manage Bonuses' to create, edit, and delete pre-set bonuses that can be added to student's accounts. When adding a bonus to a single student or to many students in a class period, you will now see a dropdown menu of any pre-set bonuses you have created that will auto-populate the amount field as well. Of course, free-form bonuses can still be added."),c.a.createElement(Cr,{title:"Bonus and Product Selectors Available for Bulk Purchases"},"When adding a bulk bonus or bulk quick purchase to multiple students in a class period, a dropdown of bonuses or products is now available. Selecting a bonus or product from this dropdown will auto-populate the amount field with the amount of the bonus or the cost of the item including tax.")),c.a.createElement(ae.a,{item:!0,xs:12,container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h6"},"Previous Updates")),c.a.createElement(Dr,{date:"August 22, 2022"}),c.a.createElement(Cr,{title:"Score and Transaction Notifications for Students"},"Students will now receive notifications when new or updated assessment scores post to their account and when new bonuses and quick purchases post to their account."),c.a.createElement(Dr,{date:"August 1, 2022"}),c.a.createElement(Cr,{title:"Online Purchases"},"Students can now submit online orders for products! New settings in the"," ",c.a.createElement("em",null,"Products and Online Purchases")," section allow you to control whether students can submit online purchases or not, whether students can submit online purchases if they do not have sufficient points, and a tax rate to be applied to all online purchases of products (does not apply to song requests or removal requests; can be set to zero if you do not want to charge a tax). You can also add purchases to a student's account from the ",c.a.createElement("em",null,"Accounts")," tab."),c.a.createElement(Cr,{title:"Processing Purchases"},"If you have enabled online purchases, a new ",c.a.createElement("em",null,"Process Purchases")," ","dialog is available to approve or reject online purchases submitted by students in a manner similar to the song request processing feature. When processing purchases, you will have the option to update the order quantity of each item, add items to the order, remove items from the order, add a note to the order, and approve or reject the order. Upon approval of the order, the on-hand quantity of each product will be automaticaly adjusted."),c.a.createElement(Cr,{title:"Notification Center for Student Accounts"},"Students will now see notifications when they first login if there are any updates to their song and online store purchase requests. Approval or rejection notes will also be included with the notification."),c.a.createElement(Cr,{title:"Inventory Control Buttons and Quantity Display for Products"},"On the ",c.a.createElement("em",null,"Products")," page, two new inventory control buttons are now available to quickly increase or decrease the amount of on-hand product. The quantity of each product is also now visible directly on each product image. Students will only see the on-hand quantity when there are fewer then five items remaining in stock."),c.a.createElement(Cr,{title:"Max Purchase Quantity for Products"},"A new field is now available for products that sets the maximum purchase quantity limit for each product. When combined with the online store, this will limit the quantity of items a student can add to their cart for each product."),c.a.createElement(Cr,{title:"Add Quick Purchases with Automatic Inventory Mangement"},"Quick purchases allow you to add a deduction to a student's account for the purchase of a single product from the store or you can enter a custom description. When products from the store are purchased, the inventory is automatically reduced by one."),c.a.createElement(Cr,{title:"Points Multiplier for Assignments"},"Assignments can now be weighted with a multiplier to increase or decrease their point value. By default, all assignments are imported with a multiplier of 1. To change the multiplier for an assignment in a course go to Courses and click the Manage Assignments button for that course. Then click the Edit button for the assignment whose multiplier you want to change. The multiplier applies to the points and not to the score."),c.a.createElement(Cr,{title:"Google Drive Hosted Images Now Easier to Use"},"You can now directly use the link generated by the ",c.a.createElement("em",null,"Get link")," ","feature on Google Drive to add custom product images to your store. Images hosted on Google Drive must have their share permissions set to"," ",c.a.createElement("em",null,"Anyone with the link")," to properly display for all users."),c.a.createElement(Cr,{title:"Song Requests Badge"},"A badge now appears on the ",c.a.createElement("em",null,"Process Songs")," button to indicate the number of song requests that are pending approval. A similar badge also appears on the ",c.a.createElement("em",null,"Process Purchases")," button."),c.a.createElement(Cr,{title:"Improved Settings"},"The settings page has been improved to make clear which features are enabled and disabled. A new school district setting has been added because ",c.a.createElement("em",null,"somebody")," had to go and leave CCSD :) so this will ensure that there are no username conflicts with student accounts."),c.a.createElement(Dr,{date:"Jan 31, 2022"}),c.a.createElement(Cr,{title:"In Stock and Out of Stock Products"},'Products with a quantity of zero will no longer be visible to students. Teachers will see these products in an "Out of Stock" section on the Products page. Once the product\'s quantity is greater than zero, the product will appear in the "In Stock" section for teachers and will be visible to students.'),c.a.createElement(Dr,{date:"Jan 23, 2022"}),c.a.createElement(Cr,{title:"Student Account Balances Visible When Processing Song Requests"},"Student account balances are now visible in the song request processing dialog so you can quickly identify with a red/green color indicator if a student has enough points to buy a song request or a song removal request."),c.a.createElement(Cr,{title:"Song Totals Visible When Processing Song Requests"},"The total number of song requests to process is now visible in the song request processing dialog along with a running count of requests remaining to process."),c.a.createElement(Dr,{date:"Jan 17, 2022"}),c.a.createElement(Cr,{title:"Economy View"},"You can now view a summary of details about the account balances for students in your courses including the total number of points available in your economy and an interactive table containing the account balances of all students in all of your courses."),c.a.createElement(Cr,{title:"Beta Features Flag"},"A new flag that enables beta features when they are available can now be found in the Account Details section of the Settings page."),c.a.createElement(Dr,{date:"Dec 30, 2021"}),c.a.createElement(Cr,{title:"Delete Songs"},"Students can now request songs to be removed from thier class playlist by going to the 'Songs' tab and clicking the trash can icon, once you have activated the feature in the Settings."),c.a.createElement(Cr,{title:"Delete Songs Settings"},"New settings have been added to control student ability to request songs for deletion as well as settings for the amount of points charged for a song removal and the amount of points refunded to the person whose song was removed."),c.a.createElement(Cr,{title:"Search for Products"},"You can now search for products in a dropdown menu when entering purchases on the accounts page and the cost of the product will automatically populate in the amount field."),c.a.createElement(Cr,{title:"What's New Notifications"},"This notification is a new feature! When new Chem Cash udpates are released this notification will appear once on the first time you access the website after the update is released.")))},_r=Object(r.c)((function(e){return Object(J.a)({},e.common)}),(function(e){return{onExit:function(){return e({type:"WHATS_NEW_DIALOG_UNLOADED",payload:Ee.a.Auth.save({viewedChanges:!0})})}}}))((function(e){var t=e.currentUser,a=e.onExit,n=Object(o.useState)(!1),r=Object(se.a)(n,2),s=r[0],l=r[1],i=Object(Te.a)(),u=Object(Ne.a)(i.breakpoints.down("md")),d=function(){l(!1)};return Object(o.useEffect)((function(){t&&l(!t.viewedChanges)}),[t]),c.a.createElement(_e.a,{fullScreen:u,fullWidth:!0,maxWidth:"md",open:s,onClose:d,onClick:function(e){return e.stopPropagation()},onExit:a,onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"What's New in Chem Cash!"),c.a.createElement(we.a,null,"student"===(null===t||void 0===t?void 0:t.role)?Tr():Nr()),c.a.createElement(Ue.a,null,c.a.createElement(D.a,{onClick:d,variant:"contained"},"Close")))})),Pr=a(79),wr=a(448),Ur=a(80),Rr=(a(571),a(424)),kr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:if(t.subtype===P||"REGISTER"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{inProgress:!0});break;case P:case"REGISTER":return Object(J.a)(Object(J.a)({},e),{},{inProgress:!1,errors:t.error?t.payload.errors:null});case"LOGIN_PAGE_UNLOADED":case"REGISTER_PAGE_UNLOADED":return{};default:return e}return e},xr={bonuses:[],errors:null},Lr=function(e){return e.sort((function(e,t){return e.title>t.title?1:e.title<t.title?-1:0}))},Ir=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_BONUS":return Object(J.a)(Object(J.a)({},e),{},{bonuses:t.error?e.bonuses:Lr([].concat(Object(ge.a)(e.bonuses),[t.payload.bonus])),errors:t.error?t.payload.errors:null});case"DELETE_BONUS":return Object(J.a)(Object(J.a)({},e),{},{bonuses:t.error?e.bonuses:e.bonuses.filter((function(e){return e._id!==t.payload.bonus._id})),errors:t.error?t.payload.errors:null});case"LOAD_BONUSES":return Object(J.a)(Object(J.a)({},e),{},{bonuses:t.error?e.bonuses:t.payload.bonuses,errors:t.error?t.payload.errors:null});case"UNLOAD_BONUSES":return xr;case"UPDATE_BONUS":return Object(J.a)(Object(J.a)({},e),{},{bonuses:t.error?e.bonuses:Lr(e.bonuses.map((function(e){return e._id===t.payload.bonus._id?t.payload.bonus:e}))),errors:t.error?t.payload.errors:null});default:return e}},qr={appName:"Chem Cash",token:null,viewChangeCounter:0},Br=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"APP_LOAD":return Object(J.a)(Object(J.a)({},e),{},{token:t.token||null,appLoaded:!0,currentUser:t.payload?t.payload.user:null,settings:t.payload?t.payload.settings:null});case"LOGOUT":return Object(J.a)(Object(J.a)({},e),{},{redirectTo:"/login",token:null,currentUser:null});case P:case"REGISTER":return Object(J.a)(Object(J.a)({},e),{},{redirectTo:t.error?null:"/",token:t.error?null:t.payload.user.token,currentUser:t.error?null:t.payload.user,settings:t.error?null:t.payload.settings});case"LOGIN_PAGE_UNLOADED":case"REGISTER_PAGE_UNLOADED":case"SETTINGS_PAGE_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{viewChangeCounter:e.viewChangeCounter+1});case"NAV_LOADED":case"NAV_TAB_CHANGE":return Object(J.a)(Object(J.a)({},e),{},{redirectTo:t.redirectTo});case"REDIRECT":return Object(J.a)(Object(J.a)({},e),{},{redirectTo:null});case"SETTINGS_SAVED":return Object(J.a)(Object(J.a)({},e),{},{currentUser:t.error?e.currentUser:t.payload[0].user,settings:t.error||"student"===e.currentUser.role?e.settings:t.payload[1].settings});case"SPOTIFY_REMOVE_AUTH":return Object(J.a)(Object(J.a)({},e),{},{settings:t.error?e.settings:Object(J.a)(Object(J.a)({},e.settings),{},{spotifyTokens:void 0})});case"WHATS_NEW_DIALOG_LOADED":case"WHATS_NEW_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{currentUser:t.payload?t.payload.user:null});default:return e}},Fr={courses:[],errors:null,importCount:null,importFailed:null,inProgress:!1,pageLoaded:!1},Gr=function(e,t){return e.lastName.localeCompare(t.lastName)},Wr=function(e,t){return e.period-t.period},Mr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fr,t=arguments.length>1?arguments[1]:void 0,a=[];switch(t.type){case"ADD_COURSE":return Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:[].concat(Object(ge.a)(e.courses),[t.payload.course]).sort((function(e,t){return Wr(e,t)})),errors:t.error?t.payload.errors:null,inProgress:!1});case"ADD_STUDENT":return a=[],e.courses.forEach((function(e){var n=Object(J.a)({},e);e._id.toString()===t.courseId&&(n.students=[].concat(Object(ge.a)(e.students),[t.payload.user]).sort((function(e,t){return Gr(e,t)}))),a.push(n)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a,errors:t.error?t.payload.errors:null,inProgress:!1});case"ALERT_CLOSED":return Object(J.a)(Object(J.a)({},e),{},{importCount:null,importFailed:null});case _:if("ADD_STUDENT"===t.subtype||"ADD_COURSE"===t.subtype||"MOVE_STUDENT"===t.subtype||"UPDATE_COURSE"===t.subtype||"UPDATE_STUDENT"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0});if("COURSES_PAGE_LOADED"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,pageLoaded:!0});if("IMPORT_STUDENTS"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,importCount:null,importFailed:null,inProgress:!0});break;case"COURSE_DIALOG_UNLOADED":case"STUDENT_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:null});case"COURSES_PAGE_LOADED":case"STUDENT_SEARCH_LOADED":return Object(J.a)(Object(J.a)({},e),{},{courses:t.payload.courses,pageLoaded:!1});case"COURSES_PAGE_UNLOADED":case"STUDENT_SEARCH_UNLOADED":return Fr;case"DELETE_COURSE":return Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:e.courses.filter((function(e){return e.slug!==t.payload.course.slug}))});case"DELETE_STUDENT":return a=[],e.courses.forEach((function(e){var n=Object(J.a)({},e);e._id.toString()===t.payload.course._id.toString()&&(n.students=e.students.filter((function(e){return e.username!==t.payload.user.username}))),a.push(n)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a});case"IMPORT_STUDENTS":return!t.error&&t.payload.course.students.sort((function(e,t){return Gr(e,t)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:e.courses.map((function(e){return e._id===t.payload.course._id?t.payload.course:e})),errors:t.error?t.payload.errors:null,importCount:t.error?null:t.payload.count,importFailed:t.error?null:t.payload.failed,inProgress:!1});case"MOVE_STUDENT":return!t.error&&t.payload[0].course.students.sort((function(e,t){return Gr(e,t)})),!t.error&&t.payload[1].course.students.sort((function(e,t){return Gr(e,t)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:e.courses.map((function(e){return e._id===t.payload[0].course._id?t.payload[0].course:e._id===t.payload[1].course._id?t.payload[1].course:e})),errors:t.error?t.payload.errors:null,inProgress:!1});case"RESET_STUDENT_PASSWORD":return Object(J.a)({},e);case"UPDATE_COURSE":return Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:e.courses.map((function(e){return e._id===t.payload.course._id?t.payload.course:e})).sort((function(e,t){return Wr(e,t)})),errors:t.error?t.payload.errors:null,inProgress:!1});case"UPDATE_STUDENT":a=[];var n=t.payload.user;return e.courses.forEach((function(e){var r=Object(J.a)({},e);e._id.toString()===t.courseId.toString()&&(r.students=e.students.map((function(e){return e._id.toString()===n._id.toString()?n:e})).sort((function(e,t){return Gr(e,t)}))),a.push(r)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a,errors:t.error?t.payload.errors:null,inProgress:!1});default:return e}return e},Hr={errors:null,inProgress:!1,students:[]},Vr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Hr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:if("ECONOMY_DIALOG_LOADED"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0});break;case"ECONOMY_DIALOG_LOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,students:t.error?e.students:t.payload.students});case"ECONOMY_DIALOG_UNLOADED":return Object(J.a)({},Hr);default:return e}return e},zr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NAV_LOADED":case"NAV_TAB_CHANGE":return Object(J.a)(Object(J.a)({},e),{},{navTabValue:t.value});case"NAV_UNLOADED":return{};default:return e}},Yr={errors:null,notifications:[]},Qr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTIFICATION_DIALOG_LOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,notifications:t.error?e.notifications:t.payload.notifications});case"NOTIFICATION_DIALOG_UNLOADED":return Yr;default:return e}},Kr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_BONUS":case"ADD_COURSE":case"ADD_PRODUCT":case"ADD_STUDENT":case"ADD_TEACHER":case"ADD_TRANSACTION":case"ADD_TRANSACTIONS":case"DELETE_BONUS":case"DELETE_COURSE":case"DELETE_PRODUCT":case"DELETE_PURCHASE":case"DELETE_SONG_REQUEST":case"DELETE_STUDENT":case"DELETE_TASK":case"DELETE_TEACHER":case"DELETE_TRANSACTION":case"IMPORT_SCORES":case"IMPORT_STUDENTS":case"MOVE_STUDENT":case"RESET_STUDENT_PASSWORD":case"SETTINGS_SAVED":case"STUDENT_DELETE_PURCHASE":case"SUBMIT_PURCHASE":case"SUBMIT_SONG_REQUEST":case"SUBMIT_SONG_REMOVAL_REQUEST":case"UPDATE_BONUS":case"UPDATE_COURSE":case"UPDATE_PRODUCT":case"UPDATE_STUDENT":case"UPDATE_TASK":case"UPDATE_TEACHER":case"UPDATE_TRANSACTION":case"WHATS_NEW_FLAGS_RESET":return Object(J.a)(Object(J.a)({},e),{},{snackbar:t.error?null:t.snackbar});case"SNACKBAR_CLOSED":return Object(J.a)(Object(J.a)({},e),{},{snackbar:null});default:return e}},Jr={products:[],errors:null,inProgress:!1,pageLoaded:!1},$r=function(e,t){return e.cost-t.cost},Zr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_PRODUCT":return Object(J.a)(Object(J.a)({},e),{},{products:t.error?e.products:[].concat(Object(ge.a)(e.products),[t.payload.product]).sort((function(e,t){return $r(e,t)})),errors:t.error?t.payload.errors:null,inProgress:!1});case _:if("ADD_PRODUCT"===t.subtype||"UPDATE_PRODUCT"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0});if("PRODUCT_SELECTOR_LOADED"===t.subtype||"PRODUCTS_PAGE_LOADED"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0,pageLoaded:!1});break;case"DELETE_PRODUCT":return Object(J.a)(Object(J.a)({},e),{},{products:t.error?e.products:e.products.filter((function(e){return e.slug!==t.payload.product.slug}))});case"PRODUCT_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:null});case"PRODUCT_SELECTOR_LOADED":case"PRODUCTS_PAGE_LOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,pageLoaded:!0,products:t.error?e.products:t.payload.products});case"PRODUCT_SELECTOR_UNLOADED":case"PRODUCTS_PAGE_UNLOADED":return Jr;case"UPDATE_PRODUCT":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,products:t.error?e.products:e.products.map((function(e){return e._id===t.payload.product._id?t.payload.product:e})).sort((function(e,t){return $r(e,t)}))});default:return e}return e},Xr=a(452),eo=a(451),to={cart:{products:[],quantities:{}},courses:[],errors:null,inProgress:!1,purchases:[]},ao=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:to,t=arguments.length>1?arguments[1]:void 0,a=[];switch(t.type){case"ADD_PURCHASE":case"SUBMIT_PURCHASE":return Object(J.a)(Object(J.a)({},e),{},{cart:t.error?e.cart:to.cart,errors:t.error?t.payload.errors:null,inProgress:!1});case"ADD_PURCHASE_DIALOG_UNLOADED":return to;case"ADD_TO_CART":var n=e.cart.products.findIndex((function(e){return e._id===t.product._id})),r=n>-1,o=r?e.cart.quantities[t.product._id]+1:1,c=t.product.maxPurchaseQuantity,s=t.product.quantity,l=0!==c?Math.min(c,s):s;return Object(J.a)(Object(J.a)({},e),{},{cart:{products:r?e.cart.products:[].concat(Object(ge.a)(e.cart.products),[t.product]),quantities:Object(J.a)(Object(J.a)({},e.cart.quantities),{},Object(he.a)({},t.product._id,o<=l?o:l))}});case _:if("STUDENT_PURCHASES_LOADED"===t.subtype||"TEACHER_PURCHASES_LOADED"===t.subtype||"SUBMIT_PURCHASE"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0});break;case"DELETE_CART_PRODUCT":var i=e.cart.quantities,u=t.productId,d=(i[u],Object(Xr.a)(i,[u].map(eo.a)));return Object(J.a)(Object(J.a)({},e),{},{cart:{products:e.cart.products.filter((function(e){return e._id!==t.productId})),quantities:d}});case"DELETE_PURCHASE":return e.courses.forEach((function(e){var n=Object(J.a)({},e);n.purchases=n.purchases.filter((function(e){return e._id.toString()!==t.payload.purchase._id.toString()})),a.push(n)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a});case"PURCHASES_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:null});case"STUDENT_DELETE_PURCHASE":return Object(J.a)(Object(J.a)({},e),{},{purchases:t.error?e.purchases:e.purchases.filter((function(e){return e._id!==t.payload.purchase._id}))});case"STUDENT_PURCHASES_LOADED":return Object(J.a)(Object(J.a)({},e),{},{purchases:t.error?e.purchases:t.payload.purchases,errors:t.error?t.payload.errors:null,inProgress:!1});case"STUDENT_PURCHASES_UNLOADED":return Object(J.a)(Object(J.a)({},to),{},{cart:e.cart});case"TEACHER_PURCHASES_LOADED":return Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:t.payload.courses,errors:t.error?t.payload.errors:null,inProgress:!1});case"TEACHER_PURCHASES_UNLOADED":return Object(J.a)({},to);case"UPDATE_CART_PRODUCT_QUANTITY":return Object(J.a)(Object(J.a)({},e),{},{cart:Object(J.a)(Object(J.a)({},e.cart),{},{quantities:Object(J.a)(Object(J.a)({},e.cart.quantities),{},Object(he.a)({},t.productId,t.qty))})});case"UPDATE_PURCHASE":return!t.error&&e.courses.forEach((function(e){var n=Object(J.a)({},e);n.purchases=n.purchases.map((function(e){return e._id.toString()===t.payload.purchase._id.toString()?t.payload.purchase:e})),a.push(n)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a,errors:t.error?t.payload.errors:null,inProgress:!1});default:return e}return e},no=a(449),ro={balance:null,conversions:null,errors:null,importSummary:null,inProgress:!1,total:null,transactions:null},oo=function(e,t){var a=function(e,t){return e+t.amount},n=e.bonuses.reduce(a,0),r=e.purchases.reduce(a,0),o=e.scores.reduce((function(e,a){return e+ot(a,t)}),0);return{balance:n+r+o,bonuses:n,purchases:r,scores:o}},co=function(e,t,a){if(a){var n=a._id.toString(),r=e.filter((function(e){return e.student._id.toString()===n}));return r&&(t.scores=Object(no.unionBy)(r,Object(ge.a)(t.scores),"_id")),t}return null},so=function(e,t){for(var a=0,n=Object.keys(t);a<n.length;a++){var r=n[a];r.startsWith(e.type)&&(t[r]=[e].concat(Object(ge.a)(t[r])))}return t},lo=function(e,t,a){if(a){var n=a._id.toString(),r=e.find((function(e){return e.student._id.toString()===n}));if(r)return so(r,t)}return null},io=function(e,t){for(var a=0,n=Object.keys(t);a<n.length;a++){var r=n[a];r.startsWith(e.type)&&(t[r]=t[r].filter((function(t){return t._id!==e._id})))}return t},uo=function(e,t){for(var a=0,n=Object.keys(t);a<n.length;a++){var r=n[a];r.startsWith(e.type)&&(t[r]=t[r].map((function(t){return t._id===e._id?e:t})))}return t},mo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ro,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ACCOUNT_BALANCE_LOADED":return Object(J.a)(Object(J.a)({},e),{},{balance:t.error?null:oo(t.payload.transactions,t.payload.scoreConverter)});case"ACCOUNT_BALANCE_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{balance:null});case"STUDENT_CART_LOADED":return Object(J.a)(Object(J.a)({},e),{},{total:t.error?null:oo(t.payload.transactions,t.payload.scoreConverter)});case"STUDENT_CART_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{total:null});case"ACCOUNT_VIEW_LOADED":return Object(J.a)(Object(J.a)({},e),{},{conversions:t.error?null:t.payload.scoreConverter,total:t.error?null:oo(t.payload.transactions,t.payload.scoreConverter),transactions:t.error?null:t.payload.transactions});case"ACCOUNT_VIEW_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{conversions:null,total:null,transactions:null});case"ACCOUNTS_PAGE_UNLOADED":case"ALERT_CLOSED":return Object(J.a)(Object(J.a)({},e),{},{importSummary:null});case"ADD_TRANSACTION":var a=t.error?{}:so(t.payload.transaction,Object(J.a)({},e.transactions));return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:a,total:t.error?e.total:oo(a,e.conversions)});case"ADD_PURCHASE":var n=t.error?{}:so(t.payload.purchase.purchaseTransaction,Object(J.a)({},e.transactions));return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:n,total:t.error?e.total:oo(n,e.conversions)});case"ADD_TRANSACTIONS":var r=t.error?null:lo(t.payload.transactions,Object(J.a)({},e.transactions),t.curStudent);return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:r,total:t.error||!e.transactions?e.total:oo(r,e.conversions)});case _:if("ADD_TRANSACTION"===t.subtype||"ADD_TRANSACTIONS"===t.subtype||"DELETE_TRANSACTION"===t.subtype||"UPDATE_TRANSACTION"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0});if("IMPORT_SCORES"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,importSummary:null,inProgress:!0});break;case"DELETE_TRANSACTION":var o=t.error?{}:io(t.payload.transaction,Object(J.a)({},e.transactions));return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:o,total:t.error?e.total:oo(o,e.conversions)});case"IMPORT_SCORES":var c=t.error?null:co(t.payload.scores,Object(J.a)({},e.transactions),t.curStudent);return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,importSummary:t.error?null:t.payload.results,inProgress:!1,transactions:t.error?e.transactions:c,total:t.error||!e.transactions?e.total:oo(c,e.conversions)});case"IMPORT_SCORES_DIALOG_UNLOADED":case"TRANSACTION_DIALOG_UNLOADED":case"TRANSACTIONS_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:null});case"UPDATE_TRANSACTION":var s=t.error?{}:uo(t.payload.transaction,Object(J.a)({},e.transactions));return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:s,total:t.error?e.total:oo(s,e.conversions)});default:return e}return e},po={errors:null,inProgress:!1,spotifyAuthUrl:null},Eo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:po,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:if("SETTINGS_SAVED"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{inProgress:!0});break;case"SPOTIFY_LINKER_LOADED":return Object(J.a)(Object(J.a)({},e),{},{spotifyAuthUrl:t.payload.spotifyAuthUrl});case"SETTINGS_PAGE_UNLOADED":case"SPOTIFY_LINKER_UNLOADED":return po;case"SETTINGS_SAVED":return Object(J.a)(Object(J.a)({},e),{},{inProgress:!1,errors:t.error?t.payload.errors:null});default:return e}return e},fo={errors:null,inProgress:!1,tasks:[]},bo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fo,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:if("TASKS_DIALOG_LOADED"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{inProgress:!0});break;case"DELETE_TASK":return Object(J.a)(Object(J.a)({},e),{},{tasks:t.error?e.tasks:e.tasks.filter((function(e){return e.slug!==t.payload.task.slug}))});case"TASKS_DIALOG_LOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,tasks:t.error?[]:t.payload.tasks});case"TASKS_DIALOG_UNLOADED":return fo;case"UPDATE_TASK":return Object(J.a)(Object(J.a)({},e),{},{tasks:t.error?e.tasks:e.tasks.map((function(e){return e.slug===t.payload.task.slug?t.payload.task:e}))});default:return e}return e},go={errors:null,inProgress:!1,pageLoaded:!1,teachers:[]},ho=function(e,t){return e.lastName.localeCompare(t.lastName)},Oo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:go,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TEACHER":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,teachers:t.error?e.teachers:[].concat(Object(ge.a)(e.teachers),[Object(J.a)(Object(J.a)({},t.payload.user),{},{settings:t.payload.settings})]).sort((function(e,t){return ho(e,t)}))});case _:if("ADD_TEACHER"===t.subtype||"UPDATE_TEACHER"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{inProgress:!0,errors:null});if("MANAGE_TEACHERS_PAGE_LOADED"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0,pageLoaded:!1});break;case"DELETE_TEACHER":return Object(J.a)(Object(J.a)({},e),{},{teachers:t.error?e.teachers:e.teachers.filter((function(e){return e.username!==t.payload.user.username}))});case"MANAGE_TEACHERS_PAGE_LOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,pageLoaded:!0,teachers:t.payload.users});case"MANAGE_TEACHERS_PAGE_UNLOADED":return go;case"TEACHER_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:null});case"UPDATE_TEACHER":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,teachers:t.error?e.teachers:e.teachers.map((function(e){return e.username===t.payload.user.username?Object(J.a)(Object(J.a)({},e),t.payload.user):e})).sort((function(e,t){return ho(e,t)}))});default:return e}return e},vo={course:null,courses:[],courseSongs:[],errors:null,inProgress:!1,userSongs:[]},yo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vo,t=arguments.length>1?arguments[1]:void 0,a=[];switch(t.type){case _:if("UPDATE_SONG_REQUEST"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{inProgress:!0,errors:null});break;case"DELETE_SONG_REQUEST":return e.courses.forEach((function(e){var n=Object(J.a)({},e);n.songs=n.songs.filter((function(e){return e._id.toString()!==t.payload.song._id.toString()})),a.push(n)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a});case"SONG_REQUESTS_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:null});case"SONGS_PAGE_UNLOADED":return vo;case"STUDENT_SONGS_PAGE_LOADED":return Object(J.a)(Object(J.a)({},e),{},{userSongs:t.payload.songsByUser,courseSongs:t.payload.songsByCourse,course:t.payload.course});case"SUBMIT_SONG_REQUEST":return Object(J.a)(Object(J.a)({},e),{},{userSongs:[t.payload.song].concat(Object(ge.a)(e.userSongs)),courseSongs:[t.payload.song].concat(Object(ge.a)(e.courseSongs))});case"SUBMIT_SONG_REMOVAL_REQUEST":return Object(J.a)(Object(J.a)({},e),{},{userSongs:e.userSongs.map((function(e){return t.payload.song._id===e._id?t.payload.song:e})),courseSongs:e.courseSongs.map((function(e){return t.payload.song._id===e._id?t.payload.song:e}))});case"TEACHER_SONGS_PAGE_LOADED":return Object(J.a)(Object(J.a)({},e),{},{courses:t.payload.courses});case"UPDATE_SONG_REQUEST":return!t.error&&e.courses.forEach((function(e){var n=Object(J.a)({},e);n.songs=n.songs.map((function(e){return e._id.toString()===t.payload.song._id.toString()?t.payload.song:e})),a.push(n)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a,errors:t.error?t.payload.errors:null,inProgress:!1});default:return e}return e},jo=function(e){return function(t){return function(a){if((o=a.payload)&&"function"===typeof o.then){e.dispatch({type:_,subtype:a.type});var n=e.getState().viewChangeCounter,r=a.skipTracking;a.payload.then((function(t){var o=e.getState();(r||o.viewChangeCounter===n)&&(a.payload=t,e.dispatch({type:"ASYNC_END",promise:a.payload}),e.dispatch(a))}),(function(t){var o=e.getState();(r||o.viewChangeCounter===n)&&(a.error=!0,a.payload=t.response.body,a.skipTracking||e.dispatch({type:"ASYNC_END",promise:a.payload}),e.dispatch(a))}))}else{var o;t(a)}}}},So=function(e){return function(e){return function(t){"REGISTER"===t.type||t.type===P?t.error||(window.localStorage.setItem("jwt",t.payload.user.token),Ee.a.setToken(t.payload.user.token)):"LOGOUT"===t.type&&(window.localStorage.setItem("jwt",""),Ee.a.setToken(null)),e(t)}}};var Ao,Do=Object(Ur.a)(),Co=Object(Rr.a)(Do),To=Object(Pr.createStore)((Ao=Do,Object(Pr.combineReducers)({auth:kr,bonuses:Ir,common:Br,courses:Mr,economy:Vr,nav:zr,notifications:Qr,notifier:Kr,products:Zr,purchases:ao,scores:mo,settings:Eo,tasks:bo,teachers:Oo,songs:yo,router:Object(n.b)(Ao)})),Object(wr.composeWithDevTools)(Object(Pr.applyMiddleware)(Co,jo,So))),No=Object(r.c)((function(e){return{appLoaded:e.common.appLoaded,redirectTo:e.common.redirectTo}}),(function(e){return{onLoad:function(t,a){return e({type:"APP_LOAD",payload:t,token:a,skipTracking:!0})},onRedirect:function(){return e({type:"REDIRECT"})}}}))((function(e){var t=e.appLoaded,a=e.redirectTo;return Object(o.useEffect)((function(){a&&(To.dispatch(Object(u.d)(a)),e.onRedirect())}),[a]),Object(o.useEffect)((function(){var t=window.localStorage.getItem("jwt");t&&Ee.a.setToken(t),e.onLoad(t?Ee.a.Auth.current():null,t)}),[]),t?c.a.createElement(d.a,{theme:O},c.a.createElement(m.a,null),c.a.createElement(Ar,null,c.a.createElement(o.Suspense,{fallback:c.a.createElement("p",null,"Loading...")},c.a.createElement(i.d,null,c.a.createElement(i.b,{exact:!0,path:"/login",component:yr}),c.a.createElement(i.b,{exact:!0,path:"/about",component:yr}),c.a.createElement(i.b,{path:"/",component:ar})))),c.a.createElement(_r,null)):c.a.createElement(d.a,{theme:O},c.a.createElement(m.a,null),c.a.createElement(lr,null))}));l.a.render(c.a.createElement(r.a,{store:To},c.a.createElement(n.a,{history:Do},c.a.createElement(i.d,null,c.a.createElement(i.b,{path:"/",component:No})))),document.getElementById("root"))}},[[460,1,2]]]);
//# sourceMappingURL=main.da1289f2.chunk.js.map