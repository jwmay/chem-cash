(this["webpackJsonpchem-cash"]=this["webpackJsonpchem-cash"]||[]).push([[0],{10:function(e,t,a){"use strict";(function(e){var n=a(439),r=a.n(n),o=a(440),c=a.n(o),l=r()(c.a,e.Promise),s="https://chem-cash.herokuapp.com/api",i=encodeURIComponent,u=function(e){return e.body},m=null,d=function(e){m&&e.set("authorization","Token ".concat(m))},p=function(e,t){return l.del("".concat(s).concat(e),t).use(d).then(u)},E=function(e){return l.get("".concat(s).concat(e)).use(d).then(u)},f=function(e,t){return l.post("".concat(s).concat(e),t).use(d).then(u)},b=function(e,t){return l.put("".concat(s).concat(e),t).use(d).then(u)},g={current:function(){return E("/user")},login:function(e,t){return f("/users/login",{user:{username:e,password:t}})},register:function(e){return f("/users",{user:e})},save:function(e){return b("/user",{user:e})}},h={add:function(e){return f("/courses",{course:e})},delete:function(e){return p("/courses/".concat(e))},enroll:function(e){return f("/courses/".concat(e.slug,"/enroll"),{course:e})},getAll:function(){return E("/courses")},unenroll:function(e){return p("/courses/".concat(e.slug,"/enroll"),{course:e})},update:function(e){return b("/courses/".concat(e.slug),{course:e})}},O={clearAll:function(){return p("/notifications")},getAll:function(){return E("/notifications")}},v={add:function(e){return f("/products",{product:e})},delete:function(e){return p("/products/".concat(e))},getAll:function(){return E("/products")},update:function(e){return b("/products/".concat(e.slug),{product:e})}},y={add:function(e){return f("/purchases",{purchase:e})},delete:function(e){return p("/purchases/".concat(e))},forStudent:function(){return E("/purchases/student")},forTeacher:function(){return E("/purchases/teacher")},update:function(e){return b("/purchases/".concat(e.id),{purchase:e})}},j={getAll:function(){return E("/scores/all")},getStudentScores:function(e){return E("/scores?username=".concat(e))},import:function(e){return f("/scores/import",{data:e})}},S={update:function(e){return b("/user/settings",{settings:e})}},A={delete:function(e){return p("/songs/".concat(e))},forStudent:function(){return E("/songs/student")},forTeacher:function(){return E("/songs/teacher")},request:function(e){return f("/songs",{song:e})},update:function(e){return b("/songs/".concat(e.id),{song:e})}},D={getAuthUrl:function(){return E("/spotify/auth")},removeAuth:function(){return p("/spotify/auth")}},C={add:function(e,t){return f("/users?courseId=".concat(i(t)),{user:e})},delete:function(e){return p("/users/student/".concat(e.username))},import:function(e,t){return f("/users/import?courseId=".concat(i(t)),{users:e})},update:function(e){return b("/users/".concat(e.username),{user:e})}},T={getAll:function(e){return E("/tasks?courseId=".concat(e))},delete:function(e){return p("/tasks/".concat(e.slug))},update:function(e){return b("/tasks/".concat(e.slug),{task:e})}},N={getAll:function(){return E("/users?role=teacher")},delete:function(e){return p("/users/teacher/".concat(e.username))},resetFlags:function(e){return b("/users/reset?role=".concat(e))},update:function(e){return b("/users/".concat(e.username),{user:e})}},_={add:function(e){return f("/transactions",{transaction:e})},addMany:function(e){return f("/transactions/bulk",{transactions:e})},delete:function(e){return p("/transactions/".concat(e._id))},update:function(e){return b("/transactions/".concat(e._id),{transaction:e})}};t.a={Auth:g,Courses:h,Notifications:O,Products:v,Purchases:y,Scores:j,Settings:S,Songs:A,Spotify:D,Students:C,Tasks:T,Teachers:N,Transactions:_,setToken:function(e){m=e}}}).call(this,a(81))},278:function(e,t,a){e.exports=a.p+"static/media/chemistry-background.11d1d297.jpg"},434:function(e,t,a){e.exports=a.p+"static/media/chem-cash-logo.30174016.png"},442:function(e,t,a){e.exports=a.p+"static/media/songs-background.cfcd4ce6.jpg"},447:function(e,t,a){e.exports=a.p+"static/media/doc-may-profile.f927335d.jpg"},460:function(e,t,a){e.exports=a(573)},555:function(e,t){},557:function(e,t){},573:function(e,t,a){"use strict";a.r(t);var n=a(158),r=a(9),o=a(0),c=a.n(o),l=a(25),s=a.n(l),i=a(38),u=a(60),m=a(619),d=a(624),p=a(157),E=a(432),f=a.n(E),b=a(433),g=a.n(b),h=Object(p.a)({breakpoints:{values:{md:768,lg:1024}},palette:{primary:f.a,secondary:g.a},overrides:{MuiDialogActions:{root:{padding:"16px 24px"}}}}),O=h,v=a(600),y=a(320),j=a(599),S=a(387),A=a(93),D=a(321),C=a(434),T=a.n(C),N=function(e){return c.a.createElement("img",Object.assign({alt:"Chem Cash Logo",src:T.a},e))},_="ASYNC_START",P="LOGIN",R=Object(y.a)((function(e){return{title:{color:"white",flexGrow:1},logo:{height:65,marginTop:e.spacing(2),marginRight:e.spacing(3),marginBottom:e.spacing(2)}}})),w=Object(r.c)((function(e){return{navTabValue:e.nav.navTabValue}}),(function(e){return{onClickLogout:function(){return e({type:"LOGOUT"})}}}))((function(e){var t=R(),a=e.navTabValue;return e.currentUser?c.a.createElement(j.a,{position:"static"},c.a.createElement(v.a,null,c.a.createElement(S.a,null,c.a.createElement(N,{className:t.logo}),c.a.createElement(A.a,{variant:"h5",align:"center",className:t.title},a&&a.charAt(0).toUpperCase()+a.slice(1)),c.a.createElement(D.a,{color:"inherit",onClick:e.onClickLogout},"Logout")))):null})),U=a(601),k=a(602),x=a(603),L=a(604),I=a(605),q=a(606),F=a(607),G=a(608),B=Object(y.a)({nav:{position:"fixed",bottom:0,width:"100%",zIndex:"1000"}}),W=Object(r.c)((function(e){return{currentUser:e.common.currentUser,navTabValue:e.nav.navTabValue,path:e.router.location.pathname,settings:e.common.settings}}),(function(e){return{onLoad:function(t,a){return e({type:"NAV_LOADED",value:t,redirectTo:a})},onTabChange:function(t,a){return e({type:"NAV_TAB_CHANGE",value:t,redirectTo:a})},onUnload:function(){return e({type:"NAV_UNLOADED"})}}}))((function(e){var t=B(),a=e.currentUser.role,n={beta:e.settings.enableBetaFeatures,products:e.settings.productsEnabled,songs:e.settings.songRequestEnabled,store:e.settings.storeEnabled},r=function(t){e.onTabChange(t,"/".concat(a,"/").concat(t))};return Object(o.useEffect)((function(){var t=e.path.split("/")[2],r=null!==t&&void 0!==t?t:"student"===a?"account":"admin"===a?"teachers":"accounts",o="/".concat(a,"/").concat(r);return n.store&&"products"===r?e.onLoad("store",o):e.onLoad(r,o),function(){e.onUnload()}}),[]),"student"===a?c.a.createElement(U.a,{className:t.nav,onChange:function(e,t){return r(t)},showLabels:!0,value:e.navTabValue},c.a.createElement(k.a,{label:"Account",icon:c.a.createElement(x.a,null),value:"account"}),n.songs&&c.a.createElement(k.a,{label:"Songs",icon:c.a.createElement(L.a,null),value:"songs"}),(n.products||n.store)&&c.a.createElement(k.a,{label:n.store?"Store":"Products",icon:c.a.createElement(I.a,null),value:"store"}),c.a.createElement(k.a,{label:"Settings",icon:c.a.createElement(q.a,null),value:"settings"})):"admin"===a?c.a.createElement(U.a,{className:t.nav,onChange:function(e,t){return r(t)},showLabels:!0,value:e.navTabValue},c.a.createElement(k.a,{label:"Teachers",icon:c.a.createElement(F.a,null),value:"teachers"}),c.a.createElement(k.a,{label:"Settings",icon:c.a.createElement(q.a,null),value:"settings"})):c.a.createElement(U.a,{className:t.nav,onChange:function(e,t){return r(t)},showLabels:!0,value:e.navTabValue},c.a.createElement(k.a,{label:"Accounts",icon:c.a.createElement(x.a,null),value:"accounts"}),n.songs&&c.a.createElement(k.a,{label:"Songs",icon:c.a.createElement(L.a,null),value:"songs"}),(n.products||n.store)&&c.a.createElement(k.a,{label:n.store?"Store":"Products",icon:c.a.createElement(I.a,null),value:n.store?"store":"products"}),c.a.createElement(k.a,{label:"Courses",icon:c.a.createElement(G.a,null),value:"courses"}),c.a.createElement(k.a,{label:"Settings",icon:c.a.createElement(q.a,null),value:"settings"}))})),H=Object(y.a)((function(e){return{wrapper:{marginTop:e.spacing(4),marginBottom:e.spacing(11)}}})),M=function(e){var t=H();return c.a.createElement("div",{className:t.wrapper},e.children)},z=function(e){return c.a.createElement(M,null,c.a.createElement(v.a,null,c.a.createElement(A.a,{variant:"h2"},"Error 404: Page Not Found")))},V=Object(r.c)((function(e){return{currentUser:e.common.currentUser}}),(function(){return{}}))((function(e){return e.currentUser?c.a.createElement(i.b,{exact:!0,path:e.path,component:e.component}):c.a.createElement(i.a,{to:"/"})})),Y=a(28),Q=a.n(Y),K=a(40),J=a(2),$=a(13),Z=a(23),X=a(18),ee=a(611),te=a(150),ae=a(610),ne=a(260),re=a(261),oe=a(389),ce=a(612),le=a(7),se=function(e){var t=e.controlledBy,a=e.disabled,n=e.label,r=e.name,l=Object($.f)(),s=l.values,i=l.setFieldValue,u=Object($.e)({name:r,type:"checkbox"}),m=Object(le.a)(u,1)[0];return Object(o.useEffect)((function(){!0===s[t]&&i(r,!0)}),[s[t],i,r]),c.a.createElement($.a,Object.assign({component:Z.b,disabled:a,label:n},m))},ie=a(665),ue=Object(y.a)((function(e){return{alert:{width:"100%","&:not(:last-of-type)":{marginBottom:e.spacing(1)}},alertList:{marginBottom:e.spacing(2)}}})),me=function(e){var t=e.errors,a=ue();return t?c.a.createElement("div",{className:a.alertList},Object.keys(t).map((function(e){var n=e.replace(/([a-z0-9])([A-Z])/g,"$1 $2").toLowerCase();return c.a.createElement(ie.a,{className:a.alert,severity:"error",key:e},n," ",t[e])}))):null},de=Object(y.a)((function(e){return{headerLeft:{alignItems:"center",display:"flex"},headerRight:{alignItems:"center",display:"flex",justifyContent:"flex-end"},pageHeader:{marginBottom:e.spacing(4),"& button:not(:last-of-type)":{marginRight:e.spacing(2)}}}})),pe=function(e){var t=e.children,a=e.title,n=de();return c.a.createElement(ae.a,{container:!0,spacing:2,className:n.pageHeader},c.a.createElement(ae.a,{item:!0,xs:12,md:6,className:n.headerLeft},c.a.createElement(A.a,{variant:"h4"},a)),c.a.createElement(ae.a,{item:!0,xs:12,md:6,className:n.headerRight},t))},Ee=a(10),fe=Object(y.a)((function(e){return{icon:{marginRight:e.spacing(1)},paper:{padding:e.spacing(2),marginBottom:e.spacing(4)}}})),be=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.settings),{},{currentUser:e.common.currentUser,settings:e.common.settings})}),(function(e){return{onSubmitForm:function(t){return e({type:"SETTINGS_SAVED",payload:Promise.all([Ee.a.Auth.save(t),Ee.a.Settings.update(t)]),snackbar:{message:"Settings saved",variant:"success"}})},onUnload:function(){return e({type:"SETTINGS_PAGE_UNLOADED"})},onWhatsNewClick:function(){return e({type:"WHATS_NEW_DIALOG_LOADED",payload:Ee.a.Auth.save({viewedChanges:!1})})}}}))((function(e){var t,a,n,r,l,s,i=e.currentUser,u=e.errors,m=e.inProgress,d=e.onSubmitForm,p=e.onUnload,E=e.onWhatsNewClick,f=e.settings,b=fe();Object(o.useEffect)((function(){return function(){p()}}),[]);var g=function(e){var t=e.status,a=e.value;return"".concat(a," ").concat(t?"enabled":"disabled")};return c.a.createElement($.c,{enableReinitialize:!0,initialValues:{allowPurchasesWithInsufficientFunds:(null===f||void 0===f?void 0:f.allowPurchasesWithInsufficientFunds)||!1,defaultStudentPassword:(null===f||void 0===f?void 0:f.defaultStudentPassword)||"",enableBetaFeatures:(null===f||void 0===f?void 0:f.enableBetaFeatures)||!1,firstName:i.firstName,lastName:i.lastName,password:"",productsEnabled:(null===f||void 0===f?void 0:f.productsEnabled)||!1,schoolDistrict:f.schoolDistrict||"ccsd",score100:(null===f||void 0===f||null===(t=f.scoreConverter)||void 0===t?void 0:t[100])||1200,score90:(null===f||void 0===f||null===(a=f.scoreConverter)||void 0===a?void 0:a[90])||1e3,score80:(null===f||void 0===f||null===(n=f.scoreConverter)||void 0===n?void 0:n[80])||800,score70:(null===f||void 0===f||null===(r=f.scoreConverter)||void 0===r?void 0:r[70])||600,score60:(null===f||void 0===f||null===(l=f.scoreConverter)||void 0===l?void 0:l[60])||0,score50:(null===f||void 0===f||null===(s=f.scoreConverter)||void 0===s?void 0:s[50])||0,songRemovalPurchaseAmount:(null===f||void 0===f?void 0:f.songRemovalPurchaseAmount)||0,songRemovalRequestEnabled:(null===f||void 0===f?void 0:f.songRemovalRequestEnabled)||!1,songRemovalRefundAmount:(null===f||void 0===f?void 0:f.songRemovalRefundAmount)||0,songRequestEnabled:(null===f||void 0===f?void 0:f.songRequestEnabled)||!1,songRequestPurchaseAmount:(null===f||void 0===f?void 0:f.songRequestPurchaseAmount)||0,storeEnabled:(null===f||void 0===f?void 0:f.storeEnabled)||!1,taxRate:(null===f||void 0===f?void 0:f.taxRate)||0},validationSchema:X.c({allowPurchasesWithInsufficientFunds:X.a(),defaultStudentPassword:X.d(),enableBetaFeatures:X.a(),firstName:X.d(),lastName:X.d(),password:X.d(),productsEnabled:X.a(),schoolDistrict:X.d(),score100:X.b().typeError("Numbers only"),score90:X.b().typeError("Numbers only"),score80:X.b().typeError("Numbers only"),score70:X.b().typeError("Numbers only"),score60:X.b().typeError("Numbers only"),score50:X.b().typeError("Numbers only"),songRemovalPurchaseAmount:X.b().typeError("Numbers only"),songRemovalRequestEnabled:X.a(),songRemovalRefundAmount:X.b().typeError("Numbers only"),songRequestEnabled:X.a(),songRequestPurchaseAmount:X.b().typeError("Numbers only"),storeEnabled:X.a(),taxRate:X.b().typeError("Numbers only")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t,a){var n;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=Object(J.a)({},t)).password||"student"===i.role||delete n.password,"student"!==i.role&&(n.scoreConverter={100:t.score100,90:t.score90,80:t.score80,70:t.score70,60:t.score60,50:t.score50,40:0,30:0,20:0,10:0,0:0}),d(n),a.resetForm({values:Object(J.a)(Object(J.a)({},n),{},{password:""})});case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},(function(e){return c.a.createElement($.b,null,c.a.createElement(pe,{title:"Manage Account"},c.a.createElement(D.a,{onClick:E,size:"small"},"See What's New"),c.a.createElement(ee.a,{color:"primary",disabled:m,type:"sumbit",variant:"extended"},c.a.createElement(ce.a,{className:b.icon}),m?"Saving...":"Save settings")),c.a.createElement(me,{errors:u}),"teacher"===i.role&&c.a.createElement(te.a,{className:b.paper},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Song Requests")),c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement("label",null,c.a.createElement($.a,{component:Z.b,name:"songRequestEnabled",type:"checkbox"}),c.a.createElement(g,{status:e.values.songRequestEnabled,value:"Song requests"}))),e.values.songRequestEnabled&&c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement($.a,{component:Z.c,label:"Song request purchase amount",name:"songRequestPurchaseAmount",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h6",gutterBottom:!0},"Song Removal Requests")),c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement("label",null,c.a.createElement($.a,{component:Z.b,name:"songRemovalRequestEnabled",type:"checkbox"}),c.a.createElement(g,{status:e.values.songRemovalRequestEnabled,value:"Song removal requests"}))),e.values.songRemovalRequestEnabled&&c.a.createElement(c.a.Fragment,null,c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement($.a,{component:Z.c,label:"Song removal purchase amount",name:"songRemovalPurchaseAmount",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement($.a,{component:Z.c,label:"Song removal refund amount",name:"songRemovalRefundAmount",type:"number",variant:"outlined",fullWidth:!0}))))),"teacher"===i.role&&c.a.createElement(te.a,{className:b.paper},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Products and Online Purchases")),c.a.createElement(ae.a,{item:!0,xs:12,md:e.values.storeEnabled?6:12},c.a.createElement("label",null,c.a.createElement($.a,{component:Z.b,name:"storeEnabled",type:"checkbox"}),c.a.createElement(g,{status:e.values.storeEnabled,value:"Online purchases"}))),e.values.storeEnabled&&c.a.createElement(ae.a,{item:!0,xs:12,md:3},c.a.createElement($.a,{component:Z.c,label:"Tax rate",name:"taxRate",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("label",null,c.a.createElement(se,{controlledBy:"storeEnabled",disabled:e.values.storeEnabled,name:"productsEnabled"}),c.a.createElement(g,{status:e.values.productsEnabled,value:"Products page"}),e.values.storeEnabled&&c.a.createElement("em",null," (required for online purchases)"))),e.values.storeEnabled&&c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("label",null,c.a.createElement($.a,{component:Z.b,name:"allowPurchasesWithInsufficientFunds",type:"checkbox"}),c.a.createElement(g,{status:e.values.allowPurchasesWithInsufficientFunds,value:"Purchases with insufficient funds"}))))),"teacher"===i.role&&c.a.createElement(te.a,{className:b.paper},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Student Accounts")),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{component:Z.c,label:"Default student password",name:"defaultStudentPassword",type:"text",variant:"outlined",fullWidth:!0})))),"teacher"===i.role&&c.a.createElement(te.a,{className:b.paper},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Score Conversions")),c.a.createElement(ae.a,{item:!0,xs:12,md:2},c.a.createElement($.a,{component:Z.c,label:"100% and up",name:"score100",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:2},c.a.createElement($.a,{component:Z.c,label:"90% and up",name:"score90",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:2},c.a.createElement($.a,{component:Z.c,label:"80% and up",name:"score80",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:2},c.a.createElement($.a,{component:Z.c,label:"70% and up",name:"score70",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:2},c.a.createElement($.a,{component:Z.c,label:"60% and up",name:"score60",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:2},c.a.createElement($.a,{component:Z.c,label:"50% and up",name:"score50",type:"number",variant:"outlined",fullWidth:!0})))),"student"!==i.role&&c.a.createElement(te.a,{className:b.paper},c.a.createElement(ae.a,{container:!0,spacing:2,style:{alignItems:"center"}},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Account Details")),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{component:Z.c,label:"First name",name:"firstName",type:"text",variant:"outlined",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{component:Z.c,label:"Last name",name:"lastName",type:"text",variant:"outlined",fullWidth:!0})),"teacher"===i.role&&c.a.createElement(c.a.Fragment,null,c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement(ne.a,{fullWidth:!0},c.a.createElement(re.a,null,"School district"),c.a.createElement($.a,{component:Z.a,label:"School district",name:"schoolDistrict"},c.a.createElement(oe.a,{value:"ccsd"},"CCSD"),c.a.createElement(oe.a,{value:"evergreen"},"Evergreen")))),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("label",null,c.a.createElement($.a,{component:Z.b,name:"enableBetaFeatures",type:"checkbox"}),c.a.createElement(g,{status:e.values.enableBetaFeatures,value:"Beta features"})))))),c.a.createElement(te.a,{className:b.paper},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Account Security")),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{component:Z.c,label:"New password",name:"password",type:"password",variant:"outlined",fullWidth:!0})))))}))})),ge=a(24),he=a(39),Oe=a(62),ve=a.n(Oe),ye=a(639),je=a(646),Se=a(394),Ae=a(265),De=Object(y.a)((function(e){return{actionButton:{color:e.palette.text.disabled}}})),Ce=function(e){var t=e.action,a=e.children,n=e.className,r=e.disabled,o=e.onClick,l=e.size,s=De();return c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,title:t},c.a.createElement("span",null,c.a.createElement(Ae.a,{"aria-label":t,className:"".concat(s.actionButton," ").concat(n||""),disabled:r,onClick:function(e){e.stopPropagation(),o()},onFocus:function(e){return e.stopPropagation()},size:l},a)))},Te=a(27),Ne=a(592),_e=a(613),Pe=a(626),Re=a(614),we=a(615),Ue=a(641),ke=a(274),xe=function(e){var t=e.suffix,a=e.value;return c.a.createElement(ke.a,{displayType:"text",suffix:t||" pts",thousandSeparator:!0,value:Math.round(a)})},Le=Object(y.a)((function(e){return{insufficient:{backgroundColor:e.palette.error.light},sufficient:{backgroundColor:e.palette.success.light},root:{borderRadius:e.spacing(1),color:e.palette.common.white,padding:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px"),textAlign:"center"}}})),Ie=Object(r.c)((function(e){return Object(J.a)({},e.scores.balance)}),(function(e){return{onLoad:function(t){return e({type:"ACCOUNT_BALANCE_LOADED",payload:Ee.a.Scores.getStudentScores(t)})},onUnload:function(){return e({type:"ACCOUNT_BALANCE_UNLOADED"})}}}))((function(e){var t=e.balance,a=e.cost,n=e.count,r=e.onLoad,l=e.onUnload,s=e.username,i=Le();return Object(o.useEffect)((function(){return r(s),function(){l()}}),[]),Object(o.useEffect)((function(){r(s)}),[n,s]),c.a.createElement("div",{className:"".concat(i.root," ").concat(t>=a?i.sufficient:i.insufficient)},c.a.createElement(A.a,{variant:"h5"},c.a.createElement(xe,{value:t})),c.a.createElement(A.a,{variant:"subtitle2"},c.a.createElement("em",null,"Account Balance")))})),qe=a(322),Fe=Object(y.a)((function(e){return{root:{backgroundColor:e.palette.grey[100],borderRadius:e.spacing(1),marginTop:e.spacing(2),padding:e.spacing(2)}}})),Ge=function(e){var t=e.label,a=e.name,n=e.onChange,r=Object(o.useState)(""),l=Object(le.a)(r,2),s=l[0],i=l[1],u=Fe();return c.a.createElement("div",{className:u.root},c.a.createElement(qe.a,{fullWidth:!0,label:t,name:a,onChange:function(e){var t=e.target.value;n(t),i(t)},value:s}))},Be=a(636),We=a(407),He=a(402),Me=a(398),ze=a(393),Ve=a(397),Ye=a(282),Qe=a(637),Ke=a(638),Je=a(640),$e=a(667),Ze=a(275),Xe=a.n(Ze),et=a(276),tt=a.n(et),at=Object(r.c)((function(e){return Object(J.a)({},e.products)}),(function(e){return{onLoad:function(){return e({type:"PRODUCT_SELECTOR_LOADED",payload:Ee.a.Products.getAll()})},onUnload:function(){return e({type:"PRODUCT_SELECTOR_UNLOADED"})}}}))((function(e){var t=e.allowAny,a=e.onChange,n=e.onLoad,r=e.onUnload,l=e.products;Object(o.useEffect)((function(){return n(),function(){r()}}),[]);var s=l.map((function(e){return Object(J.a)(Object(J.a)({},e),{},{status:e.quantity>0?"In Stock":"Out of Stock"})})).sort((function(e,t){return-t.status.localeCompare(e.status)}));return c.a.createElement($e.a,{autoHighlight:!0,freeSolo:null===t||void 0===t||t,getOptionLabel:function(e){return e.name},getOptionSelected:function(e,t){return e._id===t._id},groupBy:function(e){return e.status},noOptionsText:"No products have been added",onInputChange:function(e,t){a(t)},onChange:function(e,t){a(t)},options:s,renderInput:function(e){return c.a.createElement(qe.a,Object.assign({},e,{label:"Description",placeholder:"Type or select a product",required:!0}))},renderOption:function(e,t){var a=t.inputValue,n=tt()(e.name,a),r=Xe()(e.name,n);return c.a.createElement("div",null,r.map((function(e,t){return c.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})))}})})),nt=function(e,t,a){if(e&&t){var n=e.map((function(e){return{desc:e.name,imgUrl:e.photoUrl,max:e.maxPurchaseQuantity,onHand:e.quantity,price:t[e._id]*e.cost,qty:t[e._id],unit:e.cost,_id:e._id}})),r=n.map((function(e){return e.price})).reduce((function(e,t){return e+t}),0),o=a/100*r;return{items:n,invoice:{subtotal:r,taxes:o,total:o+r}}}return{}},rt=function(e){if(e.includes("drive.google.com")){var t=e.match(/file\/d\/(.*)\/view*/);if(null!==t)return"https://drive.google.com/uc?export=view&id=".concat(t[1])}return e},ot=function(e,t){var a=e.task.totalPoints,n=e.task.multiplier,r=0===a?1:a,o=Math.round(e.value/r*100);return t[10*Math.floor((o>100?100:o)/10)]*n},ct=Object(y.a)((function(e){return{emptyCart:{textAlign:"center"},icon:{marginRight:e.spacing(1)},tableCellImg:{alignItems:"center",display:"flex","& img":{height:"50px",marginRight:e.spacing(2)}}}})),lt=Object(r.c)((function(e){return Object(J.a)({},e.common.settings)}),{})((function(e){var t=e.actions,a=e.products,n=e.quantities,r=e.taxRate,l=ct(),s=nt(a,n,r),i=s.items,u=s.invoice,m=Object(o.useState)(!1),d=Object(le.a)(m,2),p=d[0],E=d[1],f=Object(o.useState)({}),b=Object(le.a)(f,2),g=b[0],h=b[1],O=function(){E(!p),h({})},v=function(e){return t.update(e.target.name,e.target.value)};return Object(o.useEffect)((function(){t&&t.hasOwnProperty("setInvoice")&&t.setInvoice(u)}),[a,n,r]),c.a.createElement(Be.a,null,c.a.createElement(We.a,null,c.a.createElement(He.a,null,c.a.createElement(Me.a,null,c.a.createElement(ze.a,{align:"center",colSpan:3},"Purchase Details"),c.a.createElement(ze.a,{align:"right"},"Cost")),c.a.createElement(Me.a,null,c.a.createElement(ze.a,null,"Items"),c.a.createElement(ze.a,{align:"right"},"Quantity"),c.a.createElement(ze.a,{align:"right"},"Item Cost"),c.a.createElement(ze.a,{align:"right"},"Total Cost"))),c.a.createElement(Ve.a,null,i.length>0?i.map((function(e){return c.a.createElement(Me.a,{key:e.desc},c.a.createElement(ze.a,{className:l.tableCellImg},c.a.createElement("img",{height:"50px",src:rt(e.imgUrl)}),e.desc),c.a.createElement(ze.a,{align:"right"},t?c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Remove from cart",onClick:function(){return a=e._id,t.delete(a);var a}},c.a.createElement(Qe.a,null)),c.a.createElement(Ye.a,{name:e._id,onChange:v,value:e.qty},function(e){for(var t=0===e?100:e,a=[],n=1;n<=t;n++)a.push(c.a.createElement(oe.a,{value:n,key:n},n));return a}(e.onHand<e.max||0===e.max?e.onHand:e.max))):e.qty),c.a.createElement(ze.a,{align:"right"},c.a.createElement(xe,{value:e.unit})),c.a.createElement(ze.a,{align:"right"},c.a.createElement(xe,{value:e.price})))})):c.a.createElement(Me.a,null,c.a.createElement(ze.a,{colSpan:4,className:l.emptyCart},"Your cart is empty")),p&&c.a.createElement(Me.a,null,c.a.createElement(ze.a,{colSpan:3},c.a.createElement(at,{allowAny:!1,onChange:function(e){return h(e||{})}})),c.a.createElement(ze.a,{align:"right"},c.a.createElement(Ce,{action:"Add to cart",disabled:!g.hasOwnProperty("name"),onClick:function(){t.add(g),O()}},c.a.createElement(Ke.a,null)),c.a.createElement(Ce,{action:"Cancel",onClick:O},c.a.createElement(ye.a,null)))),c.a.createElement(Me.a,null,c.a.createElement(ze.a,{rowSpan:3},t&&t.hasOwnProperty("add")&&c.a.createElement(D.a,{color:"primary",disabled:p,onClick:O,size:"small",variant:"outlined"},c.a.createElement(Je.a,{className:l.icon}),"Add item")),c.a.createElement(ze.a,{colSpan:2},"Subtotal"),c.a.createElement(ze.a,{align:"right"},c.a.createElement(xe,{value:u.subtotal}))),c.a.createElement(Me.a,null,c.a.createElement(ze.a,null,"Taxes & Fees"),c.a.createElement(ze.a,{align:"right"},"".concat(r,"%")),c.a.createElement(ze.a,{align:"right"},c.a.createElement(xe,{value:u.taxes}))),c.a.createElement(Me.a,null,c.a.createElement(ze.a,{colSpan:2},"Total"),c.a.createElement(ze.a,{align:"right"},c.a.createElement(xe,{value:u.total}))))))})),st=Object(r.c)((function(e){return Object(J.a)({},e.purchases)}),(function(e){return{onAddItem:function(t){return e({type:"ADD_TO_CART",product:t})},onDeleteItem:function(t){return e({type:"DELETE_CART_PRODUCT",productId:t})},onExit:function(){return e({type:"ADD_PURCHASE_DIALOG_UNLOADED"})},onSubmit:function(t){return e({type:"ADD_PURCHASE",payload:Ee.a.Purchases.add(t),snackbar:{message:"Purchase added",variant:"success"}})},onUpdateItem:function(t,a){return e({type:"UPDATE_CART_PRODUCT_QUANTITY",productId:t,qty:a})}}}))((function(e){var t=e.cart,a=e.errors,n=e.inProgress,r=e.onAddItem,l=e.onDeleteItem,s=e.onExit,i=e.onSubmit,u=e.onUpdateItem,m=e.student,d=Object(o.useState)(!1),p=Object(le.a)(d,2),E=p[0],f=p[1],b=Object(o.useState)({}),g=Object(le.a)(b,2),h=g[0],O=g[1],v=Object(o.useState)(""),y=Object(le.a)(v,2),j=y[0],S=y[1],A=Object(Te.a)(),C=Object(Ne.a)(A.breakpoints.down("md")),T=function(){f(!1),O({}),S("")};return Object(o.useEffect)((function(){n||a||f(!1)}),[n]),c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Add purchase",onClick:function(){return f(!0)}},c.a.createElement(Ue.a,null)),c.a.createElement(_e.a,{fullScreen:C,fullWidth:!0,maxWidth:"md",onClick:function(e){return e.stopPropagation()},onClose:T,onExit:s,onFocus:function(e){return e.stopPropagation()},open:E},c.a.createElement(Pe.a,null,"Add Purchase"),c.a.createElement(Re.a,null,c.a.createElement(me,{errors:a}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(lt,{actions:{add:r,delete:l,setInvoice:function(e){return O(e)},update:u},products:t.products,quantities:t.quantities}),c.a.createElement(Ge,{label:"Notes (optional)",name:"purchaseNote",onChange:S})))),c.a.createElement(we.a,null,c.a.createElement("div",{style:{marginRight:"auto"}},c.a.createElement(Ie,{cost:h.total,username:m.username})),c.a.createElement(D.a,{disabled:n||0===t.products.length,color:"primary",onClick:function(){i({note:j,products:t.products,quantities:t.quantities,status:"approved",student:m}),T()},type:"submit",variant:"contained"},n?"Adding...":"Add"),c.a.createElement(D.a,{disabled:n,onClick:T,variant:"contained"},"Cancel"))))})),it=a(642),ut=Object(y.a)((function(e){return{alert:{"&:not(:last-of-type)":{marginBottom:e.spacing(2)}}}})),mt=Object(r.c)((function(e){return Object(J.a)({},e.notifications)}),(function(e){return{onLoad:function(){return e({type:"NOTIFICATION_DIALOG_LOADED",payload:Ee.a.Notifications.getAll()})},onUnload:function(){return e({type:"NOTIFICATION_DIALOG_UNLOADED",payload:Ee.a.Notifications.clearAll()})}}}))((function(e){var t=e.errors,a=e.notifications,n=e.onLoad,r=e.onUnload,l=Object(o.useState)(!1),s=Object(le.a)(l,2),i=s[0],u=s[1],m=ut(),d=Object(Te.a)(),p=Object(Ne.a)(d.breakpoints.down("md")),E=function(){u(!1),r()};return Object(o.useEffect)((function(){n()}),[]),Object(o.useEffect)((function(){a.length>0&&u(!0)}),[a]),c.a.createElement(_e.a,{fullScreen:p,fullWidth:!0,maxWidth:"md",open:i,onClose:E,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Notification Center"),c.a.createElement(Re.a,null,c.a.createElement(me,{errors:t}),a.length>0?a.map((function(e,t){return c.a.createElement(ie.a,{className:m.alert,key:t,severity:e.type},c.a.createElement(it.a,null,e.title),e.content)})):c.a.createElement(ie.a,{severity:"info"},c.a.createElement(it.a,null,"All caught up!"),"You have no notifications at this time")),c.a.createElement(we.a,null,c.a.createElement(D.a,{onClick:E,variant:"contained"},"Close")))})),dt=a(625),pt=a(643),Et=Object(r.c)((function(e){return{defaultStudentPassword:e.common.settings.defaultStudentPassword}}),(function(e){return{onSubmit:function(t){return e({type:"RESET_STUDENT_PASSWORD",payload:Ee.a.Students.update(t),snackbar:{message:"Password reset",variant:"success"}})}}}))((function(e){var t=e.btnSize,a=e.defaultStudentPassword,n=e.onSubmit,r=e.student,l=Object(o.useState)(!1),s=Object(le.a)(l,2),i=s[0],u=s[1],m=function(){u(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Reset password",onClick:function(){u(!0)},size:null!==t&&void 0!==t?t:"small"},c.a.createElement(pt.a,{fontSize:"inherit"})),c.a.createElement(_e.a,{open:i,onClose:m,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Reset Password"),c.a.createElement(Re.a,null,c.a.createElement(dt.a,null,"Do you want to reset"," ",c.a.createElement("b",null,r.firstName," ",r.lastName),"'s password to ",c.a.createElement("strong",null,a),"?")),c.a.createElement(we.a,null,c.a.createElement(D.a,{onClick:function(){var e=Object(J.a)(Object(J.a)({},r),{},{password:a});n(e),u(!1)},color:"primary",variant:"contained",autoFocus:!0},"Reset"),c.a.createElement(D.a,{onClick:m,variant:"contained"},"Cancel"))))})),ft=a(644),bt=a(645),gt=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.scores),{},{products:e.products.products,taxRate:e.common.settings.taxRate})}),(function(e){return{onAdd:function(t){return e({type:"ADD_TRANSACTION",payload:Ee.a.Transactions.add(t),snackbar:{message:"".concat(t.typeTitle," added"),variant:"success"}})},onExit:function(){return e({type:"TRANSACTION_DIALOG_UNLOADED"})}}}))((function(e){var t=e.errors,a=e.inProgress,n=e.onAdd,r=e.onExit,l=e.student,s=e.taxRate,i=e.type,u=Object(o.useState)(!1),m=Object(le.a)(u,2),d=m[0],p=m[1],E=Object(Te.a)(),f=Object(Ne.a)(E.breakpoints.down("md")),b=function(){p(!1)},g=function(e){n(Object(J.a)(Object(J.a)({},e),{},{student:l,type:i.toLowerCase(),typeTitle:i}))};return Object(o.useEffect)((function(){a||t||p(!1)}),[a]),c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Add ".concat("Purchase"===i?"quick":""," ").concat(i.toLowerCase()),onClick:function(){p(!0)}},"Bonus"===i&&c.a.createElement(ft.a,null),"Purchase"===i&&c.a.createElement(bt.a,null)),c.a.createElement(_e.a,{fullScreen:f,fullWidth:!0,maxWidth:"md",onClick:function(e){return e.stopPropagation()},onClose:b,onExit:r,onFocus:function(e){return e.stopPropagation()},open:d},c.a.createElement($.c,{initialValues:{amount:"",description:"",productId:""},validationSchema:X.c({amount:X.b().typeError("Numbers only").required("Required"),description:X.d().required("Required"),productId:X.d()}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},(function(e){return c.a.createElement($.b,null,c.a.createElement(Pe.a,null,"Add ","Purchase"===i&&"Quick"," ",i),c.a.createElement(Re.a,null,c.a.createElement(me,{errors:t}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:6},"Bonus"===i?c.a.createElement($.a,{autoFocus:!0,color:"primary",component:Z.c,disabled:a,label:"Description",name:"description",type:"text",fullWidth:!0}):c.a.createElement(at,{onChange:function(t){var a;"string"===typeof t?e.setFieldValue("description",t):t&&"object"===typeof t?(e.setFieldValue("amount",(a=t.cost,Math.round(a*(s/100+1)))),e.setFieldValue("description",t.name),e.setFieldValue("productId",t._id)):(e.setFieldValue("amount",""),e.setFieldValue("description",""))}})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:a,label:"Amount",name:"amount",type:"text",fullWidth:!0})))),c.a.createElement(we.a,null,c.a.createElement(D.a,{disabled:a,color:"primary",type:"submit",variant:"contained"},a?"Adding...":"Add"),c.a.createElement(D.a,{disabled:a,onClick:b,variant:"contained"},"Cancel")))}))))})),ht=Object(y.a)((function(e){return{actions:Object(he.a)({alignItems:"flex-start",display:"flex"},e.breakpoints.up("lg"),{justifyContent:"flex-end"}),balance:{textAlign:"center","& > h6":{borderTop:"1px solid #ccc",fontStyle:"italic",textTransform:"lowercase"}},edit:{backgroundColor:e.palette.primary.main},paper:{padding:e.spacing(2)},subtotal:{position:"relative",textAlign:"center","& > p":{position:"relative",bottom:-e.spacing(1)},"& > h6":{fontSize:e.typography.pxToRem(12),fontStyle:"italic",textTransform:"lowercase"}},unit:{fontSize:e.typography.pxToRem(12)}}})),Ot=function(e){var t=e.doEdit,a=e.onEditClick,n=e.storeEnabled,r=e.student,o=e.total,l=e.userRole,s=ht();return c.a.createElement(te.a,{className:s.paper},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement(A.a,{gutterBottom:!0,variant:"h5"},r.firstName," ",r.lastName),r.course&&c.a.createElement(A.a,{gutterBottom:!0,color:"textSecondary",variant:"subtitle1"},r.course," \xb7 Period ",r.period),c.a.createElement(A.a,{color:"textSecondary",variant:"subtitle2"},r.username)),c.a.createElement(ae.a,{item:!0,xs:12,md:4,container:!0},c.a.createElement(ae.a,{item:!0,xs:12,className:s.balance},c.a.createElement(A.a,{color:(null===o||void 0===o?void 0:o.balance)>=0?"primary":"secondary",variant:"h4"},c.a.createElement(xe,{suffix:" ",value:null===o||void 0===o?void 0:o.balance}),c.a.createElement("span",{className:s.unit},"pts")),c.a.createElement(A.a,{color:"textSecondary",variant:"subtitle2"},"Balance")),c.a.createElement(ae.a,{item:!0,xs:4,className:s.subtotal},c.a.createElement(A.a,{color:"primary",variant:"body1"},c.a.createElement(xe,{suffix:" ",value:null===o||void 0===o?void 0:o.bonuses}),c.a.createElement("span",{className:s.unit},"pts")),c.a.createElement(A.a,{color:"primary",variant:"subtitle2"},"Bonuses")),c.a.createElement(ae.a,{item:!0,xs:4,className:s.subtotal},c.a.createElement(A.a,{color:"secondary",variant:"body1"},c.a.createElement(xe,{suffix:" ",value:null===o||void 0===o?void 0:o.purchases}),c.a.createElement("span",{className:s.unit},"pts")),c.a.createElement(A.a,{color:"secondary",variant:"subtitle2"},"Purchases")),c.a.createElement(ae.a,{item:!0,xs:4,className:s.subtotal},c.a.createElement(A.a,{color:"primary",variant:"body1"},c.a.createElement(xe,{suffix:" ",value:null===o||void 0===o?void 0:o.scores}),c.a.createElement("span",{className:s.unit},"pts")),c.a.createElement(A.a,{color:"primary",variant:"subtitle2"},"Assessments"))),c.a.createElement(ae.a,{item:!0,xs:12,md:4,className:s.actions},"teacher"===l?c.a.createElement(c.a.Fragment,null,c.a.createElement(gt,{student:r,type:"Bonus"}),c.a.createElement(gt,{student:r,type:"Purchase"}),n&&c.a.createElement(st,{student:r}),c.a.createElement(Ce,{action:t?"Finish editing":"Edit transactions",className:t&&s.edit,onClick:a},t?c.a.createElement(ye.a,null):c.a.createElement(je.a,null)),c.a.createElement(Et,{btnSize:"medium",student:r})):c.a.createElement(mt,null))))},vt=function(e){var t=e.conversions,a=e.doEdit,n=e.onDelete,r=e.onUpdate,l=e.transactions,s=Object(o.useState)([]),i=Object(le.a)(s,2),u=i[0],m=i[1],d=function(e){return{amount:e.amount,createdAt:new Date(e.createdAt).toDateString(),description:e.description,type:e.type,_id:e._id}},p=function(e){var n=e.bonuses,r=e.purchases,o=e.scores,c=[].concat(Object(ge.a)(n.map((function(e){return d(e)}))),Object(ge.a)(r.map((function(e){return d(e)}))));return a?c:[].concat(Object(ge.a)(c),Object(ge.a)(o.map((function(e){return function(e){return{amount:ot(e,t),createdAt:new Date(e.createdAt).toDateString(),description:e.task.title,type:"assessment"}}(e)}))))},E=Object(o.useState)([{title:"Date",field:"createdAt",editable:"never",defaultSort:"desc"},{title:"Description",field:"description"},{title:"Amount",field:"amount",render:function(e){return c.a.createElement(xe,{value:e.amount})}},{title:"Type",field:"type",editable:"never"}]),f=Object(le.a)(E,1)[0];return Object(o.useEffect)((function(){l&&m(p(l))}),[a,l]),c.a.createElement(ve.a,{columns:f,data:u,localization:{body:{emptyDataSourceMessage:a?"No editable transactions available":"No transactions have posted",editRow:{deleteText:"Delete this transaction?"}}},options:{actionsColumnIndex:-1,paging:!1,toolbar:!1},editable:a?{onRowUpdate:function(e,t){return new Promise((function(a,n){var o=Object(ge.a)(u);o[t.tableData.id]=e,m(Object(ge.a)(o)),r(e),a()}))},onRowDelete:function(e){return new Promise((function(t,a){var r=Object(ge.a)(u),o=e.tableData.id;r.splice(o,1),m(Object(ge.a)(r)),n(e),t()}))}}:{}})},yt=Object(r.c)((function(e){return{conversions:e.scores.conversions,storeEnabled:e.common.settings.storeEnabled,total:e.scores.total,transactions:e.scores.transactions,userRole:e.common.currentUser.role}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_TRANSACTION",payload:Ee.a.Transactions.delete(t),snackbar:{message:"Transaction deleted",variant:"success"}})},onLoad:function(t){return e({type:"ACCOUNT_VIEW_LOADED",payload:Ee.a.Scores.getStudentScores(t)})},onUnload:function(){return e({type:"ACCOUNT_VIEW_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_TRANSACTION",payload:Ee.a.Transactions.update(t),snackbar:{message:"Transaction updated",variant:"success"}})}}}))((function(e){var t=e.conversions,a=e.onDelete,n=e.onLoad,r=e.onUnload,l=e.onUpdate,s=e.storeEnabled,i=e.student,u=e.total,m=e.transactions,d=e.userRole,p=Object(o.useState)(!1),E=Object(le.a)(p,2),f=E[0],b=E[1];return Object(o.useEffect)((function(){return function(){r()}}),[]),Object(o.useEffect)((function(){n(i.username)}),[i]),c.a.createElement(c.a.Fragment,null,m&&c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(Ot,{doEdit:f,onEditClick:function(){b(!f)},storeEnabled:s,student:i,total:u,userRole:d})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(vt,{conversions:t,doEdit:f,onDelete:a,onUpdate:l,transactions:m}))))})),jt=Object(r.c)((function(e){return{currentUser:e.common.currentUser}}),(function(){return{}}))((function(e){var t=e.currentUser;return c.a.createElement(yt,{student:t})})),St=a(323),At=a(280),Dt=a(647),Ct=a(442),Tt=a.n(Ct),Nt=Object(y.a)((function(e){return{button:{marginBottom:e.spacing(2),marginRight:e.spacing(2)},dialog:{backgroundImage:"url(".concat(Tt.a,")"),backgroundPosition:"center bottom",backgroundSize:"cover",color:"white",padding:e.spacing(4)},icon:{marginRight:e.spacing(1)},input:{backgroundColor:"rgba(0,65,91,0.8)",borderRadius:e.spacing(1),height:78,"& input":{color:e.palette.secondary.main}},inputLabel:{color:"white"}}})),_t=Object(r.c)((function(e){return{settings:e.common.settings}}),(function(e){return{onSubmit:function(t){return e({type:"SUBMIT_SONG_REQUEST",payload:Ee.a.Songs.request(t),snackbar:{message:"Song requested",variant:"success"}})}}}))((function(e){var t=e.onSubmit,a=e.settings,n=Object(o.useState)(!1),r=Object(le.a)(n,2),l=r[0],s=r[1],i=Object(Te.a)(),u=Object(Ne.a)(i.breakpoints.down("md")),m=Nt(),d=function(){s(!1)},p=function(e){t(e),s(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(ee.a,{color:"primary",onClick:function(){s(!0)},variant:"extended"},c.a.createElement(Je.a,{className:m.icon}),"Buy a song"),c.a.createElement(_e.a,{classes:{paper:m.dialog},fullScreen:u,open:l,onClose:d},c.a.createElement(A.a,{variant:"h3",align:"center",color:"secondary",gutterBottom:!0},"Purchase a Song"),c.a.createElement(A.a,{variant:"body1",gutterBottom:!0},"Please provide the song and artist title for your request. If approved, ",a.songRequestPurchaseAmount," points will be charged to your account."),c.a.createElement($.c,{initialValues:{artist:"",title:""},validationSchema:X.c({artist:X.d().required("Required"),title:X.d().required("Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement($.b,null,c.a.createElement(ae.a,{container:!0,spacing:4},c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{autoFocus:!0,className:m.input,color:"primary",component:Z.c,InputLabelProps:{classes:{root:m.inputLabel}},label:"Song Title",name:"title",type:"text",variant:"filled",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{className:m.input,color:"primary",component:Z.c,InputLabelProps:{classes:{root:m.inputLabel}},label:"Artist",name:"artist",type:"text",variant:"filled",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(D.a,{className:m.button,color:"primary",type:"submit",variant:"contained"},"Buy"),c.a.createElement(D.a,{className:m.button,onClick:d,variant:"contained"},"Cancel")))))))})),Pt=Object(y.a)((function(e){return{icon:{marginLeft:e.spacing(1)},paper:{paddingLeft:e.spacing(2),marginBottom:e.spacing(4)},status:{alignItems:"center",display:"flex"}}})),Rt=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.songs),{},{currentUser:e.common.currentUser,settings:e.common.settings})}),(function(e){return{onDelete:function(t){return e({type:"SUBMIT_SONG_REMOVAL_REQUEST",payload:Ee.a.Songs.update(t),snackbar:{message:"Song removal request submitted",variant:"success"}})},onLoad:function(){return e({type:"STUDENT_SONGS_PAGE_LOADED",payload:Ee.a.Songs.forStudent()})},onUnload:function(){return e({type:"SONGS_PAGE_UNLOADED"})}}}))((function(e){var t=e.course,a=e.courseSongs,n=e.currentUser,r=e.onDelete,l=e.onLoad,s=e.onUnload,i=e.settings,u=e.userSongs,m=Object(o.useState)(!0),d=Object(le.a)(m,2),p=d[0],E=d[1],f=Object(o.useState)([]),b=Object(le.a)(f,2),g=b[0],h=b[1],O=Object(o.useState)([]),v=Object(le.a)(O,2),y=v[0],j=v[1],S=Pt();return Object(o.useEffect)((function(){return l(),function(){return s()}}),[]),Object(o.useEffect)((function(){j([{title:"Request Date",field:"createdAt",editable:"never"},{title:"Song Title",field:"title"},{title:"Song Artist",field:"artist"}].concat(Object(ge.a)(p?[]:[{title:"Purchased by",field:"purchasedBy",editable:"never"}]),[{title:"Status",field:"status",lookup:{approved:"approved",pending:"pending",pendingApproval:"pending approval",pendingRemoval:"pending removal",rejected:"rejected",removed:"removed"},render:function(e,t){return"row"===t?c.a.createElement("span",{style:{alignItems:"center",display:"flex"}},e.statusDescription?c.a.createElement(c.a.Fragment,null,e.status,c.a.createElement(Se.a,{arrow:!0,color:"primary",enterTouchDelay:0,title:e.statusDescription},c.a.createElement(Dt.a,{style:{marginLeft:"8px"}}))):e.status):c.a.createElement("span",null,e)}}])),h((p?u:a).map((function(e){return{createdAt:new Date(e.createdAt).toDateString(),title:e.title,artist:e.artist,purchasedBy:"".concat(e.student.firstName," ").concat(e.student.lastName),status:e.status,statusDescription:e.statusDescription,_id:e._id}})))}),[a,p,u]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Songs for "+(p?n.firstName:"Period "+t.period)},c.a.createElement(_t,null)),c.a.createElement(te.a,{className:S.paper},c.a.createElement(ae.a,{container:!0,spacing:2,className:S.grid},c.a.createElement(ae.a,{item:!0,xs:12,className:S.grid},c.a.createElement(St.a,{control:c.a.createElement(At.a,{checked:p,onChange:function(e){E(e.target.checked)},name:"mySongsOnly"}),label:"show only my songs"})))),c.a.createElement(ve.a,{title:"Class Playlist",columns:y,data:g,localization:{body:{emptyDataSourceMessage:"No songs have been added to this class playlist",editRow:{deleteText:"Delete this song for ".concat(i.songRemovalPurchaseAmount," points?"),saveTooltip:"Delete song"}}},options:{actionsColumnIndex:-1,paging:!1,toolbar:!1},editable:{isDeletable:function(e){return"approved"===e.status},isDeleteHidden:function(){return!i.songRemovalRequestEnabled},onRowDelete:function(e){return new Promise((function(t){r({id:e._id,status:"pending removal",statusDescription:""}),t()}))}}}))})),wt=a(590),Ut=Object(y.a)((function(e){return{alert:{marginBottom:e.spacing(2)}}})),kt=Object(r.c)((function(){return{}}),(function(e){return{onClose:function(){return e({type:"ALERT_CLOSED"})}}}))((function(e){var t=e.children,a=e.disableClose,n=e.onClose,r=e.severity,l=e.variant,s=Ut(),i=Object(o.useState)(!0),u=Object(le.a)(i,2),m=u[0],d=u[1];return c.a.createElement("div",{className:s.alert},c.a.createElement(wt.a,{in:m},c.a.createElement(ie.a,{action:!a&&c.a.createElement(Ae.a,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){d(!1),n()}},c.a.createElement(ye.a,{fontSize:"inherit"})),severity:r||"info",variant:l||"outlined"},t)))})),xt=a(648),Lt=a(649),It=a(650),qt=a(651),Ft=a(652),Gt=a(653),Bt=a(654),Wt=a(429),Ht=function(e){var t=e.accounts,a=Object(o.useState)([]),n=Object(le.a)(a,2),r=n[0],l=n[1],s=t.map((function(e){return{accountTotal:e.totals.account,assessmentTotal:e.totals.assessments,bonusTotal:e.totals.bonuses,course:e.course,firstName:e.firstName,id:e.id,lastName:e.lastName,period:e.period,purchaseTotal:e.totals.purchases,songTotal:e.totals.songs}})),i=Object(o.useState)([{title:"First Name",field:"firstName"},{title:"Last Name",field:"lastName"},{title:"Period",field:"period",render:function(e,t){return"row"===t?c.a.createElement(Wt.a,{label:e.period,color:"secondary"}):c.a.createElement(Wt.a,{label:e,color:"secondary"})}},{title:"Account Total",field:"accountTotal",render:function(e,t){return"row"===t?c.a.createElement(xe,{suffix:" ",value:e.accountTotal}):c.a.createElement(xe,{value:e})}},{title:"Assessment Total",field:"assessmentTotal",render:function(e,t){return"row"===t?c.a.createElement(xe,{suffix:" ",value:e.assessmentTotal}):c.a.createElement(xe,{value:e})}},{title:"Bonus Total",field:"bonusTotal",render:function(e,t){return"row"===t?c.a.createElement(xe,{suffix:" ",value:e.bonusTotal}):c.a.createElement(xe,{value:e})}},{title:"Purchase Total",field:"purchaseTotal",render:function(e,t){return"row"===t?c.a.createElement(xe,{suffix:" ",value:e.purchaseTotal}):c.a.createElement(xe,{value:e})}},{title:"Song Total",field:"songTotal"}]),u=Object(le.a)(i,1)[0];return Object(o.useEffect)((function(){l(s)}),[t]),c.a.createElement(ve.a,{columns:u,data:r,options:{grouping:!0,paging:!1,toolbar:!1},style:{boxShadow:"none"},title:"Account Summary"})},Mt=a(391),zt=Object(y.a)((function(e){return{message:{fontStyle:"italic"},root:{alignItems:"center",display:"flex",justifyContent:"center",minWidth:e.spacing(40)},spinner:{marginRight:e.spacing(2)}}})),Vt=function(e){var t=e.message,a=zt();return c.a.createElement("div",{className:a.root},c.a.createElement(Mt.a,{className:a.spinner}),c.a.createElement(A.a,{className:a.message},t||"Working..."))},Yt=a(622),Qt=a(623),Kt=a(668),Jt=Object(y.a)((function(e){return{statAvatar:{backgroundColor:e.palette.primary.main,height:e.spacing(6),marginBottom:e.spacing(2),width:e.spacing(6)},statCard:{alignItems:"center",display:"flex",flexFlow:"column nowrap",justifyContent:"center"}}})),$t=function(e){var t=e.children,a=e.icon,n=e.title,r=e.value,o=Jt();return c.a.createElement(ae.a,{item:!0,xs:12,md:6,lg:4},c.a.createElement(Yt.a,{variant:"outlined"},c.a.createElement(Qt.a,{className:o.statCard},c.a.createElement(Kt.a,{className:o.statAvatar},a),c.a.createElement(A.a,{variant:"h5"},n),c.a.createElement(A.a,{variant:"h6"},c.a.createElement(ke.a,{displayType:"text",thousandSeparator:!0,value:r})),c.a.createElement(A.a,{variant:"h6"},t))))},Zt=a(591),Xt=c.a.forwardRef((function(e,t){return c.a.createElement(Zt.a,Object.assign({direction:"up",ref:t},e))})),ea=Object(y.a)((function(e){return{title:{color:e.palette.common.white,margin:"0 auto"}}})),ta=function(e){var t,a,n=e.data;return c.a.createElement(ae.a,{container:!0,spacing:3},c.a.createElement($t,{icon:c.a.createElement(xt.a,{fontSize:"large"}),title:"Total Points",value:n.reduce((function(e,t){return e+(t.totals.account||0)}),0)}),c.a.createElement($t,{icon:c.a.createElement(Lt.a,{fontSize:"large"}),title:"Top Student"},null===(t=n[0])||void 0===t?void 0:t.firstName," ",null===(a=n[0])||void 0===a?void 0:a.lastName),c.a.createElement($t,{icon:c.a.createElement(It.a,{fontSize:"large"}),title:"Total Assessment Points",value:n.reduce((function(e,t){return e+(t.totals.assessments||0)}),0)}),c.a.createElement($t,{icon:c.a.createElement(qt.a,{fontSize:"large"}),title:"Total Bonus Points",value:n.reduce((function(e,t){return e+(t.totals.bonuses||0)}),0)}),c.a.createElement($t,{icon:c.a.createElement(Ft.a,{fontSize:"large"}),title:"Total Purchase Points",value:n.reduce((function(e,t){return e+(t.totals.purchases||0)}),0)}),c.a.createElement($t,{icon:c.a.createElement(Gt.a,{fontSize:"large"}),title:"Total Song Requests",value:n.reduce((function(e,t){return e+t.totals.songs}),0)}),c.a.createElement($t,{icon:c.a.createElement(Bt.a,{fontSize:"large"}),title:"Total Students",value:n.length}),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(te.a,{elevation:3,style:{padding:"16px",overflow:"scroll"}},c.a.createElement(A.a,{gutterBottom:!0,variant:"h6"},"Account Summary"),c.a.createElement(Ht,{accounts:n}))))},aa=Object(r.c)((function(e){return Object(J.a)({},e.economy)}),(function(e){return{onLoad:function(){return e({type:"ECONOMY_DIALOG_LOADED",payload:Ee.a.Scores.getAll()})},onUnload:function(){return e({type:"ECONOMY_DIALOG_UNLOADED"})}}}))((function(e){var t=e.errors,a=e.inProgress,n=e.onLoad,r=e.onUnload,l=e.students,s=Object(o.useState)([]),i=Object(le.a)(s,2),u=i[0],m=i[1],d=Object(o.useState)(!1),p=Object(le.a)(d,2),E=p[0],f=p[1],b=ea(),g=function(){f(!1),r()};return Object(o.useEffect)((function(){m(l.sort((function(e,t){return t.totals.account-e.totals.account})))}),[l]),c.a.createElement(c.a.Fragment,null,c.a.createElement(D.a,{onClick:function(){f(!0),n()},size:"small"},"View Economy"),c.a.createElement(_e.a,{fullScreen:!0,open:E,onClick:function(e){return e.stopPropagation()},onClose:g,onFocus:function(e){return e.stopPropagation()},TransitionComponent:Xt},c.a.createElement(j.a,{position:"relative"},c.a.createElement(S.a,null,c.a.createElement(Ae.a,{edge:"start",onClick:g},c.a.createElement(ye.a,null)),c.a.createElement(A.a,{variant:"h5",className:b.title},"Accounts"))),c.a.createElement(M,null,c.a.createElement(v.a,null,c.a.createElement(pe,{title:"Economy View"}),c.a.createElement(me,{errors:t}),a?c.a.createElement(Vt,{message:"Computing..."}):u.length>0?c.a.createElement(ta,{data:u}):c.a.createElement(ie.a,{severity:"info"},c.a.createElement(it.a,null,"No data available"),"You must create at least one course, add students to that course, and add bonuses, purchases, or scores before any data will be visible here")))))})),na=Object(y.a)((function(e){return{search:{padding:e.spacing(2)}}})),ra=Object(r.c)((function(e){return{courses:e.courses.courses}}),(function(e){return{onLoad:function(){return e({type:"STUDENT_SEARCH_LOADED",payload:Ee.a.Courses.getAll()})},onUnload:function(){return e({type:"STUDENT_SEARCH_UNLOADED"})}}}))((function(e){var t=e.courses,a=e.onChange,n=e.onLoad,r=e.onUnload,l=Object(o.useState)([]),s=Object(le.a)(l,2),i=s[0],u=s[1],m=na();return Object(o.useEffect)((function(){return n(),function(){r()}}),[]),Object(o.useEffect)((function(){var e=t.map((function(e){return e.students.map((function(t){return Object(J.a)(Object(J.a)({},t),{},{course:e.name,period:e.period,name:"".concat(t.firstName," ").concat(t.lastName)})}))})).flat();u(e)}),[t]),c.a.createElement(te.a,{className:m.search},c.a.createElement($e.a,{autoHighlight:!0,getOptionLabel:function(e){return e.name},groupBy:function(e){return"Period ".concat(e.period," | ").concat(e.course)},noOptionsText:"No students have been added",onChange:function(e,t){return a(t)},options:i,renderInput:function(e){return c.a.createElement(qe.a,Object.assign({},e,{label:"Student",placeholder:"Type or select a name"}))},renderOption:function(e,t){var a=t.inputValue,n=tt()(e.name,a),r=Xe()(e.name,n);return c.a.createElement("div",null,r.map((function(e,t){return c.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})))}}))})),oa=a(243),ca=a(634),la=a(401),sa=a(655),ia=Object(y.a)((function(e){return{courses:{"& div":{boxShadow:e.shadows[4],cursor:"pointer",marginBottom:e.spacing(1),padding:"".concat(e.spacing(3),"px ").concat(e.spacing(4),"px"),transition:"all 0.15s ease-in-out","&:focus":{backgroundColor:e.palette.primary.main,boxShadow:e.shadows[1]},"&:hover":{backgroundColor:e.palette.primary.light,boxShadow:e.shadows[1]}}}}})),ua=Object(r.c)((function(e){return{courses:e.courses.courses}}),(function(){return{}}))((function(e){var t=e.courses,a=e.onSelect,n=ia();return c.a.createElement("div",null,c.a.createElement(A.a,{gutterBottom:!0,variant:"h6"},"Select a course"),t.length>0?c.a.createElement("div",{className:n.courses},t.map((function(e){return c.a.createElement("div",{key:e.slug,onClick:function(){a(e)},tabIndex:"0"},c.a.createElement(A.a,{variant:"body1"},c.a.createElement("b",null,e.name)," \xb7 Period ",e.period))}))):c.a.createElement(ie.a,{severity:"info"},"You must create a course before continuing"))})),ma=function(e){var t=e.course,a=e.onSelect,n=Object(o.useState)([]),r=Object(le.a)(n,2),l=r[0],s=r[1],i=t.students.map((function(e){return{username:e.username,firstName:e.firstName,lastName:e.lastName,fullName:"".concat(e.firstName," ").concat(e.lastName),role:e.role,_id:e._id}})),u=Object(o.useState)([{title:"Students",field:"fullName"}]),m=Object(le.a)(u,1)[0];return Object(o.useEffect)((function(){s(i)}),[t]),c.a.createElement(ve.a,{columns:m,data:l,localization:{body:{emptyDataSourceMessage:"No students found for this course"},toolbar:{nRowsSelected:"{0} student(s) selected"}},onSelectionChange:function(e){return a(e)},options:{paging:!1,selection:!0,toolbar:!0},title:"".concat(t.name," | Period ").concat(t.period)})},da=Object(y.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(he.a)({},e.breakpoints.up("lg"),{width:e.spacing(80)})}}})),pa=Object(r.c)((function(e){return Object(J.a)({},e.scores)}),(function(e){return{onAdd:function(t,a){return e({type:"ADD_TRANSACTIONS",payload:Ee.a.Transactions.addMany(t),curStudent:a,snackbar:{message:"".concat(t.typeTitle," added"),variant:"success"}})},onExit:function(){return e({type:"TRANSACTIONS_DIALOG_UNLOADED"})}}}))((function(e){var t=e.curStudent,a=e.errors,n=e.inProgress,r=e.isClosed,l=e.isOpen,s=e.onAdd,i=e.onExit,u=e.type,m=Object(o.useState)(!1),d=Object(le.a)(m,2),p=d[0],E=d[1],f=Object(o.useState)(null),b=Object(le.a)(f,2),g=b[0],h=b[1],O=Object(o.useState)([]),v=Object(le.a)(O,2),y=v[0],j=v[1],S=Object(Te.a)(),A=Object(Ne.a)(S.breakpoints.down("md")),C=da(),T=function(){E(!1),h(null),r()},N=function(e){s(Object(J.a)(Object(J.a)({},e),{},{students:y.map((function(e){return e._id})),type:"Bonuses"===u?"bonus":"purchase",typeTitle:u}),t)};return Object(o.useEffect)((function(){n||a||T()}),[n]),Object(o.useEffect)((function(){E(l)}),[l]),c.a.createElement(_e.a,{className:C.dialog,fullScreen:A,onClick:function(e){return e.stopPropagation()},onClose:T,onExit:i,onFocus:function(e){return e.stopPropagation()},open:p},c.a.createElement($.c,{initialValues:{amount:"",description:""},validationSchema:X.c({amount:X.b().typeError("Numbers only").required("Required"),description:X.d().required("Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement($.b,null,c.a.createElement(Pe.a,null,"Add ",u),c.a.createElement(Re.a,null,c.a.createElement(me,{errors:a}),!g&&c.a.createElement(ua,{onSelect:function(e){h(e)}}),g&&c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{autoFocus:!0,color:"primary",component:Z.c,disabled:n,label:"Description",name:"description",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:n,label:"Amount",name:"amount",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(ma,{course:g,onSelect:function(e){j(e)}})))),c.a.createElement(we.a,null,c.a.createElement(D.a,{disabled:n||0===y.length,color:"primary",type:"submit",variant:"contained"},n?"Adding...":"Add"),c.a.createElement(D.a,{disabled:n,onClick:T,variant:"contained"},"Cancel")))))})),Ea=a(132),fa=a(583),ba=a(450),ga=a(444),ha=a.n(ga),Oa=Object(y.a)((function(e){return{filedrop:{alignItems:"center",backgroundColor:e.palette.grey[300],borderRadius:e.spacing(1),color:e.palette.grey[600],display:"flex",flexDirection:"column",outline:"none",padding:"20px",transition:"all 0.25s ease-in-out"},filedropActive:{backgroundColor:e.palette.primary.light,color:e.palette.primary.contrastText},filedropReject:{backgroundColor:e.palette.secondary.light,color:e.palette.secondary.contrastText}}}));var va=function(e){var t=e.onFiledrop,a=Oa(),n=Object(o.useCallback)((function(e){e.forEach((function(e){var a=new FileReader;a.onabort=function(){return console.log("file reading was aborted")},a.onerror=function(){return console.log("file reading has failed")},a.onload=function(){var e=ha()(a.result,{columns:!0,skip_empty_lines:!0});t(e)},a.readAsBinaryString(e)}))}),[]),r=Object(ba.a)({accept:"text/csv, text/plain",multiple:!1,onDropAccepted:n}),l=r.getRootProps,s=r.getInputProps,i=r.isDragActive,u=r.isDragReject;return c.a.createElement("div",l({className:"".concat(a.filedrop," ").concat(i?a.filedropActive:""," ").concat(u?a.filedropReject:"")}),c.a.createElement("input",s()),!i&&c.a.createElement(A.a,null,"Drop a .csv file here or click to select a .csv file"),i&&!u&&c.a.createElement(A.a,null,"Drop .csv file here"),u&&c.a.createElement(A.a,null,"File type not accepted"))},ya=Object(y.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(he.a)({},e.breakpoints.up("lg"),{width:e.spacing(100)})}}})),ja=function(e){var t=e.onDataChange,a=e.onShowImport,n=Object(o.useState)(null),r=Object(le.a)(n,2),l=r[0],s=r[1],i=Object(o.useState)(null),u=Object(le.a)(i,2),m=u[0],d=u[1],p=Object(o.useState)(null),E=Object(le.a)(p,2),f=E[0],b=E[1],g=function(e){b(Object(J.a)(Object(J.a)({},f),{},Object(he.a)({},e.target.name,e.target.checked)))};return Object(o.useEffect)((function(){var e=!!f&&Object.values(f).some((function(e){return!0===e}));a(e)}),[f]),Object(o.useEffect)((function(){t({file:l,course:m,tasks:f})}),[l,m,f]),c.a.createElement(c.a.Fragment,null,!l&&!m&&!f&&c.a.createElement(ua,{onSelect:function(e){d(e)}}),!l&&m&&!f&&c.a.createElement("div",null,c.a.createElement(A.a,{gutterBottom:!0},"Scores must be imported from a .csv file exported from Infinite Campus"),c.a.createElement(va,{onFiledrop:function(e){var t={};Object.keys(e[0]).slice(1).forEach((function(e){t[e]=!1})),s(e),b(t)}})),l&&m&&f&&c.a.createElement(ne.a,{component:"fieldset"},c.a.createElement(A.a,{gutterBottom:!0,variant:"body1"},"Select the assignments to import"),c.a.createElement(fa.a,null,Object.keys(f).map((function(e){return c.a.createElement(St.a,{control:c.a.createElement(At.a,{checked:f[e],onChange:g,name:e}),key:e,label:e})})))))},Sa=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.settings),e.scores)}),(function(e){return{onImport:function(t,a){return e({type:"IMPORT_SCORES",payload:Ee.a.Scores.import(t),curStudent:a,snackbar:{message:"Scores imported",variant:"success"}})},onExit:function(){return e({type:"IMPORT_SCORES_DIALOG_UNLOADED"})}}}))((function(e){var t=e.curStudent,a=e.errors,n=e.inProgress,r=e.isClosed,l=e.isOpen,s=e.onExit,i=e.onImport,u=e.schoolDistrict,m=Object(o.useState)(!1),d=Object(le.a)(m,2),p=d[0],E=d[1],f=Object(o.useState)(!1),b=Object(le.a)(f,2),g=b[0],h=b[1],O=Object(o.useState)(null),v=Object(le.a)(O,2),y=v[0],j=v[1],S=Object(Te.a)(),C=Object(Ne.a)(S.breakpoints.down("md")),T=ya(),N=function(){E(!1),r()};return Object(o.useEffect)((function(){n||a||N()}),[n]),Object(o.useEffect)((function(){E(l)}),[l]),c.a.createElement(_e.a,{className:T.dialog,fullScreen:C,onClick:function(e){return e.stopPropagation()},onClose:N,onExit:s,onFocus:function(e){return e.stopPropagation()},open:p},c.a.createElement(Pe.a,null,"Import Scores"),"ccsd"===u?c.a.createElement(Re.a,null,c.a.createElement(me,{errors:a}),n?c.a.createElement(Vt,{message:"Importing..."}):c.a.createElement(ja,{onDataChange:function(e){j(e)},onShowImport:function(e){h(e)}})):c.a.createElement(Re.a,null,c.a.createElement(A.a,null,"Please email a copy of your gradebook export file to Dr. May so he can setup a parser in the app")),c.a.createElement(we.a,null,c.a.createElement(D.a,{color:"primary",disabled:!g||n,onClick:function(){var e=y.file.map((function(e,t){return t>1&&e["Assignment Name"].split("#").pop()})).filter((function(e){return!1!==e})),a={course:y.course,tasks:[]};for(var n in y.tasks){if(y.tasks[n]){var r,o={title:n,totalPoints:y.file[1][n],scores:{}},c=Object(Ea.a)(e);try{var l=function(){var e=r.value,t=y.file.find((function(t){return t["Assignment Name"].endsWith(e)}));t&&(o.scores[e]=t[n])};for(c.s();!(r=c.n()).done;)l()}catch(s){c.e(s)}finally{c.f()}a.tasks.push(o)}}i(a,t)},variant:"contained"},n?"Importing...":"Import"),c.a.createElement(D.a,{disabled:n,onClick:N,variant:"contained"},"Cancel")))})),Aa=Object(y.a)((function(e){return{icon:{marginRight:e.spacing(1)}}})),Da=function(e){var t=e.curStudent,a=Object(o.useState)(null),n=Object(le.a)(a,2),r=n[0],l=n[1],s=Object(o.useState)(null),i=Object(le.a)(s,2),u=i[0],m=i[1],d=Aa(),p=function(e){m(e.currentTarget.dataset.type),l(null)},E=function(){m(null)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(ee.a,{color:"primary",onClick:function(e){l(e.currentTarget)},variant:"extended"},c.a.createElement(qt.a,{className:d.icon}),"Update Accounts"),c.a.createElement(oa.a,{anchorEl:r,open:Boolean(r),onClose:function(){l(null)}},c.a.createElement(oe.a,{"data-type":"scores",onClick:p},c.a.createElement(ca.a,null,c.a.createElement(sa.a,null)),c.a.createElement(la.a,null,"Import scores")),c.a.createElement(oe.a,{"data-type":"bonuses",onClick:p},c.a.createElement(ca.a,null,c.a.createElement(ft.a,null)),c.a.createElement(la.a,null,"Add Bonuses")),c.a.createElement(oe.a,{"data-type":"purchases",onClick:p},c.a.createElement(ca.a,null,c.a.createElement(Ft.a,null)),c.a.createElement(la.a,null,"Add Purchases"))),c.a.createElement(Sa,{curStudent:t,isClosed:E,isOpen:"scores"===u}),c.a.createElement(pa,{curStudent:t,isClosed:E,isOpen:"bonuses"===u,type:"Bonuses"}),c.a.createElement(pa,{curStudent:t,isClosed:E,isOpen:"purchases"===u,type:"Purchases"}))},Ca=Object(r.c)((function(e){return{importSummary:e.scores.importSummary}}),(function(e){return{onUnload:function(){return e({type:"ACCOUNTS_PAGE_UNLOADED"})}}}))((function(e){var t=e.importSummary,a=e.onUnload,n=Object(o.useState)(null),r=Object(le.a)(n,2),l=r[0],s=r[1],i=function(e,t){return"".concat(e," ").concat(t).concat(1!==e?"s":"")};return Object(o.useEffect)((function(){return function(){a()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Manage Accounts"},c.a.createElement(aa,null),c.a.createElement(Da,{curStudent:l})),t&&c.a.createElement(kt,null,"Created ",i(t.tasksCreated,"assignment"),", imported"," ",i(t.scoresImported,"score"),", and updated"," ",i(t.scoresUpdated,"score")),c.a.createElement(ae.a,{container:!0,spacing:4},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(ra,{onChange:function(e){s(e)}})),c.a.createElement(ae.a,{item:!0,xs:12},l&&c.a.createElement(yt,{student:l}))))})),Ta=Object(y.a)((function(e){return{icon:{marginRight:e.spacing(1)}}})),Na=Object(r.c)((function(e){return Object(J.a)({},e.courses)}),(function(e){return{onAdd:function(t){return e({type:"ADD_COURSE",payload:Ee.a.Courses.add(t),snackbar:{message:"Course added",variant:"success"}})},onExit:function(){return e({type:"COURSE_DIALOG_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_COURSE",payload:Ee.a.Courses.update(t),snackbar:{message:"Course updated",variant:"success"}})}}}))((function(e){var t=e.course,a=e.errors,n=e.inProgress,r=e.onAdd,l=e.onExit,s=e.onUpdate,i=Object(o.useState)(!1),u=Object(le.a)(i,2),m=u[0],d=u[1],p=Object(Te.a)(),E=Object(Ne.a)(p.breakpoints.down("md")),f=Ta(),b=function(){d(!0)},g=function(){d(!1)},h=function(e){r(Object(J.a)({},e))},O=function(e){s(Object(J.a)(Object(J.a)({},t),e))};return Object(o.useEffect)((function(){n||a||d(!1)}),[n]),c.a.createElement(c.a.Fragment,null,t?c.a.createElement(Ce,{action:"Edit course",onClick:b},c.a.createElement(je.a,null)):c.a.createElement(ee.a,{color:"primary",onClick:b,variant:"extended"},c.a.createElement(Je.a,{className:f.icon}),"Create course"),c.a.createElement(_e.a,{fullScreen:E,onClick:function(e){return e.stopPropagation()},onClose:g,onExit:l,onFocus:function(e){return e.stopPropagation()},open:m},c.a.createElement($.c,{initialValues:{name:(null===t||void 0===t?void 0:t.name)||"",period:(null===t||void 0===t?void 0:t.period)||""},validationSchema:X.c({name:X.d().required("Required"),period:X.b().typeError("Numbers only").required("Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(a){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?O(a):h(a);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement($.b,null,c.a.createElement(Pe.a,null,t?"Edit Course":"Create Course"),c.a.createElement(Re.a,null,c.a.createElement(me,{errors:a}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{autoFocus:!t,color:"primary",component:Z.c,disabled:n,label:"Course Name",name:"name",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:n,label:"Period",name:"period",type:"text",fullWidth:!0})))),c.a.createElement(we.a,null,c.a.createElement(D.a,{disabled:n,color:"primary",type:"submit",variant:"contained"},t?n?"Updating...":"Update":n?"Adding...":"Add"),c.a.createElement(D.a,{disabled:n,onClick:g,variant:"contained"},"Cancel"))))))})),_a=a(669),Pa=a(628),Ra=a(627),wa=a(658),Ua=Object(r.c)((function(){return{}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_STUDENT",payload:Ee.a.Students.delete(t),snackbar:{message:"Student deleted",variant:"success"}})}}}))((function(e){e.course;var t=e.onDelete,a=e.student,n=Object(o.useState)(!1),r=Object(le.a)(n,2),l=r[0],s=r[1],i=function(){s(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Delete student",onClick:function(){s(!0)},size:"small"},c.a.createElement(Qe.a,{fontSize:"inherit"})),c.a.createElement(_e.a,{open:l,onClose:i,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Delete Student"),c.a.createElement(Re.a,null,c.a.createElement(dt.a,{component:"div"},"Are you sure you want to delete"," ",c.a.createElement("b",null,a.firstName," ",a.lastName),"? This action will permanently delete:",c.a.createElement("ul",null,c.a.createElement("li",null,"the student's account, and"),c.a.createElement("li",null,"all song requests"),c.a.createElement("li",null,"all transactions"),c.a.createElement("li",null,"all purchases"),c.a.createElement("li",null,"all scores")),"associated with this student. This action ",c.a.createElement("b",null,"cannot be undone"),".")),c.a.createElement(we.a,null,c.a.createElement(D.a,{onClick:function(){s(!1),t(a)},color:"secondary",variant:"contained",autoFocus:!0},"Delete"),c.a.createElement(D.a,{onClick:i,variant:"contained"},"Cancel"))))})),ka=a(656),xa=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.settings),e.courses)}),(function(e){return{onAdd:function(t,a){return e({type:"ADD_STUDENT",payload:Ee.a.Students.add(t,a),courseId:a,snackbar:{message:"Student added",variant:"success"}})},onExit:function(){return e({type:"STUDENT_DIALOG_UNLOADED"})},onUpdate:function(t,a){return e({type:"UPDATE_STUDENT",payload:Ee.a.Students.update(t),courseId:a,snackbar:{message:"Student updated",variant:"success"}})}}}))((function(e){var t=e.course,a=e.defaultStudentPassword,n=e.errors,r=e.inProgress,l=e.onAdd,s=e.onExit,i=e.onUpdate,u=e.student,m=Object(o.useState)(!1),d=Object(le.a)(m,2),p=d[0],E=d[1],f=Object(Te.a)(),b=Object(Ne.a)(f.breakpoints.down("md")),g=function(){E(!0)},h=function(){E(!1)},O=function(e){var a=Object(J.a)({},e),n=t._id;a.role="student",l(a,n)},v=function(e){var a=Object(J.a)(Object(J.a)({},u),e),n=t._id;i(a,n)};return Object(o.useEffect)((function(){r||n||E(!1)}),[r]),c.a.createElement(c.a.Fragment,null,u?c.a.createElement(Ce,{action:"Edit student",onClick:g,size:"small"},c.a.createElement(je.a,{fontSize:"inherit"})):c.a.createElement(Ce,{action:"Add student",onClick:g},c.a.createElement(ka.a,null)),c.a.createElement(_e.a,{fullScreen:b,onClick:function(e){return e.stopPropagation()},onClose:h,onExit:s,onFocus:function(e){return e.stopPropagation()},open:p},c.a.createElement($.c,{initialValues:{firstName:(null===u||void 0===u?void 0:u.firstName)||"",lastName:(null===u||void 0===u?void 0:u.lastName)||"",username:(null===u||void 0===u?void 0:u.username)||"",password:u?"":a},validationSchema:X.c({firstName:X.d().required("Required"),lastName:X.d().required("Required"),username:X.b().typeError("Numbers only").required("Required"),password:X.d().required(u?"":"Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u?v(t):O(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement($.b,null,c.a.createElement(Pe.a,null,u?"Edit Student":"Add Student"),c.a.createElement(Re.a,null,c.a.createElement(me,{errors:n}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{autoFocus:!u,color:"primary",component:Z.c,disabled:r,label:"First Name",name:"firstName",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Last Name",name:"lastName",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:!!u||r,label:"Student Number",name:"username",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Password",name:"password",type:"text",fullWidth:!0})))),c.a.createElement(we.a,null,c.a.createElement(D.a,{color:"primary",disabled:r,type:"submit",variant:"contained"},u?r?"Updating...":"Update":r?"Adding...":"Add"),c.a.createElement(D.a,{disabled:r,onClick:h,variant:"contained"},"Cancel"))))))})),La=a(657),Ia=Object(r.c)((function(e){return Object(J.a)({},e.courses)}),(function(e){return{onSubmit:function(t,a){return e({type:"MOVE_STUDENT",payload:Promise.all([Ee.a.Courses.unenroll(t),Ee.a.Courses.enroll(a)]),snackbar:{message:"Student moved",variant:"success"}})}}}))((function(e){var t=e.course,a=e.courses,n=e.errors,r=e.inProgress,l=e.onSubmit,s=e.student,i=Object(o.useState)(!1),u=Object(le.a)(i,2),m=u[0],d=u[1],p=function(){d(!1)},E=function(e){if(t.slug!==e.course){var a={usernames:[s.username],slug:t.slug},n={usernames:[s.username],slug:e.course};l(a,n)}};return Object(o.useEffect)((function(){r||n||d(!1)}),[r]),c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Move student",onClick:function(){d(!0)},size:"small"},c.a.createElement(La.a,{fontSize:"inherit"})),c.a.createElement(_e.a,{open:m,onClose:p,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement($.c,{initialValues:{course:t.slug||""},validationSchema:X.c({course:X.d().required("Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},(function(e){return c.a.createElement($.b,null,c.a.createElement(Pe.a,null,"Move Student"),c.a.createElement(Re.a,null,c.a.createElement(me,{errors:n}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,ds:12},"Move"," ",c.a.createElement("b",null,s.firstName," ",s.lastName)," ","to..."),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,id:"course",label:"Course",name:"course",type:"select",select:!0,fullWidth:!0},a.map((function(e){return c.a.createElement(oe.a,{key:e.slug,value:e.slug},"Period ".concat(e.period," | ").concat(e.name))})))))),c.a.createElement(we.a,null,c.a.createElement(D.a,{color:"primary",disabled:r||e.values.course===t.slug,type:"submit",variant:"contained"},r?"Moving...":"Move"),c.a.createElement(D.a,{onClick:p,variant:"contained"},"Cancel")))}))))})),qa=Object(y.a)((function(e){return{row:{alignItems:"center",borderBottom:"solid 2px white",display:"flex",height:e.spacing(5),justifyContent:"space-between",padding:e.spacing(1),"&:hover":{borderBottomColor:e.palette.secondary.main}},rowHeader:{alignItems:"center",display:"flex"},studentUsername:{marginRight:e.spacing(2),minWidth:e.spacing(12)}}})),Fa=function(e){var t=e.course,a=e.student,n=qa();return c.a.createElement("div",{className:n.row},c.a.createElement("div",{className:n.rowHeader},c.a.createElement(Wt.a,{color:"primary",label:a.username,className:n.studentUsername}),c.a.createElement(A.a,null,a.lastName,", ",a.firstName)),c.a.createElement("div",null,c.a.createElement(Et,{student:a}),c.a.createElement(Ia,{course:t,student:a}),c.a.createElement(xa,{course:t,student:a}),c.a.createElement(Ua,{course:t,student:a})))},Ga=function(e){var t=e.course;return c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{variant:"h6"},"Students")," ",t.students&&t.students.length>0?t.students.map((function(e){return c.a.createElement(Fa,{key:e._id,course:t,student:e})})):c.a.createElement("div",null,c.a.createElement(A.a,null,"No students have been added to this course")))},Ba=Object(r.c)((function(){return{}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_COURSE",payload:Ee.a.Courses.delete(t),snackbar:{message:"Course deleted",variant:"success"}})}}}))((function(e){var t=e.course,a=e.onDelete,n=Object(o.useState)(!1),r=Object(le.a)(n,2),l=r[0],s=r[1],i=function(){s(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Delete course",onClick:function(){s(!0)}},c.a.createElement(Qe.a,null)),c.a.createElement(_e.a,{open:l,onClose:i,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Delete Course"),c.a.createElement(Re.a,null,c.a.createElement(dt.a,{component:"div"},"Are you sure you want to delete"," ",c.a.createElement("b",null,t.name," Period ",t.period),"? This action will permanently delete:",c.a.createElement("ul",null,c.a.createElement("li",null,"all student accounts"),c.a.createElement("li",null,"all song requests"),c.a.createElement("li",null,"all transactions"),c.a.createElement("li",null,"all purchases"),c.a.createElement("li",null,"all scores")),"associated with this course. This action ",c.a.createElement("b",null,"cannot be undone"),".")),c.a.createElement(we.a,null,c.a.createElement(D.a,{onClick:function(){s(!1),a(t.slug)},color:"secondary",variant:"contained",autoFocus:!0},"Delete"),c.a.createElement(D.a,{onClick:i,variant:"contained"},"Cancel"))))})),Wa=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.settings),e.courses)}),(function(e){return{onDrop:function(t,a){return e({type:"IMPORT_STUDENTS",payload:Ee.a.Students.import(t,a),snackbar:{message:"Students imported",variant:"success"}})},onExit:function(){return e({type:"STUDENT_DIALOG_UNLOADED"})}}}))((function(e){var t=e.course,a=e.defaultStudentPassword,n=e.errors,r=e.inProgress,l=e.onDrop,s=e.onExit,i=e.schoolDistrict,u=Object(o.useState)(!1),m=Object(le.a)(u,2),d=m[0],p=m[1],E=Object(Te.a)(),f=Object(Ne.a)(E.breakpoints.down("md")),b=function(){p(!1)};return Object(o.useEffect)((function(){r||n||p(!1)}),[r]),c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Import students",onClick:function(){p(!0)}},c.a.createElement(sa.a,null)),c.a.createElement(_e.a,{fullScreen:f,onClick:function(e){return e.stopPropagation()},onClose:b,onExit:s,onFocus:function(e){return e.stopPropagation()},open:d},c.a.createElement(Pe.a,null,"Import Students"),"ccsd"===i?c.a.createElement(Re.a,null,r?c.a.createElement(Vt,{message:"Importing..."}):c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{gutterBottom:!0},"Students can be imported from a .csv file exported from Infinite Campus"),c.a.createElement(va,{onFiledrop:function(e){var n=Object.keys(e[0]),r=e.map((function(e,t){if(t<2)return null;var r=e[n[0]];return{firstName:r.split(",")[1].split(/(\s\w)*\s#/)[0].trim(),lastName:r.split(",")[0],username:r.split("#")[1],password:a,role:"student"}})).filter((function(e){return null!==e}));l(r,t._id)}}))):c.a.createElement(Re.a,null,c.a.createElement(A.a,null,"Please email a copy of your gradebook export file to Dr. May so he can setup a parser in the app")),c.a.createElement(we.a,null,c.a.createElement(D.a,{disabled:r,onClick:b,variant:"contained"},"Cancel"))))})),Ha=Object(r.c)((function(e){return{tasks:e.tasks.tasks}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_TASK",payload:Ee.a.Tasks.delete(t),snackbar:{message:"Assignment removed",variant:"success"}})},onLoad:function(t){return e({type:"TASKS_DIALOG_LOADED",payload:Ee.a.Tasks.getAll(t)})},onUpdate:function(t){return e({type:"UPDATE_TASK",payload:Ee.a.Tasks.update(t),snackbar:{message:"Assignment updated",variant:"success"}})}}}))((function(e){var t=e.course,a=e.onDelete,n=e.onLoad,r=e.onUpdate,l=e.tasks,s=Object(o.useState)([]),i=Object(le.a)(s,2),u=i[0],m=i[1],d=l.map((function(e){return{createdAt:new Date(e.createdAt).toDateString(),multiplier:e.multiplier,title:e.title,totalPoints:e.totalPoints,slug:e.slug}})),p=Object(o.useState)([{title:"Date",field:"createdAt",editable:"never"},{title:"Title",field:"title",editable:"never"},{title:"Total Points",field:"totalPoints"},{title:"Multiplier",field:"multiplier"}]),E=Object(le.a)(p,1)[0];return Object(o.useEffect)((function(){n(t._id)}),[]),Object(o.useEffect)((function(){m(d)}),[l]),c.a.createElement(ve.a,{columns:E,data:u,localization:{body:{emptyDataSourceMessage:"No assignments found for this course",editRow:{deleteText:"Delete assignment? This will delete all scores for this assignment.",saveTooltip:"Delete assignment"}}},options:{actionsColumnIndex:-1,paging:!1,toolbar:!1},editable:{onRowUpdate:function(e,t){return new Promise((function(a,n){var o=Object(ge.a)(u);o[t.tableData.id]=e,m(Object(ge.a)(o)),r(e),a()}))},onRowDelete:function(e){return new Promise((function(t,n){var r=Object(ge.a)(u),o=e.tableData.id;r.splice(o,1),m(Object(ge.a)(r)),a(e),t()}))}}})})),Ma=Object(y.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(he.a)({},e.breakpoints.up("lg"),{minHeight:e.spacing(54),width:e.spacing(100)})}}})),za=Object(r.c)((function(e){return Object(J.a)({},e.tasks)}),(function(e){return{onExit:function(){return e({type:"TASKS_DIALOG_UNLOADED"})}}}))((function(e){var t=e.course,a=e.errors,n=e.inProgress,r=e.onExit,l=Object(o.useState)(!1),s=Object(le.a)(l,2),i=s[0],u=s[1],m=Object(Te.a)(),d=Object(Ne.a)(m.breakpoints.down("md")),p=Ma(),E=function(){u(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Manage assignments",onClick:function(){u(!0)}},c.a.createElement(It.a,null)),c.a.createElement(_e.a,{className:p.dialog,fullScreen:d,onClick:function(e){return e.stopPropagation()},onClose:E,onExit:r,onFocus:function(e){return e.stopPropagation()},open:i},c.a.createElement(Pe.a,null,"Manage Assignments"),c.a.createElement(Re.a,null,c.a.createElement(me,{errors:a}),c.a.createElement(Ha,{course:t})),c.a.createElement(we.a,null,c.a.createElement(D.a,{disabled:n,onClick:E,variant:"contained"},"Close"))))})),Va=Object(y.a)((function(e){return{courseDetails:{display:"block"},courseHeader:{alignItems:"center",display:"flex",justifyContent:"space-between",width:"100%"},coursePeriod:{backgroundColor:e.palette.secondary.main,marginRight:e.spacing(2)},courseTitle:{flexGrow:"1"}}})),Ya=function(e){var t=e.courses,a=Object(o.useState)(!1),n=Object(le.a)(a,2),r=n[0],l=n[1],s=Va();return c.a.createElement(c.a.Fragment,null,(null===t||void 0===t?void 0:t.length)>0?t.map((function(e){return c.a.createElement(_a.a,{expanded:r===e._id,key:e._id,onChange:(t=e._id,function(e,a){l(!!a&&t)})},c.a.createElement(Pa.a,{expandIcon:c.a.createElement(wa.a,null)},c.a.createElement("div",{className:s.courseHeader},c.a.createElement(Kt.a,{className:s.coursePeriod},e.period),c.a.createElement(A.a,{className:s.courseTitle,variant:"h5"},e.name),c.a.createElement(za,{course:e}),c.a.createElement(xa,{course:e}),c.a.createElement(Wa,{course:e}),c.a.createElement(Na,{course:e}),c.a.createElement(Ba,{course:e}))),c.a.createElement(Ra.a,{className:s.courseDetails},c.a.createElement(Ga,{course:e})));var t})):c.a.createElement(A.a,null,"You have no courses"))},Qa=Object(r.c)((function(e){return Object(J.a)({},e.courses)}),(function(e){return{onLoad:function(){return e({type:"COURSES_PAGE_LOADED",payload:Ee.a.Courses.getAll()})},onUnload:function(){return e({type:"COURSES_PAGE_UNLOADED"})}}}))((function(e){var t=e.courses,a=e.importCount,n=e.importFailed,r=e.onLoad,l=e.onUnload,s=e.pageLoaded;return Object(o.useEffect)((function(){return r(),function(){l()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Manage Courses"},c.a.createElement(Na,null)),null!==a&&c.a.createElement(kt,null,a," students imported",c.a.createElement("br",null),n>0&&"".concat(n," students not imported (already have accounts)")),s?c.a.createElement(Vt,{message:"Loading..."}):c.a.createElement(Ya,{courses:t}))})),Ka=a(621),Ja=a(324),$a=a(666),Za=a(659),Xa=a(660),en=a(661),tn=a(620),an=Object(y.a)((function(e){return{badge:{left:"-6%",top:"-30%"}}})),nn=function(e){var t=e.children,a=e.value,n=an();return c.a.createElement(tn.a,{anchorOrigin:{horizontal:"left",vertical:"top"},badgeContent:a,classes:{badge:n.badge},color:"secondary",overlap:"circle"},t)},rn=Object(y.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(he.a)({},e.breakpoints.up("lg"),{minHeight:e.spacing(54),width:e.spacing(100)})},icon:{marginRight:e.spacing(1)},panel:{minWidth:e.spacing(40),maxWidth:e.spacing(60)},removalAlert:{backgroundColor:e.palette.error.light,border:"2px solid ".concat(e.palette.error.dark),borderRadius:e.spacing(2),color:e.palette.common.white,fontSize:e.typography.h6.fontSize,padding:e.spacing(1),textAlign:"center",textTransform:"uppercase"},selected:{backgroundColor:e.palette.primary.main},songInfo:{marginBottom:e.spacing(4)},statusButton:{"&:hover":{backgroundColor:e.palette.primary.light}},statusDescription:{backgroundColor:e.palette.grey[100],borderRadius:e.spacing(1),marginTop:e.spacing(2),padding:e.spacing(2)},studentInfo:Object(he.a)({alignItems:"center",display:"flex",justifyContent:"space-between",marginTop:e.spacing(4)},e.breakpoints.up("md"),{borderTopColor:e.palette.primary.main,borderTopStyle:"dotted",borderTopWidth:"4px",paddingTop:e.spacing(2)}),studentName:{alignItems:"center",display:"flex","& > div":{marginRight:e.spacing(1)}}}})),on=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.songs),{},{songRemovalPurchaseAmount:e.common.settings.songRemovalPurchaseAmount,songRemovalRefundAmount:e.common.settings.songRemovalRefundAmount,songRequestPurchaseAmount:e.common.settings.songRequestPurchaseAmount})}),(function(e){return{onExit:function(){return e({type:"SONG_REQUESTS_DIALOG_UNLOADED"})},onSubmit:function(t){return e({type:"UPDATE_SONG_REQUEST",payload:Ee.a.Songs.update(t)})}}}))((function(e){var t,a,n=e.courses,r=e.errors,l=e.inProgress,s=e.onExit,i=e.onSubmit,u=e.songRemovalPurchaseAmount,m=e.songRemovalRefundAmount,d=e.songRequestPurchaseAmount,p=Object(o.useState)(0),E=Object(le.a)(p,2),f=E[0],b=E[1],g=Object(o.useState)(!1),h=Object(le.a)(g,2),O=h[0],v=h[1],y=Object(o.useState)(null),j=Object(le.a)(y,2),S=j[0],C=j[1],T=Object(o.useState)(null),N=Object(le.a)(T,2),_=N[0],P=N[1],R=Object(o.useState)(null),w=Object(le.a)(R,2),U=w[0],k=w[1],x=Object(o.useState)([]),L=Object(le.a)(x,2),I=L[0],q=L[1],F=Object(o.useState)(0),G=Object(le.a)(F,2),B=G[0],W=G[1],H=Object(Te.a)(),M=Object(Ne.a)(H.breakpoints.down("md")),z=rn(),V=function(){var e=0;if(n.length>0){var t,a=Object(Ea.a)(n);try{for(a.s();!(t=a.n()).done;){e+=t.value.songs.filter((function(e){return e.status.startsWith("pending")})).length}}catch(r){a.e(r)}finally{a.f()}}return e},Y=function(){if(C(null),n.length>0){var e,t=Object(Ea.a)(n);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(a.songs.length>0){var r=a.songs.find((function(e){return e.status.startsWith("pending")&&!I.includes(e._id)}));if(r){r.period=a.period,C(r),b(f+1);break}}}}catch(o){t.e(o)}finally{t.f()}}},J=function(){b(0),v(!1),P(null),k(null),q([])},$=function(e){P(e)},Z=function(e){k(e.target.value)},X=function(){var e=Object(K.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i({amount:d,id:S._id,status:_,statusDescription:U}),P(null),k(null);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(K.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i({id:S._id,purchaseAmount:u,refundAmount:m,status:"removed",statusDescription:"".concat(S.removedBy.firstName," ").concat(S.removedBy.lastName," paid to remove this song")});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){W(V())})),Object(o.useEffect)((function(){Y()}),[n]),Object(o.useEffect)((function(){Y()}),[I]),c.a.createElement(c.a.Fragment,null,c.a.createElement(ee.a,{color:"primary",onClick:function(){v(!0),W(V())},variant:"extended"},c.a.createElement(nn,{value:B},c.a.createElement(Za.a,{className:z.icon}),"Process requests")),c.a.createElement(_e.a,{className:z.dialog,fullScreen:M,onClick:function(e){return e.stopPropagation()},onClose:J,onExit:s,onFocus:function(e){return e.stopPropagation()},open:O},c.a.createElement(Pe.a,null,"Process Song Requests"),c.a.createElement(Re.a,null,c.a.createElement(me,{errors:r}),S?"pending removal"!==S.status?c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("div",{className:z.panel},c.a.createElement("div",{className:z.songInfo},c.a.createElement(A.a,{variant:"h6"},S.title),c.a.createElement(A.a,{color:"textSecondary",variant:"body1",gutterBottom:!0},"Song"),c.a.createElement(A.a,{variant:"h6"},S.artist),c.a.createElement(A.a,{color:"textSecondary",variant:"body1"},"Artist")),c.a.createElement(Ka.a,null,c.a.createElement(D.a,{href:(t=S.artist,a=S.title,"http://www.google.com/search?q=".concat(encodeURIComponent("lyrics: ".concat(a," by ").concat(t)))),target:"_blank"},"Search Lyrics"),c.a.createElement(D.a,{href:function(e,t){return"https://open.spotify.com/search/".concat(encodeURIComponent("".concat(t," ").concat(e)))}(S.artist,S.title),target:"_blank"},"Search Spotify")),c.a.createElement("div",{className:z.studentInfo},c.a.createElement("div",{className:z.studentName},c.a.createElement(Wt.a,{color:"secondary",label:S.period}),c.a.createElement(A.a,null,S.student.firstName," ",S.student.lastName)),c.a.createElement(Ie,{cost:d,count:f,username:S.student.username})))),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("div",{className:z.panel},c.a.createElement(A.a,{variant:"h6"},"Status"),c.a.createElement(Ka.a,{fullWidth:!0,size:"large"},c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,title:"Approve"},c.a.createElement(D.a,{className:"".concat(z.statusButton," ").concat("approved"===_&&z.selected),onClick:function(){return $("approved")}},c.a.createElement(Xa.a,null))),c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,title:"Reject"},c.a.createElement(D.a,{className:"".concat(z.statusButton," ").concat("rejected"===_&&z.selected),onClick:function(){return $("rejected")}},c.a.createElement(en.a,null)))),"approved"===_&&c.a.createElement("div",{className:z.statusDescription},c.a.createElement(A.a,{gutterBottom:!0},c.a.createElement("strong",null,"Condition for Approval")," (optional)"),c.a.createElement(ne.a,{component:"fieldset"},c.a.createElement(Ja.a,{name:"statusDescription",value:U,onChange:Z},c.a.createElement(St.a,{value:"Clean version",control:c.a.createElement($a.a,null),label:"Clean version"}),c.a.createElement(St.a,{value:"Instrumental version",control:c.a.createElement($a.a,null),label:"Instrumental version"}),c.a.createElement(St.a,{value:"Picked my best guess",control:c.a.createElement($a.a,null),label:"Picked my best guess"})))),"rejected"===_&&c.a.createElement("div",{className:z.statusDescription},c.a.createElement(A.a,{gutterBottom:!0},c.a.createElement("strong",null,"Reason for Rejection")," (optional)"),c.a.createElement(ne.a,{component:"fieldset"},c.a.createElement(Ja.a,{name:"statusDescription",value:U,onChange:Z},c.a.createElement(St.a,{value:"Inappropriate content (language, drugs, sex, and/or violence)",control:c.a.createElement($a.a,null),label:"Inappropriate content (language, drugs, sex, and/or violence)"}),c.a.createElement(St.a,{value:"Not available on Spotify",control:c.a.createElement($a.a,null),label:"Not available on Spotify"}),c.a.createElement(St.a,{value:"other",control:c.a.createElement($a.a,null),label:"Other"}))))))):c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement("div",{className:z.panel},c.a.createElement("div",{className:z.songInfo},c.a.createElement(A.a,{variant:"h6"},S.title),c.a.createElement(A.a,{color:"textSecondary",variant:"body1",gutterBottom:!0},"Song"),c.a.createElement(A.a,{variant:"h6"},S.artist),c.a.createElement(A.a,{color:"textSecondary",variant:"body1"},"Artist")),c.a.createElement("div",{className:z.removalAlert},"Removal Requested by"," ","".concat(S.removedBy.firstName," ").concat(S.removedBy.lastName)),c.a.createElement("div",{className:z.studentInfo},c.a.createElement("div",{className:z.studentName},c.a.createElement(Wt.a,{color:"secondary",label:S.period}),c.a.createElement(A.a,null,S.student.firstName," ",S.student.lastName)),c.a.createElement(Ie,{cost:u,count:f,username:S.removedBy.username}))))):c.a.createElement(ie.a,{severity:"info"},c.a.createElement(it.a,null,"All caught up!"),"There are no songs to process at this time")),c.a.createElement(we.a,null,S&&c.a.createElement(A.a,{style:{marginRight:"auto"},variant:"subtitle2"},"Song ".concat(f," of ").concat(B)),S&&("pending removal"!==S.status?c.a.createElement(D.a,{color:"primary",disabled:l||!_,onClick:X,variant:"contained"},l?"Saving...":"Save & Continue"):c.a.createElement(D.a,{color:"secondary",disabled:l,onClick:te,variant:"contained"},l?"Removing...":"Remove & Continue")),S&&c.a.createElement(D.a,{disabled:l,onClick:function(){q([].concat(Object(ge.a)(I),[S._id]))},variant:"contained"},"Skip"),c.a.createElement(D.a,{disabled:l,onClick:J,variant:"contained"},S?"Cancel":"Close"))))})),cn=Object(r.c)((function(e){return Object(J.a)({},e.songs)}),(function(e){return{onDelete:function(t){return e({type:"DELETE_SONG_REQUEST",payload:Ee.a.Songs.delete(t),snackbar:{message:"Song request removed",variant:"success"}})},onLoad:function(){return e({type:"TEACHER_SONGS_PAGE_LOADED",payload:Ee.a.Songs.forTeacher()})},onUnload:function(){return e({type:"SONGS_PAGE_UNLOADED"})}}}))((function(e){var t=e.courses,a=e.onDelete,n=e.onLoad,r=e.onUnload,l=Object(o.useState)([]),s=Object(le.a)(l,2),i=s[0],u=s[1],m=t.map((function(e){return e.songs.map((function(t){return{createdAt:new Date(t.createdAt).toDateString(),title:t.title,artist:t.artist,purchasedBy:"".concat(t.student.firstName," ").concat(t.student.lastName),period:e.period,status:t.status,statusDescription:t.statusDescription,_id:t._id}}))})).flat(),d=Object(o.useState)([{title:"Request Date",field:"createdAt",editable:"never"},{title:"Song Title",field:"title"},{title:"Song Artist",field:"artist"},{title:"Purchased by",field:"purchasedBy",editable:"never"},{title:"Period",field:"period",editable:"never",render:function(e,t){return"row"===t?c.a.createElement(Wt.a,{label:e.period,color:"secondary"}):c.a.createElement(Wt.a,{label:e,color:"secondary"})}},{title:"Status",field:"status",lookup:{approved:"approved",pending:"pending","pending approval":"pending approval","pending removal":"pending removal",rejected:"rejected",removed:"removed"},render:function(e,t){return"row"===t?c.a.createElement("span",{style:{alignItems:"center",display:"flex"}},e.statusDescription?c.a.createElement(c.a.Fragment,null,e.status,c.a.createElement(Se.a,{arrow:!0,color:"primary",enterTouchDelay:0,title:e.statusDescription},c.a.createElement(Dt.a,{style:{marginLeft:"8px"}}))):e.status):c.a.createElement("span",null,e)}}]),p=Object(le.a)(d,1)[0];return Object(o.useEffect)((function(){return n(),function(){return r()}}),[]),Object(o.useEffect)((function(){u(m)}),[t]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Manage Song Requests"},c.a.createElement(on,null)),c.a.createElement(ve.a,{title:"Song Requests",columns:p,data:i,localization:{body:{emptyDataSourceMessage:"No song requests have been submitted",editRow:{deleteText:"Delete song request?",saveTooltip:"Delete song"}}},options:{actionsColumnIndex:-1,paging:!1,grouping:!0},editable:{onRowDelete:function(e){return new Promise((function(t,n){var r=Object(ge.a)(i),o=e.tableData.id;r.splice(o,1),u(Object(ge.a)(r)),a(e._id),t()}))}}}))})),ln=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.settings),e.purchases)}),(function(e){return{onDelete:function(t){return e({type:"DELETE_PURCHASE",payload:Ee.a.Purchases.delete(t),snackbar:{message:"Purchase removed",variant:"success"}})}}}))((function(e){var t=e.courses,a=e.onDelete,n=e.taxRate,r=Object(o.useState)([]),l=Object(le.a)(r,2),s=l[0],i=l[1],u=t.map((function(e){return e.purchases.map((function(t){return{createdAt:new Date(t.createdAt).toDateString(),note:t.note,period:e.period,products:t.products,purchasedBy:"".concat(t.student.firstName," ").concat(t.student.lastName),quantities:t.quantities,status:t.status,totalCost:t.products.reduce((function(e,a){return e+a.cost*t.quantities[a._id]*(n/100+1)}),0),totalItems:Object.values(t.quantities).reduce((function(e,t){return e+t}),0),_id:t._id}}))})).flat(),m=Object(o.useState)([{title:"Purchase Date",field:"createdAt",editable:"never"},{title:"Total Items",field:"totalItems"},{title:"Total Cost",field:"totalCost",render:function(e,t){return"row"===t?c.a.createElement(xe,{value:e.totalCost}):c.a.createElement(xe,{value:e})}},{title:"Purchased by",field:"purchasedBy"},{title:"Period",field:"period",editable:"never",render:function(e,t){return"row"===t?c.a.createElement(Wt.a,{label:e.period,color:"secondary"}):c.a.createElement(Wt.a,{label:e,color:"secondary"})}},{title:"Notes",field:"note"},{title:"Status",field:"status"}]),d=Object(le.a)(m,1)[0];return Object(o.useEffect)((function(){i(u)}),[t]),c.a.createElement(ve.a,{title:"Purchases",columns:d,data:s,localization:{body:{emptyDataSourceMessage:"No purchases have been made",editRow:{deleteText:"Delete purchase?",saveTooltip:"Delete purchase"}}},options:{actionsColumnIndex:-1,paging:!1,grouping:!0},detailPanel:function(e){return c.a.createElement(lt,{products:e.products,quantities:e.quantities})},onRowClick:function(e,t,a){return a()},editable:{onRowDelete:function(e){return new Promise((function(t,n){var r=Object(ge.a)(s),o=e.tableData.id;r.splice(o,1),i(Object(ge.a)(r)),a(e._id),t()}))}}})})),sn=Object(y.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(he.a)({},e.breakpoints.up("lg"),{minHeight:e.spacing(54),width:e.spacing(100)})},icon:{marginRight:e.spacing(1)},panel:{minWidth:e.spacing(40),maxWidth:e.spacing(60)},purchaseNote:{backgroundColor:e.palette.grey[100],borderRadius:e.spacing(1),marginTop:e.spacing(2),padding:e.spacing(2)},removalAlert:{backgroundColor:e.palette.error.light,border:"2px solid ".concat(e.palette.error.dark),borderRadius:e.spacing(2),color:e.palette.common.white,fontSize:e.typography.h6.fontSize,padding:e.spacing(1),textAlign:"center",textTransform:"uppercase"},selected:{backgroundColor:e.palette.primary.main},songInfo:{marginBottom:e.spacing(4)},statusButton:{"&:hover":{backgroundColor:e.palette.primary.light}},studentInfo:Object(he.a)({alignItems:"center",display:"flex",justifyContent:"space-between",marginTop:e.spacing(4)},e.breakpoints.up("md"),{borderTopColor:e.palette.primary.main,borderTopStyle:"dotted",borderTopWidth:"4px",paddingTop:e.spacing(2)}),studentName:{alignItems:"center",display:"flex","& > div":{marginRight:e.spacing(1)}}}})),un=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.settings),e.purchases)}),(function(e){return{onExit:function(){return e({type:"PURCHASES_DIALOG_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_PURCHASE",payload:Ee.a.Purchases.update(t)})}}}))((function(e){var t=e.courses,a=e.errors,n=e.inProgress,r=e.onExit,l=e.onUpdate,s=e.taxRate,i=Object(o.useState)(0),u=Object(le.a)(i,2),m=u[0],d=u[1],p=Object(o.useState)({}),E=Object(le.a)(p,2),f=E[0],b=E[1],g=Object(o.useState)(!1),h=Object(le.a)(g,2),O=h[0],v=h[1],y=Object(o.useState)(null),j=Object(le.a)(y,2),S=j[0],C=j[1],T=Object(o.useState)(""),N=Object(le.a)(T,2),_=N[0],P=N[1],R=Object(o.useState)([]),w=Object(le.a)(R,2),U=w[0],k=w[1],x=Object(o.useState)(null),L=Object(le.a)(x,2),I=L[0],q=L[1],F=Object(o.useState)(0),G=Object(le.a)(F,2),B=G[0],W=G[1],H=Object(Te.a)(),M=Object(Ne.a)(H.breakpoints.down("md")),z=sn(),V=function(){var e=0;if(t.length>0){var a,n=Object(Ea.a)(t);try{for(n.s();!(a=n.n()).done;){e+=a.value.purchases.filter((function(e){return e.status.startsWith("pending")})).length}}catch(r){n.e(r)}finally{n.f()}}return e},Y=function(){d(0),v(!1),q(null),P(""),k([])},$=function(){var e=Object(K.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l(Object(J.a)(Object(J.a)({},S),{},{id:S._id,note:_,status:I})),q(null),P("");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(e){q(e)};return Object(o.useEffect)((function(){W(V())})),Object(o.useEffect)((function(){!function(){var e=null===S||void 0===S?void 0:S._id;if(C(null),t.length>0){var a,n=Object(Ea.a)(t);try{for(n.s();!(a=n.n()).done;){var r=a.value;if(r.purchases.length>0){var o=r.purchases.find((function(e){return e.status.startsWith("pending")&&!U.includes(e._id)}));if(o){o.period=r.period,C(o),e!==o._id&&d(m+1);break}}}}catch(c){n.e(c)}finally{n.f()}}}()}),[t,U]),c.a.createElement(c.a.Fragment,null,c.a.createElement(ee.a,{color:"primary",onClick:function(){v(!0),W(V())},variant:"extended"},c.a.createElement(nn,{value:B},c.a.createElement(Ft.a,{className:z.icon}),"Process purchases")),c.a.createElement(_e.a,{className:z.dialog,fullScreen:M,onClick:function(e){return e.stopPropagation()},onClose:Y,onExit:r,onFocus:function(e){return e.stopPropagation()},open:O},c.a.createElement(Pe.a,null,"Process Purchases"),c.a.createElement(Re.a,null,c.a.createElement(me,{errors:a}),S?c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(lt,{actions:{add:function(e){return function(e){var t=Object(J.a)(Object(J.a)({},S),{},{products:S.products.findIndex((function(t){return t._id===e._id}))>-1?S.products:[].concat(Object(ge.a)(S.products),[e]),quantities:Object(J.a)(Object(J.a)({},S.quantities),{},Object(he.a)({},e._id,1)),id:S._id});l(t)}(e)},delete:function(e){return function(e,t){var a=t.products.filter((function(t){return t._id!==e})),n=Object(J.a)({},t.quantities);delete n[e],l(Object(J.a)(Object(J.a)({},t),{},{products:a,quantities:n,id:t._id}))}(e,S)},setInvoice:function(e){return b(e)},update:function(e,t){return function(e,t){var a=Object(J.a)(Object(J.a)({},S.quantities),{},Object(he.a)({},e,t));l(Object(J.a)(Object(J.a)({},S),{},{quantities:a,id:S._id}))}(e,t)}},products:S.products,quantities:S.quantities,taxRate:s})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("div",{className:z.panel},c.a.createElement("div",{className:z.studentInfo},c.a.createElement("div",{className:z.studentName},c.a.createElement(Wt.a,{color:"secondary",label:S.period}),c.a.createElement(A.a,null,S.student.firstName," ",S.student.lastName)),c.a.createElement(Ie,{cost:f.total,count:m,username:S.student.username})))),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement("div",{className:z.panel},c.a.createElement(A.a,{variant:"h6"},"Status"),c.a.createElement(Ka.a,{fullWidth:!0,size:"large"},c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,title:"Approve"},c.a.createElement(D.a,{className:"".concat(z.statusButton," ").concat("approved"===I&&z.selected),onClick:function(){return Z("approved")}},c.a.createElement(Xa.a,null))),c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,title:"Decline"},c.a.createElement(D.a,{className:"".concat(z.statusButton," ").concat("declined"===I&&z.selected),onClick:function(){return Z("declined")}},c.a.createElement(en.a,null)))),c.a.createElement(Ge,{label:"Notes (optional)",name:"purchaseNote",onChange:P})))):c.a.createElement(ie.a,{severity:"info"},c.a.createElement(it.a,null,"All caught up!"),"There are no purchases to process at this time")),c.a.createElement(we.a,null,S&&c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{style:{marginRight:"auto"},variant:"subtitle2"},"Purchase ".concat(m," of ").concat(B)),c.a.createElement(D.a,{color:"primary",disabled:n||!I,onClick:$,variant:"contained"},n?"Saving...":"Save & Continue"),c.a.createElement(D.a,{disabled:n,onClick:function(){k([].concat(Object(ge.a)(U),[S._id])),q(null)},variant:"contained"},"Skip")),c.a.createElement(D.a,{disabled:n,onClick:Y,variant:"contained"},S?"Cancel":"Close"))))})),mn=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.currentUser),e.purchases)}),(function(e){return{onLoad:function(){return e({type:"TEACHER_PURCHASES_LOADED",payload:Ee.a.Purchases.forTeacher()})},onPageChange:function(t,a){return e({type:"NAV_TAB_CHANGE",value:t,redirectTo:a})},onUnload:function(){return e({type:"TEACHER_PURCHASES_UNLOADED"})}}}))((function(e){var t=e.onLoad,a=e.onPageChange,n=e.onUnload,r=e.role;return Object(o.useEffect)((function(){return t(),function(){n()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Manage Purchases"},c.a.createElement(D.a,{onClick:function(){return a("store","/".concat(r,"/products"))},size:"small"},"Manage Products"),c.a.createElement(un,null)),c.a.createElement(ln,null))})),dn=Object(y.a)((function(e){return{button:{marginRight:e.spacing(2)}}})),pn=Object(r.c)((function(){return{}}),(function(e){return{onReset:function(t){return e({type:"WHATS_NEW_FLAGS_RESET",payload:Ee.a.Teachers.resetFlags(t),snackbar:{message:"".concat(t.charAt(0).toUpperCase()+t.slice(1)," flags reset"),variant:"success"}})}}}))((function(e){var t=e.onReset,a=Object(o.useState)(!1),n=Object(le.a)(a,2),r=n[0],l=n[1],s=dn(),i=function(){l(!1)},u=function(e){l(!1),t(e)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(D.a,{className:s.button,onClick:function(){l(!0)},size:"small"},"Reset Viewed Changes"),c.a.createElement(_e.a,{open:r,onClick:function(e){return e.stopPropagation()},onClose:i,onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Reset Viewed Changes"),c.a.createElement(Re.a,null,c.a.createElement(dt.a,null,"Reset viewed changes flag for all student or teacher accounts?")),c.a.createElement(we.a,null,c.a.createElement(D.a,{onClick:function(){return u("student")},color:"secondary",variant:"contained",autoFocus:!0},"Reset Students"),c.a.createElement(D.a,{onClick:function(){return u("teacher")},color:"secondary",variant:"contained",autoFocus:!0},"Reset Teachers"),c.a.createElement(D.a,{onClick:i,variant:"contained"},"Cancel"))))})),En=Object(y.a)((function(e){return{icon:{marginRight:e.spacing(1)}}})),fn=Object(r.c)((function(e){return Object(J.a)({},e.teachers)}),(function(e){return{onAdd:function(t){return e({type:"ADD_TEACHER",payload:Ee.a.Auth.register(t),snackbar:{message:"Teacher added",variant:"success"}})},onExit:function(){return e({type:"TEACHER_DIALOG_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_TEACHER",payload:Ee.a.Teachers.update(t),snackbar:{message:"Teacher updated",variant:"success"}})}}}))((function(e){var t=e.errors,a=e.inProgress,n=e.onAdd,r=e.onExit,l=e.onUpdate,s=e.teacher,i=Object(o.useState)(!1),u=Object(le.a)(i,2),m=u[0],d=u[1],p=Object(Te.a)(),E=Object(Ne.a)(p.breakpoints.down("md")),f=En(),b=function(){d(!0)},g=function(){d(!1)},h=function(e){n(Object(J.a)(Object(J.a)({},e),{},{role:"teacher"}))},O=function(e){l(Object(J.a)(Object(J.a)({},s),e))};return Object(o.useEffect)((function(){a||t||d(!1)}),[a]),c.a.createElement(c.a.Fragment,null,s?c.a.createElement(Ce,{action:"Update teacher",onClick:b},c.a.createElement(je.a,null)):c.a.createElement(ee.a,{color:"primary",onClick:b,variant:"extended"},c.a.createElement(Je.a,{className:f.icon}),"Add teacher"),c.a.createElement(_e.a,{fullScreen:E,open:m,onClose:g,onClick:function(e){return e.stopPropagation()},onExit:r,onFocus:function(e){return e.stopPropagation()}},c.a.createElement($.c,{initialValues:{firstName:(null===s||void 0===s?void 0:s.firstName)||"",lastName:(null===s||void 0===s?void 0:s.lastName)||"",username:(null===s||void 0===s?void 0:s.username)||"",password:""},validationSchema:X.c({firstName:X.d().required("Required"),lastName:X.d().required("Required"),username:X.d().required("Required"),password:X.d().required(s?"":"Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s?O(t):h(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement($.b,null,c.a.createElement(Pe.a,null,s?"Edit Teacher":"Add Teacher"),c.a.createElement(Re.a,null,c.a.createElement(me,{errors:t}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{autoFocus:!s,color:"primary",component:Z.c,disabled:a,label:"First Name",name:"firstName",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:a,label:"Last Name",name:"lastName",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:!!s||a,label:"Username",name:"username",type:"text",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:a,label:"Password",name:"password",type:"text",fullWidth:!0})))),c.a.createElement(we.a,null,c.a.createElement(D.a,{color:"primary",disabled:a,type:"submit",variant:"contained"},s?a?"Updating...":"Update":a?"Adding...":"Add"),c.a.createElement(D.a,{disabled:a,onClick:g,variant:"contained"},"Cancel"))))))})),bn=a(584),gn=a(633),hn=a(581),On=Object(r.c)((function(){return{}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_TEACHER",payload:Ee.a.Teachers.delete(t),snackbar:{message:"Teacher deleted",variant:"success"}})}}}))((function(e){var t=e.onDelete,a=e.teacher,n=Object(o.useState)(!1),r=Object(le.a)(n,2),l=r[0],s=r[1],i=function(){s(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Delete teacher",onClick:function(){s(!0)}},c.a.createElement(Qe.a,null)),c.a.createElement(_e.a,{open:l,onClick:function(e){return e.stopPropagation()},onClose:i,onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Delete Teacher"),c.a.createElement(Re.a,null,c.a.createElement(dt.a,{component:"div"},"Are you sure you want to delete"," ",c.a.createElement("b",null,a.firstName," ",a.lastName),"? This action will permanently delete:",c.a.createElement("ul",null,c.a.createElement("li",null,"all student accounts"),c.a.createElement("li",null,"all song requests"),c.a.createElement("li",null,"all transactions"),c.a.createElement("li",null,"all purchases"),c.a.createElement("li",null,"all products"),c.a.createElement("li",null,"all scores")),"associated with this teacher. This action ",c.a.createElement("b",null,"cannot be undone"),".")),c.a.createElement(we.a,null,c.a.createElement(D.a,{onClick:function(){s(!1),t(a)},color:"secondary",variant:"contained",autoFocus:!0},"Delete"),c.a.createElement(D.a,{onClick:i,variant:"contained"},"Cancel"))))})),vn=Object(y.a)((function(e){return{teacherDetails:{display:"block"},teacherHeader:{alignItems:"center",display:"flex",justifyContent:"space-between",width:"100%"},teacherUsername:{marginRight:e.spacing(2),minWidth:e.spacing(12)},teacherName:{flexGrow:"1"}}})),yn=function(e){var t=e.teacher,a=function(e){return e?Object.values(e).flat().length:0};return c.a.createElement("div",null,c.a.createElement(A.a,{variant:"h6",gutterBottom:!0},"Teacher Stats"),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement($t,{icon:c.a.createElement(It.a,{fontSize:"large"}),title:"Assignments",value:a(t.tasks)}),c.a.createElement($t,{icon:c.a.createElement(Ft.a,{fontSize:"large"}),title:"Online Purchases",value:a(t.purchases)}),c.a.createElement($t,{icon:c.a.createElement(I.a,{fontSize:"large"}),title:"Products",value:t.products?t.products.length:0}),c.a.createElement($t,{icon:c.a.createElement(qt.a,{fontSize:"large"}),title:"Scores",value:a(t.scores)}),c.a.createElement($t,{icon:c.a.createElement(Za.a,{fontSize:"large"}),title:"Songs",value:a(t.songs)}),c.a.createElement($t,{icon:c.a.createElement(x.a,{fontSize:"large"}),title:"Transactions",value:a(t.transactions)})))},jn=function(e){var t=e.teacher,a=function(e){var t=e.icon,a=e.primary,n=e.secondary;return c.a.createElement(bn.a,{alignItems:"flex-start"},c.a.createElement(gn.a,null,c.a.createElement(Kt.a,null,t)),c.a.createElement(la.a,{primary:a,secondary:n}))};return c.a.createElement("div",null,c.a.createElement(A.a,{variant:"h6",gutterBottom:!0},"Courses"),c.a.createElement(ae.a,{container:!0,spacing:2},t.courses&&t.courses.length>0?t.courses.map((function(e,n){return c.a.createElement(ae.a,{item:!0,xs:12,md:6,lg:4,key:n},c.a.createElement(Yt.a,{variant:"outlined"},c.a.createElement(Qt.a,null,c.a.createElement(A.a,{gutterBottom:!0,variant:"h5"},e.name),c.a.createElement(Wt.a,{color:"secondary",label:"Period ".concat(e.period),size:"small",style:{color:"white",marginRight:"8px"}}),c.a.createElement(Wt.a,{color:"primary",label:"".concat(e.students.length," student").concat(1===e.students.length?"":"s"),size:"small",variant:"outlined"}),c.a.createElement(hn.a,null,c.a.createElement(a,{icon:c.a.createElement(It.a,null),primary:"Assignments",secondary:t.tasks[e._id].length}),c.a.createElement(a,{icon:c.a.createElement(Ft.a,null),primary:"Online Purchases",secondary:t.purchases[e._id].length}),c.a.createElement(a,{icon:c.a.createElement(qt.a,null),primary:"Scores",secondary:t.scores[e._id].length}),c.a.createElement(a,{icon:c.a.createElement(Za.a,null),primary:"Song Requests",secondary:t.songs[e._id].length}),c.a.createElement(a,{icon:c.a.createElement(x.a,null),primary:"Transactions",secondary:t.transactions[e._id].length})))))})):c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,null,"No courses have been created"))))},Sn=function(e){var t=e.settings,a=function(e){var t=e.value,a=typeof t,n=JSON.stringify(t);return"boolean"===a?c.a.createElement(Wt.a,{color:t?"primary":"secondary",label:n,style:{color:"white"}}):"object"===a&&t.hasOwnProperty("_id")?t._id:n};return c.a.createElement("div",null,c.a.createElement(A.a,{variant:"h6",gutterBottom:!0},"Settings"),c.a.createElement(We.a,null,c.a.createElement(He.a,null,c.a.createElement(Me.a,null,c.a.createElement(ze.a,null,"Setting"),c.a.createElement(ze.a,null,"Value"))),c.a.createElement(Ve.a,null,Object.keys(t).map((function(e,n){return c.a.createElement(Me.a,{key:n},c.a.createElement(ze.a,null,e),c.a.createElement(ze.a,null,c.a.createElement(a,{value:t[e]})))})))))},An=function(e){var t=e.teachers,a=Object(o.useState)(!1),n=Object(le.a)(a,2),r=n[0],l=n[1],s=vn();return c.a.createElement(c.a.Fragment,null,(null===t||void 0===t?void 0:t.length)>0?t.map((function(e){return c.a.createElement(_a.a,{expanded:r===e.username,key:e.username,onChange:(t=e.username,function(e,a){l(!!a&&t)})},c.a.createElement(Pa.a,{expandIcon:c.a.createElement(wa.a,null)},c.a.createElement("div",{className:s.teacherHeader},c.a.createElement(Wt.a,{color:"secondary",label:e.username,className:s.teacherUsername}),c.a.createElement(A.a,{className:s.teacherName,variant:"h5"},e.firstName," ",e.lastName),c.a.createElement(fn,{teacher:e}),c.a.createElement(On,{teacher:e}))),c.a.createElement(Ra.a,{className:s.teacherDetails},c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(yn,{teacher:e})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(jn,{teacher:e})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(Sn,{settings:e.settings})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,null,c.a.createElement("b",null,"Viewed Changes"),":"," ",e.viewedChanges?"yes":"no")))));var t})):c.a.createElement(A.a,null,"No teachers found"))},Dn=Object(r.c)((function(e){return Object(J.a)({},e.teachers)}),(function(e){return{onLoad:function(){return e({type:"MANAGE_TEACHERS_PAGE_LOADED",payload:Ee.a.Teachers.getAll()})},onUnload:function(){return e({type:"MANAGE_TEACHERS_PAGE_UNLOADED"})}}}))((function(e){var t=e.onLoad,a=e.onUnload,n=e.pageLoaded,r=e.teachers;return Object(o.useEffect)((function(){return t(),function(){a()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:"Manage Teachers"},c.a.createElement(pn,null),c.a.createElement(fn,null)),n?c.a.createElement(An,{teachers:r}):c.a.createElement(Vt,{message:"Loading..."}))})),Cn=Object(y.a)((function(e){return{header:{backgroundColor:"white",paddingLeft:e.spacing(1),paddingRight:e.spacing(1),position:"absolute",top:"-18px"},img:{maxHeight:"100%",maxWidth:"100%",minWidth:"20px"},window:{alignItems:"center",display:"flex",borderColor:e.palette.secondary.main,borderStyle:"solid",borderWidth:"4px",height:"300px",justifyContent:"center",padding:e.spacing(2),position:"relative"}}})),Tn=function(e){var t=e.src,a=Cn();return c.a.createElement("div",{className:a.window},c.a.createElement(A.a,{variant:"h6",className:a.header},"Image Preview"),t?c.a.createElement("img",{className:a.img,src:rt(t)}):c.a.createElement(A.a,null,"No photo url provided"))},Nn=function(e){return c.a.createElement(qe.a,Object.assign({error:Boolean(e.errors),inputProps:{maxLength:e.limit},helperText:e.errors?"".concat(e.errors," | ").concat(e.value.length,"/").concat(e.limit):"".concat(e.value.length,"/").concat(e.limit)},e))},_n=Object(y.a)((function(e){return{addIcon:{marginRight:e.spacing(1)},updateIcon:{color:"rgba(255, 255, 255, 0.7)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.3)",color:"white"}}}})),Pn=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.products),{},{currentUser:e.common.currentUser})}),(function(e){return{onAdd:function(t){return e({type:"ADD_PRODUCT",payload:Ee.a.Products.add(t),snackbar:{message:"Product added",variant:"success"}})},onExit:function(){return e({type:"PRODUCT_DIALOG_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_PRODUCT",payload:Ee.a.Products.update(t),snackbar:{message:"Product updated",variant:"success"}})}}}))((function(e){var t=e.currentUser,a=e.product,n=e.errors,r=e.inProgress,l=e.onAdd,s=e.onExit,i=e.onUpdate,u=60,m=140,d=Object(o.useState)(!1),p=Object(le.a)(d,2),E=p[0],f=p[1],b=Object(Te.a)(),g=Object(Ne.a)(b.breakpoints.down("md")),h=_n(),O=function(){f(!0)},v=function(){f(!1)},y=function(e){l(Object(J.a)({},e))},j=function(e){i(Object(J.a)(Object(J.a)({},a),e))};return Object(o.useEffect)((function(){r||n||f(!1)}),[r]),c.a.createElement(c.a.Fragment,null,a?"teacher"===t.role&&c.a.createElement(Ce,{action:"Edit product",onClick:O,className:h.updateIcon},c.a.createElement(je.a,null)):c.a.createElement(ee.a,{color:"primary",onClick:O,variant:"extended"},c.a.createElement(Je.a,{className:h.addIcon}),"Add product"),c.a.createElement(_e.a,{fullScreen:g,maxWidth:"lg",onClick:function(e){return e.stopPropagation()},onClose:v,onExit:s,onFocus:function(e){return e.stopPropagation()},open:E},c.a.createElement($.c,{initialValues:{name:(null===a||void 0===a?void 0:a.name)||"",description:(null===a||void 0===a?void 0:a.description)||"",photoUrl:(null===a||void 0===a?void 0:a.photoUrl)||"",cost:(null===a||void 0===a?void 0:a.cost)||0,maxPurchaseQuantity:(null===a||void 0===a?void 0:a.maxPurchaseQuantity)||0,quantity:(null===a||void 0===a?void 0:a.quantity)||0},validationSchema:X.c({name:X.d().max(u,"Cannot be longer than ".concat(u," characters")).required("Required"),description:X.d().max(m,"Cannot be longer than ".concat(m," characters")),photoUrl:X.d().url("Not a valid url").required("Required"),cost:X.b().typeError("Numbers only").required("Required"),maxPurchaseQuantity:X.b().typeError("Numbers only").required("Required"),quantity:X.b().typeError("Numbers only").required("Required")}),onSubmit:function(){var e=Object(K.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a?j(t):y(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},(function(e){return c.a.createElement($.b,null,c.a.createElement(Pe.a,null,a?"Edit product":"Add product"),c.a.createElement(Re.a,null,c.a.createElement(me,{errors:n}),c.a.createElement(ae.a,{container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement($.a,{as:Nn,autoFocus:!a,color:"primary",disabled:r,label:"Product Name",name:"name",type:"text",limit:u,errors:e.errors.name,fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement($.a,{as:Nn,color:"primary",disabled:r,label:"Product Description",name:"description",type:"text",limit:m,errors:e.errors.description,fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Photo Url",name:"photoUrl",type:"url",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Cost",name:"cost",type:"number",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Quantity",name:"quantity",type:"number",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:4},c.a.createElement($.a,{color:"primary",component:Z.c,disabled:r,label:"Max purchase quantity",name:"maxPurchaseQuantity",type:"number",fullWidth:!0})),c.a.createElement(ae.a,{item:!0,xs:12,md:6},c.a.createElement(Tn,{src:e.values.photoUrl})))),c.a.createElement(we.a,null,c.a.createElement(D.a,{disabled:r,color:"primary",type:"submit",variant:"contained"},a?r?"Updating...":"Update":r?"Adding...":"Add"),c.a.createElement(D.a,{disabled:r,onClick:v,variant:"contained"},"Cancel")))}))))})),Rn=a(629),wn=a(630),Un=a(631),kn=a(662),xn=Object(y.a)((function(e){return{icon:{color:"rgba(255, 255, 255, 0.7)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.3)",color:"white"}}}})),Ln=Object(r.c)((function(e){return{currentUser:e.common.currentUser}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_PRODUCT",payload:Ee.a.Products.delete(t),snackbar:{message:"Product deleted",variant:"success"}})}}}))((function(e){var t=e.currentUser,a=e.product,n=e.onDelete,r=xn(),l=Object(o.useState)(!1),s=Object(le.a)(l,2),i=s[0],u=s[1],m=function(){u(!1)};return c.a.createElement(c.a.Fragment,null,"teacher"===t.role&&c.a.createElement(Ce,{action:"Delete product",onClick:function(){u(!0)},className:r.icon},c.a.createElement(Qe.a,null)),c.a.createElement(_e.a,{open:i,onClose:m,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"Delete Product"),c.a.createElement(Re.a,null,c.a.createElement(dt.a,{component:"div"},"Are you sure you want to delete ",c.a.createElement("b",null,a.name),"? This action"," ",c.a.createElement("b",null,"cannot be undone"),".")),c.a.createElement(we.a,null,c.a.createElement(D.a,{onClick:function(){u(!1),n(a.slug)},color:"secondary",variant:"contained",autoFocus:!0},"Delete"),c.a.createElement(D.a,{onClick:m,variant:"contained"},"Cancel"))))})),In=Object(y.a)((function(e){return{actionIcon:{display:"flex"},cost:{color:"white"},description:{marginBottom:"-1.5rem",opacity:0,transition:"opacity 0s ease-in-out"},icon:{color:"rgba(255, 255, 255, 0.7)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.3)",color:"white"}},name:{color:e.palette.secondary.main,fontSize:e.typography.h5.fontSize,marginBottom:e.spacing(.5),whiteSpace:"nowrap"},quantity:{marginLeft:e.spacing(2)},tile:{"&:hover .MuiGridListTileBar-root":{height:"100%","& #description":{marginBottom:0,opacity:1,transition:"margin-bottom 0.35s ease-in-out, opacity 0.5s ease-in-out"}}},tileBar:{alignItems:"flex-end",paddingBottom:e.spacing(1),paddingRight:e.spacing(1),transition:"height 0.35s ease-in-out"},title:{whiteSpace:"normal"}}})),qn=function(e){var t=e.onAddToCart,a=e.onInventoryChange,n=e.cart,r=e.products,o=e.storeEnabled,l=e.userRole,s=In(),i=Object(Te.a)(),u=Object(Ne.a)(i.breakpoints.down("sm")),m=Object(Ne.a)(i.breakpoints.down("md")),d=u?1:m||"teacher"===l?2:3,p=function(e,t){return a(Object(J.a)(Object(J.a)({},e),{},{quantity:"add"===t?e.quantity+1:e.quantity-1}))};return c.a.createElement("div",null,c.a.createElement(Rn.a,{cols:d,spacing:8},(null===r||void 0===r?void 0:r.length)>0?r.map((function(e){var a=e.maxPurchaseQuantity<e.quantity&&0!==e.maxPurchaseQuantity?e.maxPurchaseQuantity:e.quantity,r=a>0&&(null===n||void 0===n?void 0:n.quantities[e._id])>=a;return c.a.createElement(wn.a,{key:e.slug,className:s.tile},c.a.createElement("img",{src:rt(e.photoUrl),alt:e.name}),c.a.createElement(Un.a,{classes:{actionIcon:s.actionIcon,title:s.title},className:s.tileBar,title:c.a.createElement("div",null,c.a.createElement("div",{className:s.description,id:"description"},e.description," ",e.maxPurchaseQuantity>0&&c.a.createElement("em",null,"(Limit ",e.maxPurchaseQuantity,")")),c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,placement:"bottom-start",title:e.name},c.a.createElement("div",{className:s.name},e.name))),subtitle:c.a.createElement("div",null,c.a.createElement(Wt.a,{className:s.cost,color:"primary",label:c.a.createElement(xe,{value:e.cost}),size:"small"}),("teacher"===l||e.quantity<5)&&c.a.createElement(Wt.a,{className:s.quantity,color:"secondary",label:"teacher"===l?"".concat(e.quantity," available"):"only ".concat(e.quantity," left"),size:"small",variant:"outlined"})),actionIcon:"teacher"===l?c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{action:"Remove inventory",className:s.icon,onClick:function(){return p(e,"remove")}},c.a.createElement(kn.a,null)),c.a.createElement(Ce,{action:"Add inventory",className:s.icon,onClick:function(){return p(e,"add")}},c.a.createElement(Je.a,null)),c.a.createElement(Pn,{product:e}),c.a.createElement(Ln,{product:e})):o&&c.a.createElement(Ce,{action:r?"Max limit reached":"Add to cart",disabled:r,onClick:function(){return function(e){return t(e)}(e)},className:s.icon},c.a.createElement(tn.a,{badgeContent:n.quantities[e._id],color:"secondary"},c.a.createElement(Ue.a,null)))}))})):c.a.createElement(A.a,null,"teacher"===l?"You have no products":"Your teacher has not added any products")))},Fn=a(446),Gn=a.n(Fn),Bn=a(445),Wn=a.n(Bn),Hn=Object(y.a)((function(e){return{title:{color:e.palette.common.white,margin:"0 auto"}}})),Mn=function(e){var t=e.onClose,a=e.title,n=Hn();return c.a.createElement(j.a,{position:"relative"},c.a.createElement(S.a,null,c.a.createElement(Ae.a,{edge:"start",onClick:t},c.a.createElement(ye.a,null)),c.a.createElement(A.a,{variant:"h5",className:n.title},a)))},zn=Object(y.a)((function(e){return{cartIcon:{marginRight:e.spacing(1)}}})),Vn=Object(r.c)((function(e){return Object(J.a)(Object(J.a)(Object(J.a)(Object(J.a)({},e.common.currentUser),e.common.settings),e.purchases),e.scores.total)}),(function(e){return{onDelete:function(t){return e({type:"DELETE_CART_PRODUCT",productId:t})},onLoad:function(t){return e({type:"STUDENT_CART_LOADED",payload:Ee.a.Scores.getStudentScores(t)})},onSubmit:function(t){return e({type:"SUBMIT_PURCHASE",payload:Ee.a.Purchases.add(t),snackbar:{message:"Order submitted",variant:"success"}})},onUnload:function(){return e({type:"STUDENT_CART_UNLOADED"})},onUpdate:function(t,a){return e({type:"UPDATE_CART_PRODUCT_QUANTITY",productId:t,qty:a})}}}))((function(e){var t=e.allowPurchasesWithInsufficientFunds,a=e.balance,n=e.cart,r=e.errors,l=e.inProgress,s=e.onDelete,i=e.onLoad,u=e.onSubmit,m=e.onUnload,d=e.onUpdate,p=e.taxRate,E=e.username,f=Object(o.useState)(!1),b=Object(le.a)(f,2),g=b[0],h=b[1],O=nt(n.products,n.quantities,p).invoice,y=zn(),j=function(){return h(!1)},S=Object.values(n.quantities).reduce((function(e,t){return e+t}),0),A=!t&&O.total>a;return Object(o.useEffect)((function(){return i(E),function(){m()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(ee.a,{color:"primary",disabled:0===n.products.length,onClick:function(){return h(!0)},variant:"extended"},c.a.createElement(nn,{value:S},c.a.createElement(Wn.a,{className:y.cartIcon}),"Checkout")),c.a.createElement(_e.a,{fullScreen:!0,open:g,onClick:function(e){return e.stopPropagation()},onClose:j,onFocus:function(e){return e.stopPropagation()},TransitionComponent:Xt},c.a.createElement(Mn,{onClose:j,title:"Store"}),c.a.createElement(M,null,c.a.createElement(v.a,null,c.a.createElement(pe,{title:"Complete Your Order"},c.a.createElement(ee.a,{color:"primary",disabled:0===n.products.length||A,onClick:function(){u({products:n.products,quantities:n.quantities,status:"pending"}),j()},variant:"extended"},c.a.createElement(Gn.a,{className:y.cartIcon}),"Place Your Order")),c.a.createElement(me,{errors:r}),(A||O.total>a)&&c.a.createElement(kt,{disableClose:!0,severity:"warning"},"Insufficient funds! You have ",c.a.createElement(xe,{value:a})),l?c.a.createElement(Vt,{message:"Loading..."}):c.a.createElement(lt,{actions:{delete:s,update:d},products:n.products,quantities:n.quantities})))))})),Yn=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.common.settings),e.purchases)}),(function(e){return{onDelete:function(t){return e({type:"STUDENT_DELETE_PURCHASE",payload:Ee.a.Purchases.delete(t),snackbar:{message:"Purchase deleted",variant:"success"}})}}}))((function(e){var t=e.onDelete,a=e.purchases,n=e.taxRate,r=Object(o.useState)([]),l=Object(le.a)(r,2),s=l[0],i=l[1],u=a.map((function(e){return{createdAt:new Date(e.createdAt).toDateString(),note:e.note,quantities:e.quantities,products:e.products,status:e.status,totalCost:e.products.reduce((function(t,a){return t+a.cost*e.quantities[a._id]*(n/100+1)}),0),totalItems:Object.values(e.quantities).reduce((function(e,t){return e+t}),0),_id:e._id}})),m=Object(o.useState)([{title:"Purchase Date",field:"createdAt",editable:"never"},{title:"Total Items",field:"totalItems"},{title:"Total Cost",field:"totalCost",render:function(e){return c.a.createElement(xe,{value:e.totalCost})}},{title:"Notes",field:"note"},{title:"Status",field:"status"}]),d=Object(le.a)(m,1)[0];return Object(o.useEffect)((function(){i(u)}),[a]),c.a.createElement(ve.a,{title:"Orders",columns:d,data:s,localization:{body:{emptyDataSourceMessage:"No purchases have been made",editRow:{deleteText:"Delete purchase? This will cancel your order",saveTooltip:"Delete purchase"}}},options:{actionsColumnIndex:-1,paging:!1,showTitle:!1},detailPanel:function(e){return c.a.createElement(lt,{products:e.products,quantities:e.quantities})},onRowClick:function(e,t,a){return a()},editable:{isDeletable:function(e){return"pending"===e.status},onRowDelete:function(e){return new Promise((function(a,n){var r=Object(ge.a)(s),o=e.tableData.id;r.splice(o,1),i(Object(ge.a)(r)),t(e._id),a()}))}}})})),Qn=Object(r.c)((function(e){return Object(J.a)({},e.purchases)}),(function(e){return{onLoad:function(){return e({type:"STUDENT_PURCHASES_LOADED",payload:Ee.a.Purchases.forStudent()})},onUnload:function(){return e({type:"STUDENT_PURCHASES_UNLOADED"})}}}))((function(e){var t=e.errors,a=e.inProgress,n=e.onLoad,r=e.onUnload,l=Object(o.useState)(!1),s=Object(le.a)(l,2),i=s[0],u=s[1],m=function(){u(!1),r()};return c.a.createElement(c.a.Fragment,null,c.a.createElement(D.a,{onClick:function(){u(!0),n()},size:"small"},"Your orders"),c.a.createElement(_e.a,{fullScreen:!0,open:i,onClick:function(e){return e.stopPropagation()},onClose:m,onFocus:function(e){return e.stopPropagation()},TransitionComponent:Xt},c.a.createElement(Mn,{onClose:m,title:"Store"}),c.a.createElement(M,null,c.a.createElement(v.a,null,c.a.createElement(pe,{title:"Your Orders"}),c.a.createElement(me,{errors:t}),a?c.a.createElement(Vt,{message:"Loading..."}):c.a.createElement(Yn,null)))))})),Kn=Object(r.c)((function(e){return Object(J.a)(Object(J.a)(Object(J.a)({settings:e.common.settings},e.common.currentUser),e.products),e.purchases)}),(function(e){return{onAddToCart:function(t){return e({type:"ADD_TO_CART",product:t})},onLoad:function(){return e({type:"PRODUCTS_PAGE_LOADED",payload:Ee.a.Products.getAll()})},onPageChange:function(t,a){return e({type:"NAV_TAB_CHANGE",value:t,redirectTo:a})},onUnload:function(){return e({type:"PRODUCTS_PAGE_UNLOADED"})},onUpdateInventory:function(t){return e({type:"UPDATE_PRODUCT",payload:Ee.a.Products.update(t)})}}}))((function(e){var t=e.cart,a=e.onAddToCart,n=e.onLoad,r=e.onPageChange,l=e.onUnload,s=e.onUpdateInventory,i=e.pageLoaded,u=e.products,m=e.role,d=e.settings;Object(o.useEffect)((function(){return n(),function(){l()}}),[]);var p="teacher"===m,E=u.filter((function(e){return e.quantity>0})),f=u.filter((function(e){return e.quantity<=0})),b=function(e){return s(e)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(pe,{title:p?"Manage Products":"View Products"},p?c.a.createElement(c.a.Fragment,null,d.storeEnabled&&c.a.createElement(D.a,{onClick:function(){return r("store","/".concat(m,"/store"))},size:"small"},"Manage purchases"),c.a.createElement(Pn,null)):d.storeEnabled&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Qn,null),c.a.createElement(Vn,null))),i?c.a.createElement(ae.a,{container:!0,spacing:8},c.a.createElement(ae.a,{item:!0,xs:12},p?c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"In Stock"),c.a.createElement(qn,{onInventoryChange:b,products:E,userRole:m})):c.a.createElement(qn,{cart:t,products:E,onAddToCart:function(e){return a(e)},storeEnabled:d.storeEnabled,userRole:m})),p&&c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Out of Stock"),c.a.createElement(qn,{onInventoryChange:b,products:f,userRole:m}))):c.a.createElement(Vt,{message:"Loading..."}))})),Jn=Object(r.c)((function(e){return{currentUser:e.common.currentUser}}),(function(){return{}}))((function(e){var t=e.currentUser;return t?c.a.createElement(c.a.Fragment,null,c.a.createElement(w,{currentUser:t}),c.a.createElement(M,null,c.a.createElement(v.a,null,c.a.createElement(i.d,null,c.a.createElement(V,{path:"/student/account",component:jt}),c.a.createElement(V,{path:"/student/settings",component:be}),c.a.createElement(V,{path:"/student/songs",component:Rt}),c.a.createElement(V,{path:"/student/store",component:Kn}),c.a.createElement(V,{path:"/teacher/accounts",component:Ca}),c.a.createElement(V,{path:"/teacher/courses",component:Qa}),c.a.createElement(V,{path:"/teacher/products",component:Kn}),c.a.createElement(V,{path:"/teacher/settings",component:be}),c.a.createElement(V,{path:"/teacher/songs",component:cn}),c.a.createElement(V,{path:"/teacher/store",component:mn}),c.a.createElement(V,{path:"/admin/settings",component:be}),c.a.createElement(V,{path:"/admin/teachers",component:Dn}),c.a.createElement(i.b,{component:z}))),c.a.createElement(W,null))):c.a.createElement(i.a,{to:"/login"})})),$n=a(277),Zn=a.n($n),Xn=a(278),er=a.n(Xn),tr=Object(y.a)((function(e){return{background:{alignItems:"center",backgroundImage:"url(".concat(er.a,")"),backgroundSize:"cover",display:"flex",height:"100%",justifyContent:"center"},logo:{marginBottom:e.spacing(4),width:160},panel:{alignItems:"center",borderRadius:"1rem",display:"flex",flexFlow:"column nowrap",overflowY:"scroll",padding:"2rem 4rem",position:"relative"},text:{color:e.palette.primary.main,fontStyle:"italic"}}})),ar=function(e){var t=tr();return c.a.createElement(Zn.a,{className:t.background},c.a.createElement(te.a,{elevation:12,className:t.panel},c.a.createElement(N,{className:t.logo}),c.a.createElement(A.a,{className:t.text,variant:"h4"},"Loading...")))},nr=a(124),rr=a(406),or=a(663),cr=a(632),lr=a(447),sr=a.n(lr),ir=Object(y.a)((function(e){return{page:{"& p:not(:last-of-type)":{marginBottom:e.spacing(2)}},profile:{borderRadius:"100%",boxShadow:e.shadows[10],float:"right",marginBottom:e.spacing(2),marginLeft:e.spacing(2),width:"120px"}}})),ur=function(){var e=ir();return c.a.createElement(ae.a,{className:e.page,container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{align:"center",gutterBottom:!0,variant:"h5"},"What is Chem Cash?"),c.a.createElement("img",{className:e.profile,src:sr.a}),c.a.createElement(A.a,{variant:"body2"},"Hi! I'm Joseph May, a high school chemistry teacher from Las Vegas. While I love teaching chemistry, I also love programming for the web, so why not combine the two."),c.a.createElement(A.a,{variant:"body2"},"Chem Cash is a points-based rewards system I use in my classroom. The idea for this site came from a colleage who was inspired by one of his own high school science teachers."),c.a.createElement(A.a,{variant:"body2"},"Students earn points in two ways: (1) through payouts based on their assessment scores and (2) with bonus points earned for anything I deam worthy of reward such as winning in-class competitions or going above and beyond to help me or a student."),c.a.createElement(A.a,{variant:"body2"},'These points can be used to "purchase" goods such as school supplies, electronics, and anything I can find for cheap or get for free.'),c.a.createElement(A.a,{variant:"body2"},"However, the hottest-selling item is song requests. During work time in my class I play music for my students. Each class period has its own playlist and students can only add songs to the playlist by spending their Chem Cash points."),c.a.createElement(A.a,{variant:"body2"},"I created this program to help manage all of the logistics behind this system of incentives. While it can support multiple teachers, I am running it on no-cost servers, so it was not intended to be a public program. Although, if you are interested in learning more, please reach out to me"," ",c.a.createElement(cr.a,{href:"mailto:jwmay87+chemcash@gmail.com"},"here"),".")))},mr=Object(r.c)((function(e){return Object(J.a)({},e.auth)}),(function(e){return{onSubmit:function(t,a){return e({type:P,payload:Ee.a.Auth.login(t,a)})}}}))((function(e){return c.a.createElement($.c,{initialValues:{username:"",password:""},validationSchema:X.c({username:X.d().required("Required"),password:X.d().required("Required")}),onSubmit:function(t){!function(t,a){e.onSubmit(t,a)}(t.username,t.password)}},c.a.createElement($.b,null,c.a.createElement(ae.a,{container:!0,spacing:4},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(me,{errors:e.errors}),c.a.createElement($.a,{component:Z.c,disabled:e.inProgress,fullWidth:!0,label:"Username",name:"username",type:"text",variant:"outlined"})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement($.a,{component:Z.c,disabled:e.inProgress,fullWidth:!0,label:"Password",name:"password",type:"password",variant:"outlined"})),c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(D.a,{color:"primary",disabled:e.inProgress,size:"large",type:"submit",variant:"contained"},e.inProgress?"Loading...":"Login")))))})),dr=Object(y.a)((function(e){return{aboutLink:{bottom:e.spacing(2),position:"absolute",right:e.spacing(4)},loginLink:{marginBottom:e.spacing(2),"& > a":{textDecoration:"none"}},logo:{display:"block",margin:"0 auto",width:120},page:Object(he.a)({alignItems:"center",backgroundImage:"url(".concat(er.a,")"),backgroundSize:"cover",display:"flex",height:"100%",justifyContent:"center"},e.breakpoints.up("lg"),{backgroundSize:"initial",justifyContent:"flex-end"}),panel:Object(he.a)({borderRadius:"1rem",maxHeight:"90%",overflowY:"scroll",padding:"4rem 2rem",position:"relative",width:"80%"},e.breakpoints.up("lg"),{borderRadius:"0",height:"100%",maxHeight:"100%",width:"40%"}),progress:{height:10,left:"0",position:"absolute",top:"0",width:"100%"}}})),pr=function(){var e=dr();return c.a.createElement("span",{className:e.aboutLink},c.a.createElement(Se.a,{arrow:!0,enterTouchDelay:0,title:"Learn more"},c.a.createElement(nr.a,{to:"/about"},c.a.createElement(Dt.a,{color:"secondary",fontSize:"small"}))))},Er=function(){var e=dr();return c.a.createElement("div",{className:e.loginLink},c.a.createElement(nr.a,{to:"/login"},c.a.createElement(D.a,{color:"secondary",startIcon:c.a.createElement(or.a,null)},"Login")))},fr=Object(r.c)((function(e){return Object(J.a)(Object(J.a)({},e.auth),{},{currentUser:e.common.currentUser,pathname:e.router.location.pathname})}),(function(e){return{onUnload:function(){return e({type:"LOGIN_PAGE_UNLOADED"})}}}))((function(e){var t=e.currentUser,a=e.inProgress,n=e.onUnload,r=e.pathname,l=dr();return Object(o.useEffect)((function(){return function(){return n()}}),[]),t?c.a.createElement(i.a,{to:"/"}):c.a.createElement(Zn.a,null,c.a.createElement("div",{className:l.page},c.a.createElement(te.a,{elevation:12,className:l.panel},a&&c.a.createElement(rr.a,{className:l.progress}),c.a.createElement(ae.a,{container:!0,spacing:4},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(N,{className:l.logo})),c.a.createElement(ae.a,{item:!0,xs:12},r.includes("about")?c.a.createElement(c.a.Fragment,null,c.a.createElement(Er,null),c.a.createElement(ur,null)):c.a.createElement(c.a.Fragment,null,c.a.createElement(pr,null),c.a.createElement(mr,null)))))))})),br=a(331),gr=function(e){var t=e.snackbar,a=Object(br.b)().enqueueSnackbar;return Object(o.useEffect)((function(){t&&a(t.message,{variant:t.variant})}),[t]),e.children},hr=Object(r.c)((function(e){return{snackbar:e.notifier.snackbar}}),(function(e){return{onSnackbarClose:function(){return e({type:"SNACKBAR_CLOSED"})}}}))((function(e){var t=c.a.createRef(),a=function(e){return function(){t.current.closeSnackbar(e)}};return c.a.createElement(br.a,{maxSnack:3,ref:t,action:function(e){return c.a.createElement(D.a,{onClick:a(e)},"Dismiss")},onClose:function(){e.onSnackbarClose()}},c.a.createElement(gr,{snackbar:e.snackbar},e.children))})),Or=function(e){var t=e.date;return c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"body1"},c.a.createElement("em",null,t)))},vr=function(e){var t=e.children,a=e.title;return c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"subtitle2"},a),c.a.createElement(A.a,{variant:"body2"},t))},yr=function(){return c.a.createElement(ae.a,{container:!0,spacing:4},c.a.createElement(ae.a,{item:!0,xs:12,container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h6"},"Latest Updates")),c.a.createElement(Or,{date:"August 1, 2022"}),c.a.createElement(vr,{title:"Notification Center"},"You will now see notifications when you first login if there are updates to your song and online purchase requests. You will see if your requests were approved or denied and will see any notes associted with your request."),c.a.createElement(vr,{title:"Online Purchases"},"If your teacher has enabled the feature, you can now make purchases online! You can add items to your cart on the Store page, manage your cart, submit your order, and view your previous orders."),c.a.createElement(vr,{title:"Product Quantities"},"You can now see when there are fewer than five items of any given product with a new badge shown on the Products or Store page.")),c.a.createElement(ae.a,{item:!0,xs:12,container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h6"},"Previous Updates")),c.a.createElement(Or,{date:"Dec 30, 2021"}),c.a.createElement(vr,{title:"Delete Songs"},"You can now request songs to be removed from your class playlist by going to the 'Songs' tab and clicking the trash can icon next to the song you want removed. This feature is only available if your teacher has activated it."),c.a.createElement(vr,{title:"What's New Notifications"},"This notification is a new feature! When new Chem Cash udpates are released this notification will appear once on the first time you access the website after the update is released.")))},jr=function(){return c.a.createElement(ae.a,{container:!0,spacing:4},c.a.createElement(ae.a,{item:!0,xs:12,container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h6"},"Latest Updates")),c.a.createElement(Or,{date:"August 1, 2022"}),c.a.createElement(vr,{title:"Online Purchases"},"Students can now submit online orders for products! New settings in the"," ",c.a.createElement("em",null,"Products and Online Purchases")," section allow you to control whether students can submit online purchases or not, whether students can submit online purchases if they do not have sufficient points, and a tax rate to be applied to all online purchases of products (does not apply to song requests or removal requests; can be set to zero if you do not want to charge a tax). You can also add purchases to a student's account from the ",c.a.createElement("em",null,"Accounts")," tab."),c.a.createElement(vr,{title:"Processing Purchases"},"If you have enabled online purchases, a new ",c.a.createElement("em",null,"Process Purchases")," ","dialog is available to approve or reject online purchases submitted by students in a manner similar to the song request processing feature. When processing purchases, you will have the option to update the order quantity of each item, add items to the order, remove items from the order, add a note to the order, and approve or reject the order. Upon approval of the order, the on-hand quantity of each product will be automaticaly adjusted."),c.a.createElement(vr,{title:"Notification Center for Student Accounts"},"Students will now see notifications when they first login if there are any updates to their song and online store purchase requests. Approval or rejection notes will also be included with the notification."),c.a.createElement(vr,{title:"Inventory Control Buttons and Quantity Display for Products"},"On the ",c.a.createElement("em",null,"Products")," page, two new inventory control buttons are now available to quickly increase or decrease the amount of on-hand product. The quantity of each product is also now visible directly on each product image. Students will only see the on-hand quantity when there are fewer then five items remaining in stock."),c.a.createElement(vr,{title:"Max Purchase Quantity for Products"},"A new field is now available for products that sets the maximum purchase quantity limit for each product. When combined with the online store, this will limit the quantity of items a student can add to their cart for each product."),c.a.createElement(vr,{title:"Add Quick Purchases with Automatic Inventory Mangement"},"Quick purchases allow you to add a deduction to a student's account for the purchase of a single product from the store or you can enter a custom description. When products from the store are purchased, the inventory is automatically reduced by one."),c.a.createElement(vr,{title:"Points Multiplier for Assignments"},"Assignments can now be weighted with a multiplier to increase or decrease their point value. By default, all assignments are imported with a multiplier of 1. To change the multiplier for an assignment in a course go to Courses and click the Manage Assignments button for that course. Then click the Edit button for the assignment whose multiplier you want to change. The multiplier applies to the points and not to the score."),c.a.createElement(vr,{title:"Google Drive Hosted Images Now Easier to Use"},"You can now directly use the link generated by the ",c.a.createElement("em",null,"Get link")," ","feature on Google Drive to add custom product images to your store. Images hosted on Google Drive must have their share permissions set to"," ",c.a.createElement("em",null,"Anyone with the link")," to properly display for all users."),c.a.createElement(vr,{title:"Song Requests Badge"},"A badge now appears on the ",c.a.createElement("em",null,"Process Songs")," button to indicate the number of song requests that are pending approval. A similar badge also appears on the ",c.a.createElement("em",null,"Process Purchases")," button."),c.a.createElement(vr,{title:"Improved Settings"},"The settings page has been improved to make clear which features are enabled and disabled. A new school district setting has been added because ",c.a.createElement("em",null,"somebody")," had to go and leave CCSD :) so this will ensure that there are no username conflicts with student accounts.")),c.a.createElement(ae.a,{item:!0,xs:12,container:!0,spacing:2},c.a.createElement(ae.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h6"},"Previous Updates")),c.a.createElement(Or,{date:"Jan 31, 2022"}),c.a.createElement(vr,{title:"In Stock and Out of Stock Products"},'Products with a quantity of zero will no longer be visible to students. Teachers will see these products in an "Out of Stock" section on the Products page. Once the product\'s quantity is greater than zero, the product will appear in the "In Stock" section for teachers and will be visible to students.'),c.a.createElement(Or,{date:"Jan 23, 2022"}),c.a.createElement(vr,{title:"Student Account Balances Visible When Processing Song Requests"},"Student account balances are now visible in the song request processing dialog so you can quickly identify with a red/green color indicator if a student has enough points to buy a song request or a song removal request."),c.a.createElement(vr,{title:"Song Totals Visible When Processing Song Requests"},"The total number of song requests to process is now visible in the song request processing dialog along with a running count of requests remaining to process."),c.a.createElement(Or,{date:"Jan 17, 2022"}),c.a.createElement(vr,{title:"Economy View"},"You can now view a summary of details about the account balances for students in your courses including the total number of points available in your economy and an interactive table containing the account balances of all students in all of your courses."),c.a.createElement(vr,{title:"Beta Features Flag"},"A new flag that enables beta features when they are available can now be found in the Account Details section of the Settings page."),c.a.createElement(Or,{date:"Dec 30, 2021"}),c.a.createElement(vr,{title:"Delete Songs"},"Students can now request songs to be removed from thier class playlist by going to the 'Songs' tab and clicking the trash can icon, once you have activated the feature in the Settings."),c.a.createElement(vr,{title:"Delete Songs Settings"},"New settings have been added to control student ability to request songs for deletion as well as settings for the amount of points charged for a song removal and the amount of points refunded to the person whose song was removed."),c.a.createElement(vr,{title:"Search for Products"},"You can now search for products in a dropdown menu when entering purchases on the accounts page and the cost of the product will automatically populate in the amount field."),c.a.createElement(vr,{title:"What's New Notifications"},"This notification is a new feature! When new Chem Cash udpates are released this notification will appear once on the first time you access the website after the update is released.")))},Sr=Object(r.c)((function(e){return Object(J.a)({},e.common)}),(function(e){return{onExit:function(){return e({type:"WHATS_NEW_DIALOG_UNLOADED",payload:Ee.a.Auth.save({viewedChanges:!0})})}}}))((function(e){var t=e.currentUser,a=e.onExit,n=Object(o.useState)(!1),r=Object(le.a)(n,2),l=r[0],s=r[1],i=Object(Te.a)(),u=Object(Ne.a)(i.breakpoints.down("md")),m=function(){s(!1)};return Object(o.useEffect)((function(){t&&s(!t.viewedChanges)}),[t]),c.a.createElement(_e.a,{fullScreen:u,fullWidth:!0,maxWidth:"md",open:l,onClose:m,onClick:function(e){return e.stopPropagation()},onExit:a,onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Pe.a,null,"What's New in Chem Cash!"),c.a.createElement(Re.a,null,"student"===(null===t||void 0===t?void 0:t.role)?yr():jr()),c.a.createElement(we.a,null,c.a.createElement(D.a,{onClick:m,variant:"contained"},"Close")))})),Ar=a(79),Dr=a(448),Cr=a(80),Tr=(a(571),a(424)),Nr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:if(t.subtype===P||"REGISTER"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{inProgress:!0});break;case P:case"REGISTER":return Object(J.a)(Object(J.a)({},e),{},{inProgress:!1,errors:t.error?t.payload.errors:null});case"LOGIN_PAGE_UNLOADED":case"REGISTER_PAGE_UNLOADED":return{};default:return e}return e},_r={appName:"Chem Cash",token:null,viewChangeCounter:0},Pr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_r,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"APP_LOAD":return Object(J.a)(Object(J.a)({},e),{},{token:t.token||null,appLoaded:!0,currentUser:t.payload?t.payload.user:null,settings:t.payload?t.payload.settings:null});case"LOGOUT":return Object(J.a)(Object(J.a)({},e),{},{redirectTo:"/login",token:null,currentUser:null});case P:case"REGISTER":return Object(J.a)(Object(J.a)({},e),{},{redirectTo:t.error?null:"/",token:t.error?null:t.payload.user.token,currentUser:t.error?null:t.payload.user,settings:t.error?null:t.payload.settings});case"LOGIN_PAGE_UNLOADED":case"REGISTER_PAGE_UNLOADED":case"SETTINGS_PAGE_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{viewChangeCounter:e.viewChangeCounter+1});case"NAV_LOADED":case"NAV_TAB_CHANGE":return Object(J.a)(Object(J.a)({},e),{},{redirectTo:t.redirectTo});case"REDIRECT":return Object(J.a)(Object(J.a)({},e),{},{redirectTo:null});case"SETTINGS_SAVED":return Object(J.a)(Object(J.a)({},e),{},{currentUser:t.error?e.currentUser:t.payload[0].user,settings:t.error||"student"===e.currentUser.role?e.settings:t.payload[1].settings});case"SPOTIFY_REMOVE_AUTH":return Object(J.a)(Object(J.a)({},e),{},{settings:t.error?e.settings:Object(J.a)(Object(J.a)({},e.settings),{},{spotifyTokens:void 0})});case"WHATS_NEW_DIALOG_LOADED":case"WHATS_NEW_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{currentUser:t.payload?t.payload.user:null});default:return e}},Rr={courses:[],errors:null,importCount:null,importFailed:null,inProgress:!1,pageLoaded:!1},wr=function(e,t){return e.lastName.localeCompare(t.lastName)},Ur=function(e,t){return e.period-t.period},kr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Rr,t=arguments.length>1?arguments[1]:void 0,a=[];switch(t.type){case"ADD_COURSE":return Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:[].concat(Object(ge.a)(e.courses),[t.payload.course]).sort((function(e,t){return Ur(e,t)})),errors:t.error?t.payload.errors:null,inProgress:!1});case"ADD_STUDENT":return a=[],e.courses.forEach((function(e){var n=Object(J.a)({},e);e._id.toString()===t.courseId&&(n.students=[].concat(Object(ge.a)(e.students),[t.payload.user]).sort((function(e,t){return wr(e,t)}))),a.push(n)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a,errors:t.error?t.payload.errors:null,inProgress:!1});case"ALERT_CLOSED":return Object(J.a)(Object(J.a)({},e),{},{importCount:null,importFailed:null});case _:if("ADD_STUDENT"===t.subtype||"ADD_COURSE"===t.subtype||"MOVE_STUDENT"===t.subtype||"UPDATE_COURSE"===t.subtype||"UPDATE_STUDENT"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0});if("COURSES_PAGE_LOADED"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,pageLoaded:!0});if("IMPORT_STUDENTS"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,importCount:null,importFailed:null,inProgress:!0});break;case"COURSE_DIALOG_UNLOADED":case"STUDENT_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:null});case"COURSES_PAGE_LOADED":case"STUDENT_SEARCH_LOADED":return Object(J.a)(Object(J.a)({},e),{},{courses:t.payload.courses,pageLoaded:!1});case"COURSES_PAGE_UNLOADED":case"STUDENT_SEARCH_UNLOADED":return Rr;case"DELETE_COURSE":return Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:e.courses.filter((function(e){return e.slug!==t.payload.course.slug}))});case"DELETE_STUDENT":return a=[],e.courses.forEach((function(e){var n=Object(J.a)({},e);e._id.toString()===t.payload.course._id.toString()&&(n.students=e.students.filter((function(e){return e.username!==t.payload.user.username}))),a.push(n)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a});case"IMPORT_STUDENTS":return!t.error&&t.payload.course.students.sort((function(e,t){return wr(e,t)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:e.courses.map((function(e){return e._id===t.payload.course._id?t.payload.course:e})),errors:t.error?t.payload.errors:null,importCount:t.error?null:t.payload.count,importFailed:t.error?null:t.payload.failed,inProgress:!1});case"MOVE_STUDENT":return!t.error&&t.payload[0].course.students.sort((function(e,t){return wr(e,t)})),!t.error&&t.payload[1].course.students.sort((function(e,t){return wr(e,t)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:e.courses.map((function(e){return e._id===t.payload[0].course._id?t.payload[0].course:e._id===t.payload[1].course._id?t.payload[1].course:e})),errors:t.error?t.payload.errors:null,inProgress:!1});case"RESET_STUDENT_PASSWORD":return Object(J.a)({},e);case"UPDATE_COURSE":return Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:e.courses.map((function(e){return e._id===t.payload.course._id?t.payload.course:e})).sort((function(e,t){return Ur(e,t)})),errors:t.error?t.payload.errors:null,inProgress:!1});case"UPDATE_STUDENT":a=[];var n=t.payload.user;return e.courses.forEach((function(e){var r=Object(J.a)({},e);e._id.toString()===t.courseId.toString()&&(r.students=e.students.map((function(e){return e._id.toString()===n._id.toString()?n:e})).sort((function(e,t){return wr(e,t)}))),a.push(r)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a,errors:t.error?t.payload.errors:null,inProgress:!1});default:return e}return e},xr={errors:null,inProgress:!1,students:[]},Lr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:if("ECONOMY_DIALOG_LOADED"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0});break;case"ECONOMY_DIALOG_LOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,students:t.error?e.students:t.payload.students});case"ECONOMY_DIALOG_UNLOADED":return Object(J.a)({},xr);default:return e}return e},Ir=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NAV_LOADED":case"NAV_TAB_CHANGE":return Object(J.a)(Object(J.a)({},e),{},{navTabValue:t.value});case"NAV_UNLOADED":return{};default:return e}},qr={errors:null,notifications:[]},Fr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTIFICATION_DIALOG_LOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,notifications:t.error?e.notifications:t.payload.notifications});case"NOTIFICATION_DIALOG_UNLOADED":return qr;default:return e}},Gr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_COURSE":case"ADD_PRODUCT":case"ADD_STUDENT":case"ADD_TEACHER":case"ADD_TRANSACTION":case"ADD_TRANSACTIONS":case"DELETE_COURSE":case"DELETE_PRODUCT":case"DELETE_PURCHASE":case"DELETE_SONG_REQUEST":case"DELETE_STUDENT":case"DELETE_TASK":case"DELETE_TEACHER":case"DELETE_TRANSACTION":case"IMPORT_SCORES":case"IMPORT_STUDENTS":case"MOVE_STUDENT":case"RESET_STUDENT_PASSWORD":case"SETTINGS_SAVED":case"STUDENT_DELETE_PURCHASE":case"SUBMIT_PURCHASE":case"SUBMIT_SONG_REQUEST":case"SUBMIT_SONG_REMOVAL_REQUEST":case"UPDATE_COURSE":case"UPDATE_PRODUCT":case"UPDATE_STUDENT":case"UPDATE_TASK":case"UPDATE_TEACHER":case"UPDATE_TRANSACTION":case"WHATS_NEW_FLAGS_RESET":return Object(J.a)(Object(J.a)({},e),{},{snackbar:t.error?null:t.snackbar});case"SNACKBAR_CLOSED":return Object(J.a)(Object(J.a)({},e),{},{snackbar:null});default:return e}},Br={products:[],errors:null,inProgress:!1,pageLoaded:!1},Wr=function(e,t){return e.cost-t.cost},Hr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Br,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_PRODUCT":return Object(J.a)(Object(J.a)({},e),{},{products:t.error?e.products:[].concat(Object(ge.a)(e.products),[t.payload.product]).sort((function(e,t){return Wr(e,t)})),errors:t.error?t.payload.errors:null,inProgress:!1});case _:if("ADD_PRODUCT"===t.subtype||"UPDATE_PRODUCT"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0});if("PRODUCT_SELECTOR_LOADED"===t.subtype||"PRODUCTS_PAGE_LOADED"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0,pageLoaded:!1});break;case"DELETE_PRODUCT":return Object(J.a)(Object(J.a)({},e),{},{products:t.error?e.products:e.products.filter((function(e){return e.slug!==t.payload.product.slug}))});case"PRODUCT_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:null});case"PRODUCT_SELECTOR_LOADED":case"PRODUCTS_PAGE_LOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,pageLoaded:!0,products:t.error?e.products:t.payload.products});case"PRODUCT_SELECTOR_UNLOADED":case"PRODUCTS_PAGE_UNLOADED":return Br;case"UPDATE_PRODUCT":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,products:t.error?e.products:e.products.map((function(e){return e._id===t.payload.product._id?t.payload.product:e})).sort((function(e,t){return Wr(e,t)}))});default:return e}return e},Mr=a(452),zr=a(451),Vr={cart:{products:[],quantities:{}},courses:[],errors:null,inProgress:!1,purchases:[]},Yr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vr,t=arguments.length>1?arguments[1]:void 0,a=[];switch(t.type){case"ADD_PURCHASE":case"SUBMIT_PURCHASE":return Object(J.a)(Object(J.a)({},e),{},{cart:t.error?e.cart:Vr.cart,errors:t.error?t.payload.errors:null,inProgress:!1});case"ADD_PURCHASE_DIALOG_UNLOADED":return Vr;case"ADD_TO_CART":var n=e.cart.products.findIndex((function(e){return e._id===t.product._id})),r=n>-1,o=r?e.cart.quantities[t.product._id]+1:1,c=t.product.maxPurchaseQuantity,l=t.product.quantity,s=0!==c?Math.min(c,l):l;return Object(J.a)(Object(J.a)({},e),{},{cart:{products:r?e.cart.products:[].concat(Object(ge.a)(e.cart.products),[t.product]),quantities:Object(J.a)(Object(J.a)({},e.cart.quantities),{},Object(he.a)({},t.product._id,o<=s?o:s))}});case _:if("STUDENT_PURCHASES_LOADED"===t.subtype||"TEACHER_PURCHASES_LOADED"===t.subtype||"SUBMIT_PURCHASE"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0});break;case"DELETE_CART_PRODUCT":var i=e.cart.quantities,u=t.productId,m=(i[u],Object(Mr.a)(i,[u].map(zr.a)));return Object(J.a)(Object(J.a)({},e),{},{cart:{products:e.cart.products.filter((function(e){return e._id!==t.productId})),quantities:m}});case"DELETE_PURCHASE":return e.courses.forEach((function(e){var n=Object(J.a)({},e);n.purchases=n.purchases.filter((function(e){return e._id.toString()!==t.payload.purchase._id.toString()})),a.push(n)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a});case"PURCHASES_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:null});case"STUDENT_DELETE_PURCHASE":return Object(J.a)(Object(J.a)({},e),{},{purchases:t.error?e.purchases:e.purchases.filter((function(e){return e._id!==t.payload.purchase._id}))});case"STUDENT_PURCHASES_LOADED":return Object(J.a)(Object(J.a)({},e),{},{purchases:t.error?e.purchases:t.payload.purchases,errors:t.error?t.payload.errors:null,inProgress:!1});case"STUDENT_PURCHASES_UNLOADED":return Object(J.a)(Object(J.a)({},Vr),{},{cart:e.cart});case"TEACHER_PURCHASES_LOADED":return Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:t.payload.courses,errors:t.error?t.payload.errors:null,inProgress:!1});case"TEACHER_PURCHASES_UNLOADED":return Object(J.a)({},Vr);case"UPDATE_CART_PRODUCT_QUANTITY":return Object(J.a)(Object(J.a)({},e),{},{cart:Object(J.a)(Object(J.a)({},e.cart),{},{quantities:Object(J.a)(Object(J.a)({},e.cart.quantities),{},Object(he.a)({},t.productId,t.qty))})});case"UPDATE_PURCHASE":return!t.error&&e.courses.forEach((function(e){var n=Object(J.a)({},e);n.purchases=n.purchases.map((function(e){return e._id.toString()===t.payload.purchase._id.toString()?t.payload.purchase:e})),a.push(n)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a,errors:t.error?t.payload.errors:null,inProgress:!1});default:return e}return e},Qr=a(449),Kr={balance:null,conversions:null,errors:null,importSummary:null,inProgress:!1,total:null,transactions:null},Jr=function(e,t){var a=function(e,t){return e+t.amount},n=e.bonuses.reduce(a,0),r=e.purchases.reduce(a,0),o=e.scores.reduce((function(e,a){return e+ot(a,t)}),0);return{balance:n+r+o,bonuses:n,purchases:r,scores:o}},$r=function(e,t,a){if(a){var n=a._id.toString(),r=e.filter((function(e){return e.student._id.toString()===n}));return r&&(t.scores=Object(Qr.unionBy)(r,Object(ge.a)(t.scores),"_id")),t}return null},Zr=function(e,t){for(var a=0,n=Object.keys(t);a<n.length;a++){var r=n[a];r.startsWith(e.type)&&(t[r]=[e].concat(Object(ge.a)(t[r])))}return t},Xr=function(e,t,a){if(a){var n=a._id.toString(),r=e.find((function(e){return e.student._id.toString()===n}));if(r)return Zr(r,t)}return null},eo=function(e,t){for(var a=0,n=Object.keys(t);a<n.length;a++){var r=n[a];r.startsWith(e.type)&&(t[r]=t[r].filter((function(t){return t._id!==e._id})))}return t},to=function(e,t){for(var a=0,n=Object.keys(t);a<n.length;a++){var r=n[a];r.startsWith(e.type)&&(t[r]=t[r].map((function(t){return t._id===e._id?e:t})))}return t},ao=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ACCOUNT_BALANCE_LOADED":return Object(J.a)(Object(J.a)({},e),{},{balance:t.error?null:Jr(t.payload.transactions,t.payload.scoreConverter)});case"ACCOUNT_BALANCE_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{balance:null});case"STUDENT_CART_LOADED":return Object(J.a)(Object(J.a)({},e),{},{total:t.error?null:Jr(t.payload.transactions,t.payload.scoreConverter)});case"STUDENT_CART_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{total:null});case"ACCOUNT_VIEW_LOADED":return Object(J.a)(Object(J.a)({},e),{},{conversions:t.error?null:t.payload.scoreConverter,total:t.error?null:Jr(t.payload.transactions,t.payload.scoreConverter),transactions:t.error?null:t.payload.transactions});case"ACCOUNT_VIEW_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{conversions:null,total:null,transactions:null});case"ACCOUNTS_PAGE_UNLOADED":case"ALERT_CLOSED":return Object(J.a)(Object(J.a)({},e),{},{importSummary:null});case"ADD_TRANSACTION":var a=t.error?{}:Zr(t.payload.transaction,Object(J.a)({},e.transactions));return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:a,total:t.error?e.total:Jr(a,e.conversions)});case"ADD_PURCHASE":var n=t.error?{}:Zr(t.payload.purchase.purchaseTransaction,Object(J.a)({},e.transactions));return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:n,total:t.error?e.total:Jr(n,e.conversions)});case"ADD_TRANSACTIONS":var r=t.error?null:Xr(t.payload.transactions,Object(J.a)({},e.transactions),t.curStudent);return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:r,total:t.error||!e.transactions?e.total:Jr(r,e.conversions)});case _:if("ADD_TRANSACTION"===t.subtype||"ADD_TRANSACTIONS"===t.subtype||"DELETE_TRANSACTION"===t.subtype||"UPDATE_TRANSACTION"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0});if("IMPORT_SCORES"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,importSummary:null,inProgress:!0});break;case"DELETE_TRANSACTION":var o=t.error?{}:eo(t.payload.transaction,Object(J.a)({},e.transactions));return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:o,total:t.error?e.total:Jr(o,e.conversions)});case"IMPORT_SCORES":var c=t.error?null:$r(t.payload.scores,Object(J.a)({},e.transactions),t.curStudent);return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,importSummary:t.error?null:t.payload.results,inProgress:!1,transactions:t.error?e.transactions:c,total:t.error||!e.transactions?e.total:Jr(c,e.conversions)});case"IMPORT_SCORES_DIALOG_UNLOADED":case"TRANSACTION_DIALOG_UNLOADED":case"TRANSACTIONS_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:null});case"UPDATE_TRANSACTION":var l=t.error?{}:to(t.payload.transaction,Object(J.a)({},e.transactions));return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:l,total:t.error?e.total:Jr(l,e.conversions)});default:return e}return e},no={errors:null,inProgress:!1,spotifyAuthUrl:null},ro=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:no,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:if("SETTINGS_SAVED"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{inProgress:!0});break;case"SPOTIFY_LINKER_LOADED":return Object(J.a)(Object(J.a)({},e),{},{spotifyAuthUrl:t.payload.spotifyAuthUrl});case"SETTINGS_PAGE_UNLOADED":case"SPOTIFY_LINKER_UNLOADED":return no;case"SETTINGS_SAVED":return Object(J.a)(Object(J.a)({},e),{},{inProgress:!1,errors:t.error?t.payload.errors:null});default:return e}return e},oo={errors:null,inProgress:!1,tasks:[]},co=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oo,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:if("TASKS_DIALOG_LOADED"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{inProgress:!0});break;case"DELETE_TASK":return Object(J.a)(Object(J.a)({},e),{},{tasks:t.error?e.tasks:e.tasks.filter((function(e){return e.slug!==t.payload.task.slug}))});case"TASKS_DIALOG_LOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,tasks:t.error?[]:t.payload.tasks});case"TASKS_DIALOG_UNLOADED":return oo;case"UPDATE_TASK":return Object(J.a)(Object(J.a)({},e),{},{tasks:t.error?e.tasks:e.tasks.map((function(e){return e.slug===t.payload.task.slug?t.payload.task:e}))});default:return e}return e},lo={errors:null,inProgress:!1,pageLoaded:!1,teachers:[]},so=function(e,t){return e.lastName.localeCompare(t.lastName)},io=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lo,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TEACHER":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,teachers:t.error?e.teachers:[].concat(Object(ge.a)(e.teachers),[Object(J.a)(Object(J.a)({},t.payload.user),{},{settings:t.payload.settings})]).sort((function(e,t){return so(e,t)}))});case _:if("ADD_TEACHER"===t.subtype||"UPDATE_TEACHER"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{inProgress:!0,errors:null});if("MANAGE_TEACHERS_PAGE_LOADED"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{errors:null,inProgress:!0,pageLoaded:!1});break;case"DELETE_TEACHER":return Object(J.a)(Object(J.a)({},e),{},{teachers:t.error?e.teachers:e.teachers.filter((function(e){return e.username!==t.payload.user.username}))});case"MANAGE_TEACHERS_PAGE_LOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,pageLoaded:!0,teachers:t.payload.users});case"MANAGE_TEACHERS_PAGE_UNLOADED":return lo;case"TEACHER_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:null});case"UPDATE_TEACHER":return Object(J.a)(Object(J.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,teachers:t.error?e.teachers:e.teachers.map((function(e){return e.username===t.payload.user.username?Object(J.a)(Object(J.a)({},e),t.payload.user):e})).sort((function(e,t){return so(e,t)}))});default:return e}return e},uo={course:null,courses:[],courseSongs:[],errors:null,inProgress:!1,userSongs:[]},mo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uo,t=arguments.length>1?arguments[1]:void 0,a=[];switch(t.type){case _:if("UPDATE_SONG_REQUEST"===t.subtype)return Object(J.a)(Object(J.a)({},e),{},{inProgress:!0,errors:null});break;case"DELETE_SONG_REQUEST":return e.courses.forEach((function(e){var n=Object(J.a)({},e);n.songs=n.songs.filter((function(e){return e._id.toString()!==t.payload.song._id.toString()})),a.push(n)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a});case"SONG_REQUESTS_DIALOG_UNLOADED":return Object(J.a)(Object(J.a)({},e),{},{errors:null});case"SONGS_PAGE_UNLOADED":return uo;case"STUDENT_SONGS_PAGE_LOADED":return Object(J.a)(Object(J.a)({},e),{},{userSongs:t.payload.songsByUser,courseSongs:t.payload.songsByCourse,course:t.payload.course});case"SUBMIT_SONG_REQUEST":return Object(J.a)(Object(J.a)({},e),{},{userSongs:[t.payload.song].concat(Object(ge.a)(e.userSongs)),courseSongs:[t.payload.song].concat(Object(ge.a)(e.courseSongs))});case"SUBMIT_SONG_REMOVAL_REQUEST":return Object(J.a)(Object(J.a)({},e),{},{userSongs:e.userSongs.map((function(e){return t.payload.song._id===e._id?t.payload.song:e})),courseSongs:e.courseSongs.map((function(e){return t.payload.song._id===e._id?t.payload.song:e}))});case"TEACHER_SONGS_PAGE_LOADED":return Object(J.a)(Object(J.a)({},e),{},{courses:t.payload.courses});case"UPDATE_SONG_REQUEST":return!t.error&&e.courses.forEach((function(e){var n=Object(J.a)({},e);n.songs=n.songs.map((function(e){return e._id.toString()===t.payload.song._id.toString()?t.payload.song:e})),a.push(n)})),Object(J.a)(Object(J.a)({},e),{},{courses:t.error?e.courses:a,errors:t.error?t.payload.errors:null,inProgress:!1});default:return e}return e},po=function(e){return function(t){return function(a){if((o=a.payload)&&"function"===typeof o.then){e.dispatch({type:_,subtype:a.type});var n=e.getState().viewChangeCounter,r=a.skipTracking;a.payload.then((function(t){var o=e.getState();(r||o.viewChangeCounter===n)&&(a.payload=t,e.dispatch({type:"ASYNC_END",promise:a.payload}),e.dispatch(a))}),(function(t){var o=e.getState();(r||o.viewChangeCounter===n)&&(a.error=!0,a.payload=t.response.body,a.skipTracking||e.dispatch({type:"ASYNC_END",promise:a.payload}),e.dispatch(a))}))}else{var o;t(a)}}}},Eo=function(e){return function(e){return function(t){"REGISTER"===t.type||t.type===P?t.error||(window.localStorage.setItem("jwt",t.payload.user.token),Ee.a.setToken(t.payload.user.token)):"LOGOUT"===t.type&&(window.localStorage.setItem("jwt",""),Ee.a.setToken(null)),e(t)}}};var fo,bo=Object(Cr.a)(),go=Object(Tr.a)(bo),ho=Object(Ar.createStore)((fo=bo,Object(Ar.combineReducers)({auth:Nr,common:Pr,courses:kr,economy:Lr,nav:Ir,notifications:Fr,notifier:Gr,products:Hr,purchases:Yr,scores:ao,settings:ro,tasks:co,teachers:io,songs:mo,router:Object(n.b)(fo)})),Object(Dr.composeWithDevTools)(Object(Ar.applyMiddleware)(go,po,Eo))),Oo=Object(r.c)((function(e){return{appLoaded:e.common.appLoaded,redirectTo:e.common.redirectTo}}),(function(e){return{onLoad:function(t,a){return e({type:"APP_LOAD",payload:t,token:a,skipTracking:!0})},onRedirect:function(){return e({type:"REDIRECT"})}}}))((function(e){var t=e.appLoaded,a=e.redirectTo;return Object(o.useEffect)((function(){a&&(ho.dispatch(Object(u.d)(a)),e.onRedirect())}),[a]),Object(o.useEffect)((function(){var t=window.localStorage.getItem("jwt");t&&Ee.a.setToken(t),e.onLoad(t?Ee.a.Auth.current():null,t)}),[]),t?c.a.createElement(m.a,{theme:O},c.a.createElement(d.a,null),c.a.createElement(hr,null,c.a.createElement(o.Suspense,{fallback:c.a.createElement("p",null,"Loading...")},c.a.createElement(i.d,null,c.a.createElement(i.b,{exact:!0,path:"/login",component:fr}),c.a.createElement(i.b,{exact:!0,path:"/about",component:fr}),c.a.createElement(i.b,{path:"/",component:Jn})))),c.a.createElement(Sr,null)):c.a.createElement(m.a,{theme:O},c.a.createElement(d.a,null),c.a.createElement(ar,null))}));s.a.render(c.a.createElement(r.a,{store:ho},c.a.createElement(n.a,{history:bo},c.a.createElement(i.d,null,c.a.createElement(i.b,{path:"/",component:Oo})))),document.getElementById("root"))}},[[460,1,2]]]);
//# sourceMappingURL=main.e3ac831c.chunk.js.map