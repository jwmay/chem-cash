(this["webpackJsonpchem-cash"]=this["webpackJsonpchem-cash"]||[]).push([[0],{16:function(e,t,a){"use strict";(function(e){var n=a(435),r=a.n(n),o=a(436),c=a.n(o),s=r()(c.a,e.Promise),l="https://chem-cash.herokuapp.com/api",i=encodeURIComponent,u=function(e){return e.body},m=null,d=function(e){m&&e.set("authorization","Token ".concat(m))},p=function(e){return s.del("".concat(l).concat(e)).use(d).then(u)},E=function(e){return s.get("".concat(l).concat(e)).use(d).then(u)},f=function(e,t){return s.post("".concat(l).concat(e),t).use(d).then(u)},b=function(e,t){return s.put("".concat(l).concat(e),t).use(d).then(u)},g={current:function(){return E("/user")},login:function(e,t){return f("/users/login",{user:{username:e,password:t}})},register:function(e){return f("/users",{user:e})},save:function(e){return b("/user",{user:e})}},O={add:function(e){return f("/courses",{course:e})},delete:function(e){return p("/courses/".concat(e))},getAll:function(){return E("/courses")},update:function(e){return b("/courses/".concat(e.slug),{course:e})}},h={getAll:function(e){return E("/scores?username=".concat(e))},import:function(e){return f("/scores/import",{data:e})}},y={update:function(e){return b("/user/settings",{settings:e})}},v={delete:function(e){return p("/songs/".concat(e))},forStudent:function(){return E("/songs/student")},forTeacher:function(){return E("/songs/teacher")},request:function(e){return f("/songs",{song:e})},update:function(e){return b("/songs/".concat(e.id),{song:e})}},S={getAuthUrl:function(){return E("/spotify/auth")},removeAuth:function(){return p("/spotify/auth")}},j={add:function(e,t){return f("/users?courseId=".concat(i(t)),{user:e})},delete:function(e){return p("/users/student/".concat(e.username))},import:function(e,t){return f("/users/import?courseId=".concat(i(t)),{users:e})},update:function(e){return b("/users/".concat(e.username),{user:e})}},A={getAll:function(e){return E("/tasks?courseId=".concat(e))},delete:function(e){return p("/tasks/".concat(e.slug))},update:function(e){return b("/tasks/".concat(e.slug),{task:e})}},D={getAll:function(){return E("/users?role=teacher")},delete:function(e){return p("/users/teacher/".concat(e.username))},update:function(e){return b("/users/".concat(e.username),{user:e})}},N={add:function(e){return f("/transactions",{transaction:e})},addMany:function(e){return f("/transactions/bulk",{transactions:e})},delete:function(e){return p("/transactions/".concat(e._id))},update:function(e){return b("/transactions/".concat(e._id),{transaction:e})}};t.a={Auth:g,Courses:O,Scores:h,Settings:y,Songs:v,Spotify:S,Students:j,Tasks:A,Teachers:D,Transactions:N,setToken:function(e){m=e}}}).call(this,a(79))},274:function(e,t,a){e.exports=a.p+"static/media/chemistry-background.11d1d297.jpg"},430:function(e,t,a){e.exports=a.p+"static/media/chem-cash-logo.30174016.png"},438:function(e,t,a){e.exports=a.p+"static/media/songs-background.cfcd4ce6.jpg"},443:function(e,t,a){e.exports=a.p+"static/media/doc-may-profile.f927335d.jpg"},454:function(e,t,a){e.exports=a(567)},549:function(e,t){},551:function(e,t){},567:function(e,t,a){"use strict";a.r(t);var n=a(155),r=a(11),o=a(0),c=a.n(o),s=a(23),l=a.n(s),i=a(36),u=a(58),m=a(612),d=a(614),p=a(154),E=a(428),f=a.n(E),b=a(429),g=a.n(b),O=Object(p.a)({breakpoints:{values:{md:768,lg:1024}},palette:{primary:f.a,secondary:g.a},overrides:{MuiDialogActions:{root:{padding:"16px 24px"}}}}),h=O,y=a(594),v=a(317),S=a(593),j=a(384),A=a(92),D=a(318),N=a(430),T=a.n(N),C=function(e){return c.a.createElement("img",Object.assign({alt:"Chem Cash Logo",src:T.a},e))},_="ASYNC_START",k="LOGIN",U=Object(v.a)((function(e){return{title:{color:"white",flexGrow:1},logo:{height:65,marginTop:e.spacing(2),marginRight:e.spacing(3),marginBottom:e.spacing(2)}}})),w=Object(r.c)((function(e){return{navTabValue:e.nav.navTabValue}}),(function(e){return{onClickLogout:function(){return e({type:"LOGOUT"})}}}))((function(e){var t=U(),a=e.navTabValue;return e.currentUser?c.a.createElement(S.a,{position:"static"},c.a.createElement(y.a,null,c.a.createElement(j.a,null,c.a.createElement(C,{className:t.logo}),c.a.createElement(A.a,{variant:"h5",align:"center",className:t.title},a&&a.charAt(0).toUpperCase()+a.slice(1)),c.a.createElement(D.a,{color:"inherit",onClick:e.onClickLogout},"Logout")))):null})),P=a(595),x=a(596),R=a(597),L=a(598),I=a(599),G=a(600),F=a(601),q=Object(v.a)({nav:{position:"fixed",bottom:0,width:"100%",zIndex:"1000"}}),B=Object(r.c)((function(e){return{path:e.router.location.pathname,currentUser:e.common.currentUser,navTabValue:e.nav.navTabValue}}),(function(e){return{onTabChange:function(t,a){return e({type:"NAV_TAB_CHANGE",value:t,redirectTo:a})},onLoad:function(t,a){return e({type:"NAV_LOADED",value:t,redirectTo:a})},onUnload:function(){return e({type:"NAV_UNLOADED"})}}}))((function(e){var t=q(),a=e.currentUser.role,n=function(t){e.onTabChange(t,"/".concat(a,"/").concat(t))};return Object(o.useEffect)((function(){var t=e.path.split("/")[2],n=null!==t&&void 0!==t?t:"student"===a?"account":"accounts",r="/".concat(a,"/").concat(n);return e.onLoad(n,r),function(){e.onUnload()}}),[]),"student"===a?c.a.createElement(P.a,{className:t.nav,onChange:function(e,t){n(t)},showLabels:!0,value:e.navTabValue},c.a.createElement(x.a,{label:"Account",icon:c.a.createElement(R.a,null),value:"account"}),c.a.createElement(x.a,{label:"Songs",icon:c.a.createElement(L.a,null),value:"songs"}),c.a.createElement(x.a,{label:"Settings",icon:c.a.createElement(I.a,null),value:"settings"})):c.a.createElement(P.a,{className:t.nav,onChange:function(e,t){n(t)},showLabels:!0,value:e.navTabValue},c.a.createElement(x.a,{label:"Accounts",icon:c.a.createElement(R.a,null),value:"accounts"}),c.a.createElement(x.a,{label:"Courses",icon:c.a.createElement(G.a,null),value:"courses"}),c.a.createElement(x.a,{label:"Songs",icon:c.a.createElement(L.a,null),value:"songs"}),"admin"===a&&c.a.createElement(x.a,{label:"Teachers",icon:c.a.createElement(F.a,null),value:"teachers"}),c.a.createElement(x.a,{label:"Settings",icon:c.a.createElement(I.a,null),value:"settings"}))})),W=Object(v.a)((function(e){return{wrapper:{marginTop:e.spacing(4),marginBottom:e.spacing(11)}}})),M=function(e){var t=W();return c.a.createElement("div",{className:t.wrapper},e.children)},H=function(e){return c.a.createElement(M,null,c.a.createElement(y.a,null,c.a.createElement(A.a,{variant:"h2"},"Error 404: Page Not Found")))},V=Object(r.c)((function(e){return{currentUser:e.common.currentUser}}),(function(){return{}}))((function(e){return e.currentUser?c.a.createElement(i.b,{exact:!0,path:e.path,component:e.component}):c.a.createElement(i.a,{to:"/"})})),z=a(37),K=a.n(z),Q=a(60),Y=a(6),J=a(17),$=a(25),Z=a(21),X=a(604),ee=a(178),te=a(603),ae=a(605),ne=a(642),re=Object(v.a)((function(e){return{alert:{width:"100%","&:not(:last-of-type)":{marginBottom:e.spacing(1)}},alertList:{marginBottom:e.spacing(2)}}})),oe=function(e){var t=e.errors,a=re();return t?c.a.createElement("div",{className:a.alertList},Object.keys(t).map((function(e){var n=e.replace(/([a-z0-9])([A-Z])/g,"$1 $2").toLowerCase();return c.a.createElement(ne.a,{className:a.alert,severity:"error",key:e},n," ",t[e])}))):null},ce=Object(v.a)((function(e){return{headerLeft:{alignItems:"center",display:"flex"},headerRight:{alignItems:"center",display:"flex",justifyContent:"flex-end"},pageHeader:{marginBottom:e.spacing(4)}}})),se=function(e){var t=e.children,a=e.title,n=ce();return c.a.createElement(te.a,{container:!0,spacing:2,className:n.pageHeader},c.a.createElement(te.a,{item:!0,xs:12,md:6,className:n.headerLeft},c.a.createElement(A.a,{variant:"h4"},a)),c.a.createElement(te.a,{item:!0,xs:12,md:6,className:n.headerRight},t))},le=a(16),ie=Object(v.a)((function(e){return{icon:{marginRight:e.spacing(1)},paper:{padding:e.spacing(2),marginBottom:e.spacing(4)}}})),ue=Object(r.c)((function(e){return Object(Y.a)(Object(Y.a)({},e.settings),{},{currentUser:e.common.currentUser,settings:e.common.settings})}),(function(e){return{onSubmitForm:function(t){return e({type:"SETTINGS_SAVED",payload:Promise.all([le.a.Auth.save(t),le.a.Settings.update(t)]),snackbar:{message:"Settings saved",variant:"success"}})},onUnload:function(){return e({type:"SETTINGS_PAGE_UNLOADED"})}}}))((function(e){var t,a,n,r,s,l,i=e.currentUser,u=e.errors,m=e.inProgress,d=e.onSubmitForm,p=e.onUnload,E=e.settings,f=ie();return Object(o.useEffect)((function(){return function(){p()}}),[]),c.a.createElement(J.c,{enableReinitialize:!0,initialValues:{defaultStudentPassword:(null===E||void 0===E?void 0:E.defaultStudentPassword)||"",songRequestPurchaseAmount:(null===E||void 0===E?void 0:E.songRequestPurchaseAmount)||0,firstName:i.firstName,lastName:i.lastName,password:"",score100:(null===E||void 0===E||null===(t=E.scoreConverter)||void 0===t?void 0:t[100])||1200,score90:(null===E||void 0===E||null===(a=E.scoreConverter)||void 0===a?void 0:a[90])||1e3,score80:(null===E||void 0===E||null===(n=E.scoreConverter)||void 0===n?void 0:n[80])||800,score70:(null===E||void 0===E||null===(r=E.scoreConverter)||void 0===r?void 0:r[70])||600,score60:(null===E||void 0===E||null===(s=E.scoreConverter)||void 0===s?void 0:s[60])||0,score50:(null===E||void 0===E||null===(l=E.scoreConverter)||void 0===l?void 0:l[50])||0},validationSchema:Z.b({defaultStudentPassword:Z.c(),songRequestPurchaseAmount:Z.a().typeError("Numbers only"),firstName:Z.c(),lastName:Z.c(),password:Z.c(),score100:Z.a().typeError("Numbers only"),score90:Z.a().typeError("Numbers only"),score80:Z.a().typeError("Numbers only"),score70:Z.a().typeError("Numbers only"),score60:Z.a().typeError("Numbers only"),score50:Z.a().typeError("Numbers only")}),onSubmit:function(){var e=Object(Q.a)(K.a.mark((function e(t,a){var n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=Object(Y.a)({},t)).password||"student"===i.role||delete n.password,"student"!==i.role&&(n.scoreConverter={100:t.score100,90:t.score90,80:t.score80,70:t.score70,60:t.score60,50:t.score50,40:0,30:0,20:0,10:0,0:0}),d(n),a.resetForm({values:Object(Y.a)(Object(Y.a)({},n),{},{password:""})});case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},c.a.createElement(J.b,null,c.a.createElement(se,{title:"Manage Account"},c.a.createElement(X.a,{color:"primary",disabled:m,type:"sumbit",variant:"extended"},c.a.createElement(ae.a,{className:f.icon}),m?"Saving...":"Save settings")),c.a.createElement(oe,{errors:u}),"student"!==i.role&&c.a.createElement(ee.a,{className:f.paper},c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Song Requests")),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{component:$.a,label:"Song request purchase amount",name:"songRequestPurchaseAmount",type:"text",variant:"outlined",fullWidth:!0})))),"student"!==i.role&&c.a.createElement(ee.a,{className:f.paper},c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Student Accounts")),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{component:$.a,label:"Default student password",name:"defaultStudentPassword",type:"text",variant:"outlined",fullWidth:!0})))),"student"!==i.role&&c.a.createElement(ee.a,{className:f.paper},c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Score Conversions")),c.a.createElement(te.a,{item:!0,xs:12,md:2},c.a.createElement(J.a,{component:$.a,label:"100% and up",name:"score100",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:2},c.a.createElement(J.a,{component:$.a,label:"90% and up",name:"score90",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:2},c.a.createElement(J.a,{component:$.a,label:"80% and up",name:"score80",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:2},c.a.createElement(J.a,{component:$.a,label:"70% and up",name:"score70",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:2},c.a.createElement(J.a,{component:$.a,label:"60% and up",name:"score60",type:"number",variant:"outlined",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:2},c.a.createElement(J.a,{component:$.a,label:"50% and up",name:"score50",type:"number",variant:"outlined",fullWidth:!0})))),"student"!==i.role&&c.a.createElement(ee.a,{className:f.paper},c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Account Details")),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{component:$.a,label:"First name",name:"firstName",type:"text",variant:"outlined",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{component:$.a,label:"Last name",name:"lastName",type:"text",variant:"outlined",fullWidth:!0})))),c.a.createElement(ee.a,{className:f.paper},c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(A.a,{variant:"h5",gutterBottom:!0},"Account Security")),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{component:$.a,label:"New password",name:"password",type:"password",variant:"outlined",fullWidth:!0}))))))})),me=a(32),de=a(14),pe=a(127),Ee=a.n(pe),fe=a(626),be=a(627),ge=a(391),Oe=a(263),he=Object(v.a)((function(e){return{actionButton:{color:e.palette.text.disabled}}})),ye=function(e){var t=he();return c.a.createElement(ge.a,{arrow:!0,enterTouchDelay:0,title:e.action},c.a.createElement(Oe.a,{"aria-label":e.action,className:"".concat(t.actionButton," ").concat(e.className),onClick:function(t){t.stopPropagation(),e.onClick()},onFocus:function(e){return e.stopPropagation()},size:e.size},e.children))},ve=a(606),Se=a(616),je=a(607),Ae=a(615),De=a(608),Ne=a(623),Te=Object(r.c)((function(e){return{defaultStudentPassword:e.common.settings.defaultStudentPassword}}),(function(e){return{onSubmit:function(t){return e({type:"RESET_STUDENT_PASSWORD",payload:le.a.Students.update(t),snackbar:{message:"Password reset",variant:"success"}})}}}))((function(e){var t=e.btnSize,a=e.defaultStudentPassword,n=e.onSubmit,r=e.student,s=Object(o.useState)(!1),l=Object(de.a)(s,2),i=l[0],u=l[1],m=function(){u(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(ye,{action:"Reset password",onClick:function(){u(!0)},size:null!==t&&void 0!==t?t:"small"},c.a.createElement(Ne.a,{fontSize:"inherit"})),c.a.createElement(ve.a,{open:i,onClose:m,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Se.a,null,"Reset Password"),c.a.createElement(je.a,null,c.a.createElement(Ae.a,null,"Do you want to reset"," ",c.a.createElement("b",null,r.firstName," ",r.lastName),"'s password to ",c.a.createElement("strong",null,a),"?")),c.a.createElement(De.a,null,c.a.createElement(D.a,{onClick:function(){var e=Object(Y.a)(Object(Y.a)({},r),{},{password:a});n(e),u(!1)},color:"primary",variant:"contained",autoFocus:!0},"Reset"),c.a.createElement(D.a,{onClick:m,variant:"contained"},"Cancel"))))})),Ce=a(26),_e=a(586),ke=a(624),Ue=a(625),we=Object(v.a)((function(e){return{root:{}}})),Pe=Object(r.c)((function(e){return Object(Y.a)({},e.scores)}),(function(e){return{onAdd:function(t){return e({type:"ADD_TRANSACTION",payload:le.a.Transactions.add(t),snackbar:{message:"".concat(t.typeTitle," added"),variant:"success"}})},onExit:function(){return e({type:"TRANSACTION_DIALOG_UNLOADED"})}}}))((function(e){var t=e.errors,a=e.inProgress,n=e.onAdd,r=e.onExit,s=e.student,l=e.transaction,i=e.type,u=Object(o.useState)(!1),m=Object(de.a)(u,2),d=m[0],p=m[1],E=Object(Ce.a)(),f=Object(_e.a)(E.breakpoints.down("md")),b=(we(),function(){p(!1)}),g=function(e){n(Object(Y.a)(Object(Y.a)({},e),{},{student:s,type:i.toLowerCase(),typeTitle:i}))};return Object(o.useEffect)((function(){a||t||p(!1)}),[a]),c.a.createElement(c.a.Fragment,null,c.a.createElement(ye,{action:"Add ".concat(i.toLowerCase()),onClick:function(){p(!0)}},"Bonus"===i&&c.a.createElement(ke.a,null),"Purchase"===i&&c.a.createElement(Ue.a,null)),c.a.createElement(ve.a,{fullScreen:f,onClick:function(e){return e.stopPropagation()},onClose:b,onExit:r,onFocus:function(e){return e.stopPropagation()},open:d},c.a.createElement(J.c,{initialValues:{amount:(null===l||void 0===l?void 0:l.amount)||"",description:(null===l||void 0===l?void 0:l.description)||""},validationSchema:Z.b({amount:Z.a().typeError("Numbers only").required("Required"),description:Z.c().required("Required")}),onSubmit:function(){var e=Object(Q.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l||g(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement(J.b,null,c.a.createElement(Se.a,null,"".concat(l?"Edit":"Add"," ").concat(i)),c.a.createElement(je.a,null,c.a.createElement(oe,{errors:t}),c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{autoFocus:!l,color:"primary",component:$.a,disabled:a,label:"Description",name:"description",type:"text",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{color:"primary",component:$.a,disabled:a,label:"Amount",name:"amount",type:"text",fullWidth:!0})))),c.a.createElement(De.a,null,c.a.createElement(D.a,{disabled:a,color:"primary",type:"submit",variant:"contained"},l?a?"Updating...":"Update":a?"Adding...":"Add"),c.a.createElement(D.a,{disabled:a,onClick:b,variant:"contained"},"Cancel"))))))})),xe=function(e,t){var a=e.task.totalPoints,n=0===a?1:a,r=Math.round(e.value/n*100);return t[10*Math.floor((r>100?100:r)/10)]},Re=Object(v.a)((function(e){return{actions:{alignItems:"flex-start",display:"flex",justifyContent:"flex-end"},balance:{textAlign:"center","& > h6":{borderTop:"1px solid #ccc",fontStyle:"italic",textTransform:"lowercase"}},edit:{backgroundColor:e.palette.primary.main},paper:{padding:e.spacing(2)},subtotal:{position:"relative",textAlign:"center","& > p":{position:"relative",bottom:-e.spacing(1)},"& > h6":{fontSize:e.typography.pxToRem(12),fontStyle:"italic",textTransform:"lowercase"}},unit:{fontSize:e.typography.pxToRem(12)}}})),Le=function(e){var t=e.canEdit,a=e.doEdit,n=e.onEditClick,r=e.student,o=e.total,s=Re();return c.a.createElement(ee.a,{className:s.paper},c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12,md:4},c.a.createElement(A.a,{gutterBottom:!0,variant:"h5"},r.firstName," ",r.lastName),r.course&&c.a.createElement(A.a,{color:"textSecondary",variant:"subtitle1"},r.course," \xb7 Period ",r.period)),c.a.createElement(te.a,{item:!0,xs:12,md:4,container:!0},c.a.createElement(te.a,{item:!0,xs:12,className:s.balance},c.a.createElement(A.a,{color:(null===o||void 0===o?void 0:o.balance)>=0?"primary":"secondary",variant:"h4"},null===o||void 0===o?void 0:o.balance," ",c.a.createElement("span",{className:s.unit},"pts")),c.a.createElement(A.a,{color:"textSecondary",variant:"subtitle2"},"Balance")),c.a.createElement(te.a,{item:!0,xs:4,className:s.subtotal},c.a.createElement(A.a,{color:"primary",variant:"body1"},null===o||void 0===o?void 0:o.bonuses," ",c.a.createElement("span",{className:s.unit},"pts")),c.a.createElement(A.a,{color:"primary",variant:"subtitle2"},"Bonuses")),c.a.createElement(te.a,{item:!0,xs:4,className:s.subtotal},c.a.createElement(A.a,{color:"secondary",variant:"body1"},null===o||void 0===o?void 0:o.purchases," ",c.a.createElement("span",{className:s.unit},"pts")),c.a.createElement(A.a,{color:"secondary",variant:"subtitle2"},"Purchases")),c.a.createElement(te.a,{item:!0,xs:4,className:s.subtotal},c.a.createElement(A.a,{color:"primary",variant:"body1"},null===o||void 0===o?void 0:o.scores," ",c.a.createElement("span",{className:s.unit},"pts")),c.a.createElement(A.a,{color:"primary",variant:"subtitle2"},"Assessments"))),t&&c.a.createElement(te.a,{item:!0,xs:12,md:4,className:s.actions},c.a.createElement(Pe,{student:r,type:"Bonus"}),c.a.createElement(Pe,{student:r,type:"Purchase"}),c.a.createElement(ye,{action:a?"Finish editing":"Edit transactions",className:a&&s.edit,onClick:n},a?c.a.createElement(fe.a,null):c.a.createElement(be.a,null)),c.a.createElement(Te,{btnSize:"medium",student:r}))))},Ie=function(e){var t=e.conversions,a=e.doEdit,n=e.onDelete,r=e.onUpdate,s=e.transactions,l=Object(o.useState)([]),i=Object(de.a)(l,2),u=i[0],m=i[1],d=function(e){return{amount:e.amount,createdAt:new Date(e.createdAt).toDateString(),description:e.description,type:e.type,_id:e._id}},p=function(e){var n=e.bonuses,r=e.purchases,o=e.scores,c=[].concat(Object(me.a)(n.map((function(e){return d(e)}))),Object(me.a)(r.map((function(e){return d(e)}))));return a?c:[].concat(Object(me.a)(c),Object(me.a)(o.map((function(e){return function(e){return{amount:xe(e,t),createdAt:(new Date).toDateString(),description:e.task.title,type:"assessment"}}(e)}))))},E=Object(o.useState)([{title:"Date",field:"createdAt",editable:"never",defaultSort:"desc"},{title:"Description",field:"description"},{title:"Amount",field:"amount"},{title:"Type",field:"type",editable:"never"}]),f=Object(de.a)(E,1)[0];return Object(o.useEffect)((function(){s&&m(p(s))}),[a,s]),c.a.createElement(Ee.a,{columns:f,data:u,localization:{body:{emptyDataSourceMessage:"No activity to report",editRow:{deleteText:"Delete this transaction?"}}},options:{actionsColumnIndex:-1,paging:!1,toolbar:!1},editable:a?{onRowUpdate:function(e,t){return new Promise((function(a,n){var o=Object(me.a)(u);o[t.tableData.id]=e,m(Object(me.a)(o)),r(e),a()}))},onRowDelete:function(e){return new Promise((function(t,a){var r=Object(me.a)(u),o=e.tableData.id;r.splice(o,1),m(Object(me.a)(r)),n(e),t()}))}}:{}})},Ge=Object(r.c)((function(e){return{conversions:e.scores.conversions,total:e.scores.total,transactions:e.scores.transactions}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_TRANSACTION",payload:le.a.Transactions.delete(t),snackbar:{message:"Transaction deleted",variant:"success"}})},onLoad:function(t){return e({type:"ACCOUNT_VIEW_LOADED",payload:le.a.Scores.getAll(t)})},onUnload:function(){return e({type:"ACCOUNT_VIEW_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_TRANSACTION",payload:le.a.Transactions.update(t),snackbar:{message:"Transaction updated",variant:"success"}})}}}))((function(e){var t=e.canEdit,a=e.conversions,n=e.onDelete,r=e.onLoad,s=e.onUnload,l=e.onUpdate,i=e.student,u=e.total,m=e.transactions,d=Object(o.useState)(!1),p=Object(de.a)(d,2),E=p[0],f=p[1];return Object(o.useEffect)((function(){return function(){s()}}),[]),Object(o.useEffect)((function(){r(i.username)}),[i]),c.a.createElement(c.a.Fragment,null,m&&c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(Le,{canEdit:t,doEdit:E,onEditClick:function(){f(!E)},student:i,total:u})),c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(Ie,{conversions:a,doEdit:E,onDelete:n,onUpdate:l,transactions:m}))))})),Fe=Object(r.c)((function(e){return{currentUser:e.common.currentUser}}),(function(){return{}}))((function(e){var t=e.currentUser;return c.a.createElement(Ge,{student:t})})),qe=a(395),Be=a(389),We=a(320),Me=a(276),He=a(622),Ve=a(404),ze=a(399),Ke=a(394),Qe=a(629),Ye=a(628),Je=a(438),$e=a.n(Je),Ze=Object(v.a)((function(e){return{button:{marginBottom:e.spacing(2),marginRight:e.spacing(2)},dialog:{backgroundImage:"url(".concat($e.a,")"),backgroundPosition:"center bottom",backgroundSize:"cover",color:"white",padding:e.spacing(4)},icon:{marginRight:e.spacing(1)},input:{backgroundColor:"rgba(0,65,91,0.8)",borderRadius:e.spacing(1),height:78,"& input":{color:e.palette.secondary.main}},inputLabel:{color:"white"}}})),Xe=Object(r.c)((function(){return{}}),(function(e){return{onSubmit:function(t){return e({type:"SUBMIT_SONG_REQUEST",payload:le.a.Songs.request(t),snackbar:{message:"Song requested",variant:"success"}})}}}))((function(e){var t=e.onSubmit,a=Object(o.useState)(!1),n=Object(de.a)(a,2),r=n[0],s=n[1],l=Object(Ce.a)(),i=Object(_e.a)(l.breakpoints.down("md")),u=Ze(),m=function(){s(!1)},d=function(e){t(e),s(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(X.a,{color:"primary",onClick:function(){s(!0)},variant:"extended"},c.a.createElement(Ye.a,{className:u.icon}),"Buy a song"),c.a.createElement(ve.a,{classes:{paper:u.dialog},fullScreen:i,open:r,onClose:m},c.a.createElement(A.a,{variant:"h3",align:"center",color:"secondary",gutterBottom:!0},"Purchase a Song"),c.a.createElement(A.a,{variant:"body1",gutterBottom:!0},"Please provide the song and artist title for your request. If approved, 500 points will be charged to your account."),c.a.createElement(J.c,{initialValues:{artist:"",title:""},validationSchema:Z.b({artist:Z.c().required("Required"),title:Z.c().required("Required")}),onSubmit:function(){var e=Object(Q.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement(J.b,null,c.a.createElement(te.a,{container:!0,spacing:4},c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{autoFocus:!0,className:u.input,color:"primary",component:$.a,InputLabelProps:{classes:{root:u.inputLabel}},label:"Song Title",name:"title",type:"text",variant:"filled",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{className:u.input,color:"primary",component:$.a,InputLabelProps:{classes:{root:u.inputLabel}},label:"Artist",name:"artist",type:"text",variant:"filled",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(D.a,{className:u.button,color:"primary",type:"submit",variant:"contained"},"Buy"),c.a.createElement(D.a,{className:u.button,onClick:m,variant:"contained"},"Cancel")))))))})),et=Object(v.a)((function(e){return{icon:{marginLeft:e.spacing(1)},paper:{paddingLeft:e.spacing(2),marginBottom:e.spacing(4)},status:{alignItems:"center",display:"flex"}}})),tt=function(e){var t=e.song,a=e.showStudent,n=et();return c.a.createElement(qe.a,null,c.a.createElement(Be.a,null,new Date(t.createdAt).toDateString()),c.a.createElement(Be.a,null,t.title),c.a.createElement(Be.a,null,t.artist),a&&c.a.createElement(Be.a,null,t.student.firstName," ",t.student.lastName),c.a.createElement(Be.a,null,c.a.createElement("span",{className:n.status},t.statusDescription?c.a.createElement(c.a.Fragment,null,t.status,c.a.createElement(ge.a,{arrow:!0,color:"primary",enterTouchDelay:0,title:t.statusDescription},c.a.createElement(Qe.a,{className:n.icon}))):t.status)))},at=function(e){var t=e.songs;return t.length>0?t.map((function(e){return c.a.createElement(tt,{key:e._id,song:e,showStudent:!0})})):c.a.createElement(qe.a,null,c.a.createElement(Be.a,{colSpan:"5"},c.a.createElement(A.a,{align:"center"},"No songs have been requested for your period")))},nt=function(e){var t=e.songs;return t.length>0?t.map((function(e){return c.a.createElement(tt,{key:e._id,song:e,showStudent:!1})})):c.a.createElement(qe.a,null,c.a.createElement(Be.a,{colSpan:"4"},c.a.createElement(A.a,{align:"center"},"You have not requested any songs")))},rt=Object(r.c)((function(e){return Object(Y.a)(Object(Y.a)({},e.songs),{},{currentUser:e.common.currentUser})}),(function(e){return{onLoad:function(t){return e({type:"STUDENT_SONGS_PAGE_LOADED",payload:t})},onUnload:function(){return e({type:"SONGS_PAGE_UNLOADED"})}}}))((function(e){var t=e.course,a=e.courseSongs,n=e.currentUser,r=e.onLoad,s=e.onUnload,l=e.userSongs,i=Object(o.useState)(!0),u=Object(de.a)(i,2),m=u[0],d=u[1],p=et();return Object(o.useEffect)((function(){return r(le.a.Songs.forStudent()),function(){return s()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(se,{title:"Songs for "+(m?n.firstName:"Period "+t.period)},c.a.createElement(Xe,null)),c.a.createElement(ee.a,{className:p.paper},c.a.createElement(te.a,{container:!0,spacing:2,className:p.grid},c.a.createElement(te.a,{item:!0,xs:12,className:p.grid},c.a.createElement(We.a,{control:c.a.createElement(Me.a,{checked:m,onChange:function(e){d(e.target.checked)},name:"mySongsOnly"}),label:"show only my songs"})))),c.a.createElement(He.a,{component:ee.a},c.a.createElement(Ve.a,null,c.a.createElement(ze.a,null,c.a.createElement(qe.a,null,c.a.createElement(Be.a,null,"Request Date"),c.a.createElement(Be.a,null,"Song Title"),c.a.createElement(Be.a,null,"Song Artist"),!m&&c.a.createElement(Be.a,null,"Purchased by"),c.a.createElement(Be.a,null,"Status"))),c.a.createElement(Ke.a,null,m?c.a.createElement(nt,{songs:l}):c.a.createElement(at,{songs:a})))))})),ot=a(584),ct=Object(v.a)((function(e){return{alert:{marginBottom:e.spacing(2)}}})),st=Object(r.c)((function(){return{}}),(function(e){return{onClose:function(){return e({type:"ALERT_CLOSED"})}}}))((function(e){var t=e.children,a=e.onClose,n=e.severity,r=e.variant,s=ct(),l=Object(o.useState)(!0),i=Object(de.a)(l,2),u=i[0],m=i[1];return c.a.createElement("div",{className:s.alert},c.a.createElement(ot.a,{in:u},c.a.createElement(ne.a,{action:c.a.createElement(Oe.a,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){m(!1),a()}},c.a.createElement(fe.a,{fontSize:"inherit"})),severity:n||"info",variant:r||"outlined"},t)))})),lt=a(319),it=a(644),ut=a(439),mt=a.n(ut),dt=a(440),pt=a.n(dt),Et=Object(v.a)((function(e){return{search:{padding:e.spacing(2)}}})),ft=Object(r.c)((function(e){return{courses:e.courses.courses}}),(function(e){return{onLoad:function(){return e({type:"STUDENT_SEARCH_LOADED",payload:le.a.Courses.getAll()})},onUnload:function(){return e({type:"STUDENT_SEARCH_UNLOADED"})}}}))((function(e){var t=e.courses,a=e.onChange,n=e.onLoad,r=e.onUnload,s=Object(o.useState)([]),l=Object(de.a)(s,2),i=l[0],u=l[1],m=Et();return Object(o.useEffect)((function(){return n(),function(){r()}}),[]),Object(o.useEffect)((function(){var e=t.map((function(e){return e.students.map((function(t){return Object(Y.a)(Object(Y.a)({},t),{},{course:e.name,period:e.period,name:"".concat(t.firstName," ").concat(t.lastName)})}))})).flat();u(e)}),[t]),c.a.createElement(ee.a,{className:m.search},c.a.createElement(it.a,{autoHighlight:!0,getOptionLabel:function(e){return e.name},groupBy:function(e){return"".concat(e.course," | Period ").concat(e.period)},noOptionsText:"No students have been added",onChange:function(e,t){return a(t)},options:i,renderInput:function(e){return c.a.createElement(lt.a,Object.assign({},e,{label:"Student",placeholder:"Type or select a name"}))},renderOption:function(e,t){var a=t.inputValue,n=pt()(e.name,a),r=mt()(e.name,n);return c.a.createElement("div",null,r.map((function(e,t){return c.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})))}}))})),bt=a(241),gt=a(390),Ot=a(620),ht=a(398),yt=a(630),vt=a(631),St=a(69),jt=Object(v.a)((function(e){return{courses:{"& div":{boxShadow:e.shadows[4],cursor:"pointer",marginBottom:e.spacing(1),padding:"".concat(e.spacing(3),"px ").concat(e.spacing(4),"px"),transition:"all 0.15s ease-in-out","&:focus":{backgroundColor:e.palette.primary.main,boxShadow:e.shadows[1]},"&:hover":{backgroundColor:e.palette.primary.light,boxShadow:e.shadows[1]}}}}})),At=Object(r.c)((function(e){return{courses:e.courses.courses}}),(function(){return{}}))((function(e){var t=e.courses,a=e.onSelect,n=jt();return c.a.createElement("div",null,c.a.createElement(A.a,{gutterBottom:!0,variant:"h6"},"Select a course"),t.length>0?c.a.createElement("div",{className:n.courses},t.map((function(e){return c.a.createElement("div",{key:e.slug,onClick:function(){a(e)},tabIndex:"0"},c.a.createElement(A.a,{variant:"body1"},c.a.createElement("b",null,e.name)," \xb7 Period ",e.period))}))):c.a.createElement(ne.a,{severity:"info"},"You must create a course before continuing"))})),Dt=function(e){var t=e.course,a=e.onSelect,n=Object(o.useState)([]),r=Object(de.a)(n,2),s=r[0],l=r[1],i=t.students.map((function(e){return{username:e.username,firstName:e.firstName,lastName:e.lastName,fullName:"".concat(e.firstName," ").concat(e.lastName),role:e.role,_id:e._id}})),u=Object(o.useState)([{title:"Students",field:"fullName"}]),m=Object(de.a)(u,1)[0];return Object(o.useEffect)((function(){l(i)}),[t]),c.a.createElement(Ee.a,{columns:m,data:s,localization:{body:{emptyDataSourceMessage:"No students found for this course"},toolbar:{nRowsSelected:"{0} student(s) selected"}},onSelectionChange:function(e){return a(e)},options:{paging:!1,selection:!0,toolbar:!0},title:"".concat(t.name," | Period ").concat(t.period)})},Nt=Object(v.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(St.a)({},e.breakpoints.up("lg"),{width:e.spacing(80)})}}})),Tt=Object(r.c)((function(e){return Object(Y.a)({},e.scores)}),(function(e){return{onAdd:function(t,a){return e({type:"ADD_TRANSACTIONS",payload:le.a.Transactions.addMany(t),curStudent:a,snackbar:{message:"".concat(t.typeTitle," added"),variant:"success"}})},onExit:function(){return e({type:"TRANSACTIONS_DIALOG_UNLOADED"})}}}))((function(e){var t=e.curStudent,a=e.errors,n=e.inProgress,r=e.isClosed,s=e.isOpen,l=e.onAdd,i=e.onExit,u=e.type,m=Object(o.useState)(!1),d=Object(de.a)(m,2),p=d[0],E=d[1],f=Object(o.useState)(null),b=Object(de.a)(f,2),g=b[0],O=b[1],h=Object(o.useState)([]),y=Object(de.a)(h,2),v=y[0],S=y[1],j=Object(Ce.a)(),A=Object(_e.a)(j.breakpoints.down("md")),N=Nt(),T=function(){E(!1),O(null),r()},C=function(e){l(Object(Y.a)(Object(Y.a)({},e),{},{students:v.map((function(e){return e._id})),type:"Bonuses"===u?"bonus":"purchase",typeTitle:u}),t)};return Object(o.useEffect)((function(){n||a||T()}),[n]),Object(o.useEffect)((function(){E(s)}),[s]),c.a.createElement(ve.a,{className:N.dialog,fullScreen:A,onClick:function(e){return e.stopPropagation()},onClose:T,onExit:i,onFocus:function(e){return e.stopPropagation()},open:p},c.a.createElement(J.c,{initialValues:{amount:"",description:""},validationSchema:Z.b({amount:Z.a().typeError("Numbers only").required("Required"),description:Z.c().required("Required")}),onSubmit:function(){var e=Object(Q.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement(J.b,null,c.a.createElement(Se.a,null,"Add ",u),c.a.createElement(je.a,null,c.a.createElement(oe,{errors:a}),!g&&c.a.createElement(At,{onSelect:function(e){O(e)}}),g&&c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{autoFocus:!0,color:"primary",component:$.a,disabled:n,label:"Description",name:"description",type:"text",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{color:"primary",component:$.a,disabled:n,label:"Amount",name:"amount",type:"text",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(Dt,{course:g,onSelect:function(e){S(e)}})))),c.a.createElement(De.a,null,c.a.createElement(D.a,{disabled:n||0===v.length,color:"primary",type:"submit",variant:"contained"},n?"Adding...":"Add"),c.a.createElement(D.a,{disabled:n,onClick:T,variant:"contained"},"Cancel")))))})),Ct=a(272),_t=a(258),kt=a(577),Ut=a(446),wt=a(442),Pt=a.n(wt),xt=Object(v.a)((function(e){return{filedrop:{alignItems:"center",backgroundColor:e.palette.grey[300],borderRadius:e.spacing(1),color:e.palette.grey[600],display:"flex",flexDirection:"column",outline:"none",padding:"20px",transition:"all 0.25s ease-in-out"},filedropActive:{backgroundColor:e.palette.primary.light,color:e.palette.primary.contrastText},filedropReject:{backgroundColor:e.palette.secondary.light,color:e.palette.secondary.contrastText}}}));var Rt=function(e){var t=e.onFiledrop,a=xt(),n=Object(o.useCallback)((function(e){e.forEach((function(e){var a=new FileReader;a.onabort=function(){return console.log("file reading was aborted")},a.onerror=function(){return console.log("file reading has failed")},a.onload=function(){var e=Pt()(a.result,{columns:!0,skip_empty_lines:!0});t(e)},a.readAsBinaryString(e)}))}),[]),r=Object(Ut.a)({accept:"text/csv, text/plain",multiple:!1,onDropAccepted:n}),s=r.getRootProps,l=r.getInputProps,i=r.isDragActive,u=r.isDragReject;return c.a.createElement("div",s({className:"".concat(a.filedrop," ").concat(i?a.filedropActive:""," ").concat(u?a.filedropReject:"")}),c.a.createElement("input",l()),!i&&c.a.createElement(A.a,null,"Drop a .csv file here or click to select a .csv file"),i&&!u&&c.a.createElement(A.a,null,"Drop .csv file here"),u&&c.a.createElement(A.a,null,"File type not accepted"))},Lt=a(387),It=Object(v.a)((function(e){return{message:{fontStyle:"italic"},root:{alignItems:"center",display:"flex",justifyContent:"center",minWidth:e.spacing(40)},spinner:{marginRight:e.spacing(2)}}})),Gt=function(e){var t=e.message,a=It();return c.a.createElement("div",{className:a.root},c.a.createElement(Lt.a,{className:a.spinner}),c.a.createElement(A.a,{className:a.message},t||"Working..."))},Ft=Object(v.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(St.a)({},e.breakpoints.up("lg"),{width:e.spacing(100)})}}})),qt=function(e){var t=e.onDataChange,a=e.onShowImport,n=Object(o.useState)(null),r=Object(de.a)(n,2),s=r[0],l=r[1],i=Object(o.useState)(null),u=Object(de.a)(i,2),m=u[0],d=u[1],p=Object(o.useState)(null),E=Object(de.a)(p,2),f=E[0],b=E[1],g=function(e){b(Object(Y.a)(Object(Y.a)({},f),{},Object(St.a)({},e.target.name,e.target.checked)))};return Object(o.useEffect)((function(){var e=!!f&&Object.values(f).some((function(e){return!0===e}));a(e)}),[f]),Object(o.useEffect)((function(){t({file:s,course:m,tasks:f})}),[s,m,f]),c.a.createElement(c.a.Fragment,null,!s&&!m&&!f&&c.a.createElement(At,{onSelect:function(e){d(e)}}),!s&&m&&!f&&c.a.createElement("div",null,c.a.createElement(A.a,{gutterBottom:!0},"Scores must be imported from a .csv file exported from Infinite Campus"),c.a.createElement(Rt,{onFiledrop:function(e){var t={};Object.keys(e[0]).slice(1).forEach((function(e){t[e]=!1})),l(e),b(t)}})),s&&m&&f&&c.a.createElement(_t.a,{component:"fieldset"},c.a.createElement(A.a,{gutterBottom:!0,variant:"body1"},"Select the assignments to import"),c.a.createElement(kt.a,null,Object.keys(f).map((function(e){return c.a.createElement(We.a,{control:c.a.createElement(Me.a,{checked:f[e],onChange:g,name:e}),key:e,label:e})})))))},Bt=Object(r.c)((function(e){return Object(Y.a)({},e.scores)}),(function(e){return{onImport:function(t,a){return e({type:"IMPORT_SCORES",payload:le.a.Scores.import(t),curStudent:a,snackbar:{message:"Scores imported",variant:"success"}})},onExit:function(){return e({type:"IMPORT_SCORES_DIALOG_UNLOADED"})}}}))((function(e){var t=e.curStudent,a=e.errors,n=e.inProgress,r=e.isClosed,s=e.isOpen,l=e.onExit,i=e.onImport,u=Object(o.useState)(!1),m=Object(de.a)(u,2),d=m[0],p=m[1],E=Object(o.useState)(!1),f=Object(de.a)(E,2),b=f[0],g=f[1],O=Object(o.useState)(null),h=Object(de.a)(O,2),y=h[0],v=h[1],S=Object(Ce.a)(),j=Object(_e.a)(S.breakpoints.down("md")),A=Ft(),N=function(){p(!1),r()};return Object(o.useEffect)((function(){n||a||N()}),[n]),Object(o.useEffect)((function(){p(s)}),[s]),c.a.createElement(ve.a,{className:A.dialog,fullScreen:j,onClick:function(e){return e.stopPropagation()},onClose:N,onExit:l,onFocus:function(e){return e.stopPropagation()},open:d},c.a.createElement(Se.a,null,"Import Scores"),c.a.createElement(je.a,null,c.a.createElement(oe,{errors:a}),n?c.a.createElement(Gt,{message:"Importing..."}):c.a.createElement(qt,{onDataChange:function(e){v(e)},onShowImport:function(e){g(e)}})),c.a.createElement(De.a,null,b&&c.a.createElement(D.a,{color:"primary",disabled:n,onClick:function(){var e=y.file.map((function(e,t){return t>1&&e["Assignment Name"].split("#").pop()})).filter((function(e){return!1!==e})),a={course:y.course,tasks:[]};for(var n in y.tasks){if(y.tasks[n]){var r,o={title:n,totalPoints:y.file[1][n],scores:{}},c=Object(Ct.a)(e);try{var s=function(){var e=r.value,t=y.file.find((function(t){return t["Assignment Name"].endsWith(e)}));t&&(o.scores[e]=t[n])};for(c.s();!(r=c.n()).done;)s()}catch(l){c.e(l)}finally{c.f()}a.tasks.push(o)}}i(a,t)},variant:"contained"},n?"Importing...":"Import"),c.a.createElement(D.a,{disabled:n,onClick:N,variant:"contained"},"Cancel")))})),Wt=Object(v.a)((function(e){return{icon:{marginRight:e.spacing(1)}}})),Mt=function(e){var t=e.curStudent,a=Object(o.useState)(null),n=Object(de.a)(a,2),r=n[0],s=n[1],l=Object(o.useState)(null),i=Object(de.a)(l,2),u=i[0],m=i[1],d=Wt(),p=function(e){m(e.currentTarget.dataset.type),s(null)},E=function(){m(null)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(X.a,{color:"primary",onClick:function(e){s(e.currentTarget)},variant:"extended"},c.a.createElement(yt.a,{className:d.icon}),"Update Accounts"),c.a.createElement(bt.a,{anchorEl:r,open:Boolean(r),onClose:function(){s(null)}},c.a.createElement(gt.a,{"data-type":"scores",onClick:p},c.a.createElement(Ot.a,null,c.a.createElement(vt.a,null)),c.a.createElement(ht.a,null,"Import scores")),c.a.createElement(gt.a,{"data-type":"bonuses",onClick:p},c.a.createElement(Ot.a,null,c.a.createElement(ke.a,null)),c.a.createElement(ht.a,null,"Add Bonuses")),c.a.createElement(gt.a,{"data-type":"purchases",onClick:p},c.a.createElement(Ot.a,null,c.a.createElement(Ue.a,null)),c.a.createElement(ht.a,null,"Add Purchases"))),c.a.createElement(Bt,{curStudent:t,isClosed:E,isOpen:"scores"===u}),c.a.createElement(Tt,{curStudent:t,isClosed:E,isOpen:"bonuses"===u,type:"Bonuses"}),c.a.createElement(Tt,{curStudent:t,isClosed:E,isOpen:"purchases"===u,type:"Purchases"}))},Ht=Object(r.c)((function(e){return{importSummary:e.scores.importSummary}}),(function(e){return{onUnload:function(){return e({type:"ACCOUNTS_PAGE_UNLOADED"})}}}))((function(e){var t=e.importSummary,a=e.onUnload,n=Object(o.useState)(null),r=Object(de.a)(n,2),s=r[0],l=r[1],i=function(e,t){return"".concat(e," ").concat(t).concat(1!==e?"s":"")};return Object(o.useEffect)((function(){return function(){a()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(se,{title:"Manage Accounts"},c.a.createElement(Mt,{curStudent:s})),t&&c.a.createElement(st,null,"Created ",i(t.tasksCreated,"assignment"),", imported"," ",i(t.scoresImported,"score"),", and updated"," ",i(t.scoresUpdated,"score")),c.a.createElement(te.a,{container:!0,spacing:4},c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(ft,{onChange:function(e){l(e)}})),c.a.createElement(te.a,{item:!0,xs:12},s&&c.a.createElement(Ge,{canEdit:!0,student:s}))))})),Vt=Object(v.a)((function(e){return{icon:{marginRight:e.spacing(1)}}})),zt=Object(r.c)((function(e){return Object(Y.a)({},e.courses)}),(function(e){return{onAdd:function(t){return e({type:"ADD_COURSE",payload:le.a.Courses.add(t),snackbar:{message:"Course added",variant:"success"}})},onExit:function(){return e({type:"COURSE_DIALOG_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_COURSE",payload:le.a.Courses.update(t),snackbar:{message:"Course updated",variant:"success"}})}}}))((function(e){var t=e.course,a=e.errors,n=e.inProgress,r=e.onAdd,s=e.onExit,l=e.onUpdate,i=Object(o.useState)(!1),u=Object(de.a)(i,2),m=u[0],d=u[1],p=Object(Ce.a)(),E=Object(_e.a)(p.breakpoints.down("md")),f=Vt(),b=function(){d(!0)},g=function(){d(!1)},O=function(e){r(Object(Y.a)({},e))},h=function(e){l(Object(Y.a)(Object(Y.a)({},t),e))};return Object(o.useEffect)((function(){n||a||d(!1)}),[n]),c.a.createElement(c.a.Fragment,null,t?c.a.createElement(ye,{action:"Edit course",onClick:b},c.a.createElement(be.a,null)):c.a.createElement(X.a,{color:"primary",onClick:b,variant:"extended"},c.a.createElement(Ye.a,{className:f.icon}),"Create course"),c.a.createElement(ve.a,{fullScreen:E,onClick:function(e){return e.stopPropagation()},onClose:g,onExit:s,onFocus:function(e){return e.stopPropagation()},open:m},c.a.createElement(J.c,{initialValues:{name:(null===t||void 0===t?void 0:t.name)||"",period:(null===t||void 0===t?void 0:t.period)||""},validationSchema:Z.b({name:Z.c().required("Required"),period:Z.a().typeError("Numbers only").required("Required")}),onSubmit:function(){var e=Object(Q.a)(K.a.mark((function e(a){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?h(a):O(a);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement(J.b,null,c.a.createElement(Se.a,null,t?"Edit Course":"Create Course"),c.a.createElement(je.a,null,c.a.createElement(oe,{errors:a}),c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{autoFocus:!t,color:"primary",component:$.a,disabled:n,label:"Course Name",name:"name",type:"text",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{color:"primary",component:$.a,disabled:n,label:"Period",name:"period",type:"text",fullWidth:!0})))),c.a.createElement(De.a,null,c.a.createElement(D.a,{disabled:n,color:"primary",type:"submit",variant:"contained"},t?n?"Updating...":"Update":n?"Adding...":"Add"),c.a.createElement(D.a,{disabled:n,onClick:g,variant:"contained"},"Cancel"))))))})),Kt=a(646),Qt=a(618),Yt=a(645),Jt=a(617),$t=a(635),Zt=a(425),Xt=a(632),ea=Object(r.c)((function(){return{}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_STUDENT",payload:le.a.Students.delete(t),snackbar:{message:"Student deleted",variant:"success"}})}}}))((function(e){e.course;var t=e.onDelete,a=e.student,n=Object(o.useState)(!1),r=Object(de.a)(n,2),s=r[0],l=r[1],i=function(){l(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(ye,{action:"Delete student",onClick:function(){l(!0)},size:"small"},c.a.createElement(Xt.a,{fontSize:"inherit"})),c.a.createElement(ve.a,{open:s,onClose:i,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Se.a,null,"Delete Student"),c.a.createElement(je.a,null,c.a.createElement(Ae.a,{component:"div"},"Are you sure you want to delete"," ",c.a.createElement("b",null,a.firstName," ",a.lastName),"? This action will permanently delete:",c.a.createElement("ul",null,c.a.createElement("li",null,"the student's account, and"),c.a.createElement("li",null,"all song requests"),c.a.createElement("li",null,"all transactions"),c.a.createElement("li",null,"all scores")),"associated with this student. This action ",c.a.createElement("b",null,"cannot be undone"),".")),c.a.createElement(De.a,null,c.a.createElement(D.a,{onClick:function(){l(!1),t(a)},color:"secondary",variant:"contained",autoFocus:!0},"Delete"),c.a.createElement(D.a,{onClick:i,variant:"contained"},"Cancel"))))})),ta=a(633),aa=Object(r.c)((function(e){return Object(Y.a)(Object(Y.a)({},e.common.settings),e.courses)}),(function(e){return{onAdd:function(t,a){return e({type:"ADD_STUDENT",payload:le.a.Students.add(t,a),courseId:a,snackbar:{message:"Student added",variant:"success"}})},onExit:function(){return e({type:"STUDENT_DIALOG_UNLOADED"})},onUpdate:function(t,a){return e({type:"UPDATE_STUDENT",payload:le.a.Students.update(t),courseId:a,snackbar:{message:"Student updated",variant:"success"}})}}}))((function(e){var t=e.course,a=e.defaultStudentPassword,n=e.errors,r=e.inProgress,s=e.onAdd,l=e.onExit,i=e.onUpdate,u=e.student,m=Object(o.useState)(!1),d=Object(de.a)(m,2),p=d[0],E=d[1],f=Object(Ce.a)(),b=Object(_e.a)(f.breakpoints.down("md")),g=function(){E(!0)},O=function(){E(!1)},h=function(e){var a=Object(Y.a)({},e),n=t._id;a.role="student",s(a,n)},y=function(e){var a=Object(Y.a)(Object(Y.a)({},u),e),n=t._id;i(a,n)};return Object(o.useEffect)((function(){r||n||E(!1)}),[r]),c.a.createElement(c.a.Fragment,null,u?c.a.createElement(ye,{action:"Edit student",onClick:g,size:"small"},c.a.createElement(be.a,{fontSize:"inherit"})):c.a.createElement(ye,{action:"Add student",onClick:g},c.a.createElement(ta.a,null)),c.a.createElement(ve.a,{fullScreen:b,onClick:function(e){return e.stopPropagation()},onClose:O,onExit:l,onFocus:function(e){return e.stopPropagation()},open:p},c.a.createElement(J.c,{initialValues:{firstName:(null===u||void 0===u?void 0:u.firstName)||"",lastName:(null===u||void 0===u?void 0:u.lastName)||"",username:(null===u||void 0===u?void 0:u.username)||"",password:u?"":a},validationSchema:Z.b({firstName:Z.c().required("Required"),lastName:Z.c().required("Required"),username:Z.a().typeError("Numbers only").required("Required"),password:Z.c().required(u?"":"Required")}),onSubmit:function(){var e=Object(Q.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u?y(t):h(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement(J.b,null,c.a.createElement(Se.a,null,u?"Edit Student":"Add Student"),c.a.createElement(je.a,null,c.a.createElement(oe,{errors:n}),c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{autoFocus:!u,color:"primary",component:$.a,disabled:r,label:"First Name",name:"firstName",type:"text",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{color:"primary",component:$.a,disabled:r,label:"Last Name",name:"lastName",type:"text",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{color:"primary",component:$.a,disabled:!!u||r,label:"Student Number",name:"username",type:"text",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{color:"primary",component:$.a,disabled:r,label:"Password",name:"password",type:"text",fullWidth:!0})))),c.a.createElement(De.a,null,c.a.createElement(D.a,{color:"primary",disabled:r,type:"submit",variant:"contained"},u?r?"Updating...":"Update":r?"Adding...":"Add"),c.a.createElement(D.a,{disabled:r,onClick:O,variant:"contained"},"Cancel"))))))})),na=Object(v.a)((function(e){return{row:{alignItems:"center",borderBottom:"solid 2px white",display:"flex",height:e.spacing(5),justifyContent:"space-between",padding:e.spacing(1),"&:hover":{borderBottomColor:e.palette.secondary.main}},rowHeader:{alignItems:"center",display:"flex"},studentUsername:{marginRight:e.spacing(2),minWidth:e.spacing(12)}}})),ra=function(e){var t=e.course,a=e.student,n=na();return c.a.createElement("div",{className:n.row},c.a.createElement("div",{className:n.rowHeader},c.a.createElement(Zt.a,{color:"primary",label:a.username,className:n.studentUsername}),c.a.createElement(A.a,null,a.lastName,", ",a.firstName)),c.a.createElement("div",null,c.a.createElement(Te,{student:a}),c.a.createElement(aa,{course:t,student:a}),c.a.createElement(ea,{course:t,student:a})))},oa=function(e){var t=e.course;return c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{variant:"h6"},"Students")," ",t.students&&t.students.length>0?t.students.map((function(e){return c.a.createElement(ra,{key:e._id,course:t,student:e})})):c.a.createElement("div",null,c.a.createElement(A.a,null,"No students have been added to this course")))},ca=Object(r.c)((function(){return{}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_COURSE",payload:le.a.Courses.delete(t),snackbar:{message:"Course deleted",variant:"success"}})}}}))((function(e){var t=e.course,a=e.onDelete,n=Object(o.useState)(!1),r=Object(de.a)(n,2),s=r[0],l=r[1],i=function(){l(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(ye,{action:"Delete course",onClick:function(){l(!0)}},c.a.createElement(Xt.a,null)),c.a.createElement(ve.a,{open:s,onClose:i,onClick:function(e){return e.stopPropagation()},onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Se.a,null,"Delete Course"),c.a.createElement(je.a,null,c.a.createElement(Ae.a,{component:"div"},"Are you sure you want to delete"," ",c.a.createElement("b",null,t.name," Period ",t.period),"? This action will permanently delete:",c.a.createElement("ul",null,c.a.createElement("li",null,"all student accounts"),c.a.createElement("li",null,"all song requests"),c.a.createElement("li",null,"all transactions"),c.a.createElement("li",null,"all scores")),"associated with this course. This action ",c.a.createElement("b",null,"cannot be undone"),".")),c.a.createElement(De.a,null,c.a.createElement(D.a,{onClick:function(){l(!1),a(t.slug)},color:"secondary",variant:"contained",autoFocus:!0},"Delete"),c.a.createElement(D.a,{onClick:i,variant:"contained"},"Cancel"))))})),sa=Object(r.c)((function(e){return Object(Y.a)(Object(Y.a)({},e.common.settings),e.courses)}),(function(e){return{onDrop:function(t,a){return e({type:"IMPORT_STUDENTS",payload:le.a.Students.import(t,a),snackbar:{message:"Students imported",variant:"success"}})},onExit:function(){return e({type:"STUDENT_DIALOG_UNLOADED"})}}}))((function(e){var t=e.course,a=e.defaultStudentPassword,n=e.errors,r=e.inProgress,s=e.onDrop,l=e.onExit,i=Object(o.useState)(!1),u=Object(de.a)(i,2),m=u[0],d=u[1],p=Object(Ce.a)(),E=Object(_e.a)(p.breakpoints.down("md")),f=function(){d(!1)};return Object(o.useEffect)((function(){r||n||d(!1)}),[r]),c.a.createElement(c.a.Fragment,null,c.a.createElement(ye,{action:"Import students",onClick:function(){d(!0)}},c.a.createElement(vt.a,null)),c.a.createElement(ve.a,{fullScreen:E,onClick:function(e){return e.stopPropagation()},onClose:f,onExit:l,onFocus:function(e){return e.stopPropagation()},open:m},c.a.createElement(Se.a,null,"Import Students"),c.a.createElement(je.a,null,r?c.a.createElement(Gt,{message:"Importing..."}):c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{gutterBottom:!0},"Students can be imported from a .csv file exported from Infinite Campus"),c.a.createElement(Rt,{onFiledrop:function(e){var n=Object.keys(e[0]),r=e.map((function(e,t){if(t<2)return null;var r=e[n[0]];return{firstName:r.split(",")[1].split(/(\s\w)*\s#/)[0].trim(),lastName:r.split(",")[0],username:r.split("#")[1],password:a,role:"student"}})).filter((function(e){return null!==e}));s(r,t._id)}}))),c.a.createElement(De.a,null,c.a.createElement(D.a,{disabled:r,onClick:f,variant:"contained"},"Cancel"))))})),la=a(634),ia=Object(r.c)((function(e){return{tasks:e.tasks.tasks}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_TASK",payload:le.a.Tasks.delete(t),snackbar:{message:"Assignment removed",variant:"success"}})},onLoad:function(t){return e({type:"TASKS_DIALOG_LOADED",payload:le.a.Tasks.getAll(t)})},onUpdate:function(t){return e({type:"UPDATE_TASK",payload:le.a.Tasks.update(t),snackbar:{message:"Assignment updated",variant:"success"}})}}}))((function(e){var t=e.course,a=e.onDelete,n=e.onLoad,r=e.onUpdate,s=e.tasks,l=Object(o.useState)([]),i=Object(de.a)(l,2),u=i[0],m=i[1],d=s.map((function(e){return{createdAt:new Date(e.createdAt).toDateString(),title:e.title,totalPoints:e.totalPoints,slug:e.slug}})),p=Object(o.useState)([{title:"Date",field:"createdAt",editable:"never"},{title:"Title",field:"title",editable:"never"},{title:"Total Points",field:"totalPoints"}]),E=Object(de.a)(p,1)[0];return Object(o.useEffect)((function(){n(t._id)}),[]),Object(o.useEffect)((function(){m(d)}),[s]),c.a.createElement(Ee.a,{columns:E,data:u,localization:{body:{emptyDataSourceMessage:"No assignments found for this course",editRow:{deleteText:"Delete assignment? This will delete all scores for this assignment."}}},options:{actionsColumnIndex:-1,paging:!1,toolbar:!1},editable:{onRowUpdate:function(e,t){return new Promise((function(a,n){var o=Object(me.a)(u);o[t.tableData.id]=e,m(Object(me.a)(o)),r(e),a()}))},onRowDelete:function(e){return new Promise((function(t,n){var r=Object(me.a)(u),o=e.tableData.id;r.splice(o,1),m(Object(me.a)(r)),a(e),t()}))}}})})),ua=Object(v.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(St.a)({},e.breakpoints.up("lg"),{minHeight:e.spacing(54),width:e.spacing(100)})}}})),ma=Object(r.c)((function(e){return Object(Y.a)({},e.tasks)}),(function(e){return{onExit:function(){return e({type:"TASKS_DIALOG_UNLOADED"})}}}))((function(e){var t=e.course,a=e.errors,n=e.inProgress,r=e.onExit,s=Object(o.useState)(!1),l=Object(de.a)(s,2),i=l[0],u=l[1],m=Object(Ce.a)(),d=Object(_e.a)(m.breakpoints.down("md")),p=ua(),E=function(){u(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(ye,{action:"Manage assignments",onClick:function(){u(!0)}},c.a.createElement(la.a,null)),c.a.createElement(ve.a,{className:p.dialog,fullScreen:d,onClick:function(e){return e.stopPropagation()},onClose:E,onExit:r,onFocus:function(e){return e.stopPropagation()},open:i},c.a.createElement(Se.a,null,"Manage Assignments"),c.a.createElement(je.a,null,c.a.createElement(oe,{errors:a}),c.a.createElement(ia,{course:t})),c.a.createElement(De.a,null,c.a.createElement(D.a,{disabled:n,onClick:E,variant:"contained"},"Close"))))})),da=Object(v.a)((function(e){return{courseDetails:{display:"block"},courseHeader:{alignItems:"center",display:"flex",justifyContent:"space-between",width:"100%"},coursePeriod:{backgroundColor:e.palette.secondary.main,marginRight:e.spacing(2)},courseTitle:{flexGrow:"1"}}})),pa=function(e){var t=e.courses,a=Object(o.useState)(!1),n=Object(de.a)(a,2),r=n[0],s=n[1],l=da();return c.a.createElement(c.a.Fragment,null,(null===t||void 0===t?void 0:t.length)>0?t.map((function(e){return c.a.createElement(Kt.a,{expanded:r===e._id,key:e._id,onChange:(t=e._id,function(e,a){s(!!a&&t)})},c.a.createElement(Qt.a,{expandIcon:c.a.createElement($t.a,null)},c.a.createElement("div",{className:l.courseHeader},c.a.createElement(Yt.a,{className:l.coursePeriod},e.period),c.a.createElement(A.a,{className:l.courseTitle,variant:"h5"},e.name),c.a.createElement(ma,{course:e}),c.a.createElement(aa,{course:e}),c.a.createElement(sa,{course:e}),c.a.createElement(zt,{course:e}),c.a.createElement(ca,{course:e}))),c.a.createElement(Jt.a,{className:l.courseDetails},c.a.createElement(oa,{course:e})));var t})):c.a.createElement(A.a,null,"You have no courses"))},Ea=Object(r.c)((function(e){return Object(Y.a)({},e.courses)}),(function(e){return{onLoad:function(){return e({type:"COURSES_PAGE_LOADED",payload:le.a.Courses.getAll()})},onUnload:function(){return e({type:"COURSES_PAGE_UNLOADED"})}}}))((function(e){var t=e.courses,a=e.importCount,n=e.onLoad,r=e.onUnload,s=e.pageLoaded;return Object(o.useEffect)((function(){return n(),function(){r()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(se,{title:"Manage Courses"},c.a.createElement(zt,null)),null!==a&&c.a.createElement(st,null,a," students imported"),s?c.a.createElement(Gt,{message:"Loading..."}):c.a.createElement(pa,{courses:t}))})),fa=a(613),ba=a(321),ga=a(643),Oa=a(639),ha=a(636),ya=a(637),va=a(638),Sa=Object(v.a)((function(e){return{dialog:{"& > .MuiDialog-container > .MuiPaper-root":Object(St.a)({},e.breakpoints.up("lg"),{minHeight:e.spacing(54),width:e.spacing(100)})},icon:{marginRight:e.spacing(1)},panel:{minWidth:e.spacing(40),maxWidth:e.spacing(60)},selected:{backgroundColor:e.palette.primary.main},songInfo:{marginBottom:e.spacing(4)},statusButton:{"&:hover":{backgroundColor:e.palette.primary.light}},statusDescription:{backgroundColor:e.palette.grey[100],borderRadius:e.spacing(1),marginTop:e.spacing(2),padding:e.spacing(2)},studentInfo:Object(St.a)({alignItems:"center",display:"flex",marginTop:e.spacing(4),"& > div":{marginRight:e.spacing(1)}},e.breakpoints.up("md"),{borderTopColor:e.palette.primary.main,borderTopStyle:"dotted",borderTopWidth:"4px",paddingTop:e.spacing(2)})}})),ja=Object(r.c)((function(e){return Object(Y.a)(Object(Y.a)({},e.songs),{},{songRequestPurchaseAmount:e.common.settings.songRequestPurchaseAmount})}),(function(e){return{onExit:function(){return e({type:"SONG_REQUESTS_DIALOG_UNLOADED"})},onSubmit:function(t){return e({type:"UPDATE_SONG_REQUEST",payload:le.a.Songs.update(t)})}}}))((function(e){var t,a,n=e.courses,r=e.errors,s=e.inProgress,l=e.onExit,i=e.onSubmit,u=e.songRequestPurchaseAmount,m=Object(o.useState)(!1),d=Object(de.a)(m,2),p=d[0],E=d[1],f=Object(o.useState)(null),b=Object(de.a)(f,2),g=b[0],O=b[1],h=Object(o.useState)(null),y=Object(de.a)(h,2),v=y[0],S=y[1],j=Object(o.useState)(null),N=Object(de.a)(j,2),T=N[0],C=N[1],_=Object(Ce.a)(),k=Object(_e.a)(_.breakpoints.down("md")),U=Sa(),w=function(){E(!1),S(null),C(null)},P=function(e){S(e)},x=function(e){C(e.target.value)},R=function(){var e=Object(Q.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i({amount:u,id:g._id,status:v,statusDescription:T}),S(null),C(null);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){!function(){if(O(null),n.length>0){var e,t=Object(Ct.a)(n);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(a.songs.length>0){var r=a.songs.find((function(e){return"pending"===e.status}));if(r){r.period=a.period,O(r);break}}}}catch(o){t.e(o)}finally{t.f()}}}()}),[n]),c.a.createElement(c.a.Fragment,null,c.a.createElement(X.a,{color:"primary",onClick:function(){E(!0)},variant:"extended"},c.a.createElement(ha.a,{className:U.icon}),"Process requests"),c.a.createElement(ve.a,{className:U.dialog,fullScreen:k,onClick:function(e){return e.stopPropagation()},onClose:w,onExit:l,onFocus:function(e){return e.stopPropagation()},open:p},c.a.createElement(Se.a,null,"Process Song Requests"),c.a.createElement(je.a,null,c.a.createElement(oe,{errors:r}),g?c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement("div",{className:U.panel},c.a.createElement("div",{className:U.songInfo},c.a.createElement(A.a,{variant:"h6"},g.title),c.a.createElement(A.a,{color:"textSecondary",variant:"body1",gutterBottom:!0},"Song"),c.a.createElement(A.a,{variant:"h6"},g.artist),c.a.createElement(A.a,{color:"textSecondary",variant:"body1"},"Artist")),c.a.createElement(fa.a,null,c.a.createElement(D.a,{href:(t=g.artist,a=g.title,"http://www.google.com/search?q=".concat(encodeURIComponent("lyrics: "+a+" by "+t))),target:"_blank"},"Search Lyrics"),c.a.createElement(D.a,{href:function(e,t){return"https://open.spotify.com/search/".concat(encodeURIComponent(t+" "+e))}(g.artist,g.title),target:"_blank"},"Search Spotify")),c.a.createElement("div",{className:U.studentInfo},c.a.createElement(Zt.a,{color:"secondary",label:g.period}),c.a.createElement(A.a,null,g.student.firstName," ",g.student.lastName)))),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement("div",{className:U.panel},c.a.createElement(A.a,{variant:"h6"},"Status"),c.a.createElement(fa.a,{fullWidth:!0,size:"large"},c.a.createElement(ge.a,{arrow:!0,enterTouchDelay:0,title:"Approve"},c.a.createElement(D.a,{className:"".concat(U.statusButton," ").concat("approved"===v&&U.selected),onClick:function(){return P("approved")}},c.a.createElement(ya.a,null))),c.a.createElement(ge.a,{arrow:!0,enterTouchDelay:0,title:"Reject"},c.a.createElement(D.a,{className:"".concat(U.statusButton," ").concat("rejected"===v&&U.selected),onClick:function(){return P("rejected")}},c.a.createElement(va.a,null)))),"approved"===v&&c.a.createElement("div",{className:U.statusDescription},c.a.createElement(A.a,{gutterBottom:!0},c.a.createElement("strong",null,"Condition for Approval")," (optional)"),c.a.createElement(_t.a,{component:"fieldset"},c.a.createElement(ba.a,{name:"statusDescription",value:T,onChange:x},c.a.createElement(We.a,{value:"Clean version",control:c.a.createElement(ga.a,null),label:"Clean version"}),c.a.createElement(We.a,{value:"Instrumental version",control:c.a.createElement(ga.a,null),label:"Instrumental version"}),c.a.createElement(We.a,{value:"Picked my best guess",control:c.a.createElement(ga.a,null),label:"Picked my best guess"})))),"rejected"===v&&c.a.createElement("div",{className:U.statusDescription},c.a.createElement(A.a,{gutterBottom:!0},c.a.createElement("strong",null,"Reason for Rejection")," (optional)"),c.a.createElement(_t.a,{component:"fieldset"},c.a.createElement(ba.a,{name:"statusDescription",value:T,onChange:x},c.a.createElement(We.a,{value:"Inappropriate content (language, drugs, sex, and/or violence)",control:c.a.createElement(ga.a,null),label:"Inappropriate content (language, drugs, sex, and/or violence)"}),c.a.createElement(We.a,{value:"Not available on Spotify",control:c.a.createElement(ga.a,null),label:"Not available on Spotify"}),c.a.createElement(We.a,{value:"other",control:c.a.createElement(ga.a,null),label:"Other"}))))))):c.a.createElement(ne.a,{severity:"info"},c.a.createElement(Oa.a,null,"All caught up!"),"There are no songs to process at this time")),c.a.createElement(De.a,null,g&&c.a.createElement(D.a,{color:"primary",disabled:s,onClick:R,variant:"contained"},s?"Saving...":"Save & Continue"),c.a.createElement(D.a,{disabled:s,onClick:w,variant:"contained"},g?"Cancel":"Close"))))})),Aa=Object(r.c)((function(e){return Object(Y.a)({},e.songs)}),(function(e){return{onDelete:function(t){return e({type:"DELETE_SONG_REQUEST",payload:le.a.Songs.delete(t),snackbar:{message:"Song request removed",variant:"success"}})},onLoad:function(){return e({type:"TEACHER_SONGS_PAGE_LOADED",payload:le.a.Songs.forTeacher()})},onUnload:function(){return e({type:"SONGS_PAGE_UNLOADED"})}}}))((function(e){var t=e.courses,a=e.onDelete,n=e.onLoad,r=e.onUnload,s=Object(o.useState)([]),l=Object(de.a)(s,2),i=l[0],u=l[1],m=t.map((function(e){return e.songs.map((function(t){return{createdAt:new Date(t.createdAt).toDateString(),title:t.title,artist:t.artist,purchasedBy:"".concat(t.student.firstName," ").concat(t.student.lastName),period:e.period,status:t.status,statusDescription:t.statusDescription,_id:t._id}}))})).flat(),d=Object(o.useState)([{title:"Request Date",field:"createdAt",editable:"never"},{title:"Song Title",field:"title"},{title:"Song Artist",field:"artist"},{title:"Purchased by",field:"purchasedBy",editable:"never"},{title:"Period",field:"period",editable:"never",render:function(e,t){return"row"===t?c.a.createElement(Zt.a,{label:e.period,color:"secondary"}):c.a.createElement(Zt.a,{label:e,color:"secondary"})}},{title:"Status",field:"status",lookup:{approved:"approved",pending:"pending",rejected:"rejected",removed:"removed"},render:function(e,t){return"row"===t?c.a.createElement("span",{style:{alignItems:"center",display:"flex"}},e.statusDescription?c.a.createElement(c.a.Fragment,null,e.status,c.a.createElement(ge.a,{arrow:!0,color:"primary",enterTouchDelay:0,title:e.statusDescription},c.a.createElement(Qe.a,{style:{marginLeft:"8px"}}))):e.status):c.a.createElement("span",null,e)}}]),p=Object(de.a)(d,1)[0];return Object(o.useEffect)((function(){return n(),function(){return r()}}),[]),Object(o.useEffect)((function(){u(m)}),[t]),c.a.createElement(c.a.Fragment,null,c.a.createElement(se,{title:"Manage Song Requests"},c.a.createElement(ja,null)),c.a.createElement(Ee.a,{title:"Song Requests",columns:p,data:i,localization:{body:{emptyDataSourceMessage:"No song requests have been submitted",editRow:{deleteText:"Delete song request?"}}},options:{actionsColumnIndex:-1,paging:!1,grouping:!0},editable:{onRowDelete:function(e){return new Promise((function(t,n){var r=Object(me.a)(i),o=e.tableData.id;r.splice(o,1),u(Object(me.a)(r)),a(e._id),t()}))}}}))})),Da=Object(v.a)((function(e){return{icon:{marginRight:e.spacing(1)}}})),Na=Object(r.c)((function(e){return Object(Y.a)({},e.teachers)}),(function(e){return{onAdd:function(t){return e({type:"ADD_TEACHER",payload:le.a.Auth.register(t),snackbar:{message:"Teacher added",variant:"success"}})},onExit:function(){return e({type:"TEACHER_DIALOG_UNLOADED"})},onUpdate:function(t){return e({type:"UPDATE_TEACHER",payload:le.a.Teachers.update(t),snackbar:{message:"Teacher updated",variant:"success"}})}}}))((function(e){var t=e.errors,a=e.inProgress,n=e.onAdd,r=e.onExit,s=e.onUpdate,l=e.teacher,i=Object(o.useState)(!1),u=Object(de.a)(i,2),m=u[0],d=u[1],p=Object(Ce.a)(),E=Object(_e.a)(p.breakpoints.down("md")),f=Da(),b=function(){d(!0)},g=function(){d(!1)},O=function(e){n(Object(Y.a)(Object(Y.a)({},e),{},{role:"teacher"}))},h=function(e){s(Object(Y.a)(Object(Y.a)({},l),e))};return Object(o.useEffect)((function(){a||t||d(!1)}),[a]),c.a.createElement(c.a.Fragment,null,l?c.a.createElement(ye,{action:"Update teacher",onClick:b},c.a.createElement(be.a,null)):c.a.createElement(X.a,{color:"primary",onClick:b,variant:"extended"},c.a.createElement(Ye.a,{className:f.icon}),"Add teacher"),c.a.createElement(ve.a,{fullScreen:E,open:m,onClose:g,onClick:function(e){return e.stopPropagation()},onExit:r,onFocus:function(e){return e.stopPropagation()}},c.a.createElement(J.c,{initialValues:{firstName:(null===l||void 0===l?void 0:l.firstName)||"",lastName:(null===l||void 0===l?void 0:l.lastName)||"",username:(null===l||void 0===l?void 0:l.username)||"",password:""},validationSchema:Z.b({firstName:Z.c().required("Required"),lastName:Z.c().required("Required"),username:Z.c().required("Required"),password:Z.c().required(l?"":"Required")}),onSubmit:function(){var e=Object(Q.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l?h(t):O(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},c.a.createElement(J.b,null,c.a.createElement(Se.a,null,l?"Edit Teacher":"Add Teacher"),c.a.createElement(je.a,null,c.a.createElement(oe,{errors:t}),c.a.createElement(te.a,{container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{autoFocus:!l,color:"primary",component:$.a,disabled:a,label:"First Name",name:"firstName",type:"text",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{color:"primary",component:$.a,disabled:a,label:"Last Name",name:"lastName",type:"text",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{color:"primary",component:$.a,disabled:!!l||a,label:"Username",name:"username",type:"text",fullWidth:!0})),c.a.createElement(te.a,{item:!0,xs:12,md:6},c.a.createElement(J.a,{color:"primary",component:$.a,disabled:a,label:"Password",name:"password",type:"text",fullWidth:!0})))),c.a.createElement(De.a,null,c.a.createElement(D.a,{color:"primary",disabled:a,type:"submit",variant:"contained"},l?a?"Updating...":"Update":a?"Adding...":"Add"),c.a.createElement(D.a,{disabled:a,onClick:g,variant:"contained"},"Cancel"))))))})),Ta=Object(r.c)((function(){return{}}),(function(e){return{onDelete:function(t){return e({type:"DELETE_TEACHER",payload:le.a.Teachers.delete(t),snackbar:{message:"Teacher deleted",variant:"success"}})}}}))((function(e){var t=e.onDelete,a=e.teacher,n=Object(o.useState)(!1),r=Object(de.a)(n,2),s=r[0],l=r[1],i=function(){l(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(ye,{action:"Delete teacher",onClick:function(){l(!0)}},c.a.createElement(Xt.a,null)),c.a.createElement(ve.a,{open:s,onClick:function(e){return e.stopPropagation()},onClose:i,onFocus:function(e){return e.stopPropagation()}},c.a.createElement(Se.a,null,"Delete Teacher"),c.a.createElement(je.a,null,c.a.createElement(Ae.a,{component:"div"},"Are you sure you want to delete"," ",c.a.createElement("b",null,a.firstName," ",a.lastName),"? This action will permanently delete:",c.a.createElement("ul",null,c.a.createElement("li",null,"all student accounts"),c.a.createElement("li",null,"all song requests"),c.a.createElement("li",null,"all transactions"),c.a.createElement("li",null,"all scores")),"associated with this teacher. This action ",c.a.createElement("b",null,"cannot be undone"),".")),c.a.createElement(De.a,null,c.a.createElement(D.a,{onClick:function(){l(!1),t(a)},color:"secondary",variant:"contained",autoFocus:!0},"Delete"),c.a.createElement(D.a,{onClick:i,variant:"contained"},"Cancel"))))})),Ca=Object(v.a)((function(e){return{teacherDetails:{display:"block"},teacherHeader:{alignItems:"center",display:"flex",justifyContent:"space-between",width:"100%"},teacherUsername:{marginRight:e.spacing(2),minWidth:e.spacing(12)},teacherName:{flexGrow:"1"}}})),_a=function(e){var t=e.teachers,a=Object(o.useState)(!1),n=Object(de.a)(a,2),r=n[0],s=n[1],l=Ca();return c.a.createElement(c.a.Fragment,null,(null===t||void 0===t?void 0:t.length)>0?t.map((function(e){return c.a.createElement(Kt.a,{expanded:r===e.username,key:e.username,onChange:(t=e.username,function(e,a){s(!!a&&t)})},c.a.createElement(Qt.a,{expandIcon:c.a.createElement($t.a,null)},c.a.createElement("div",{className:l.teacherHeader},c.a.createElement(Zt.a,{color:"secondary",label:e.username,className:l.teacherUsername}),c.a.createElement(A.a,{className:l.teacherName,variant:"h5"},e.firstName," ",e.lastName),c.a.createElement(Na,{teacher:e}),c.a.createElement(Ta,{teacher:e}))),c.a.createElement(Jt.a,{className:l.teacherDetails},c.a.createElement(A.a,{variant:"h6"},"Courses"),e.courses&&e.courses.length>0?e.courses.map((function(e){return c.a.createElement("div",{key:e._id},c.a.createElement(A.a,null,"Period ",e.period," | ",e.name," |"," ",e.students.length," students"))})):c.a.createElement("div",null,c.a.createElement(A.a,null,"No courses have been created"))));var t})):c.a.createElement(A.a,null,"No teachers found"))},ka=Object(r.c)((function(e){return Object(Y.a)({},e.teachers)}),(function(e){return{onLoad:function(){return e({type:"MANAGE_TEACHERS_PAGE_LOADED",payload:le.a.Teachers.getAll()})},onUnload:function(){return e({type:"MANAGE_TEACHERS_PAGE_UNLOADED"})}}}))((function(e){var t=e.onLoad,a=e.onUnload,n=e.teachers;return Object(o.useEffect)((function(){return t(),function(){a()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(se,{title:"Manage Teachers"},c.a.createElement(Na,null)),c.a.createElement(_a,{teachers:n}))})),Ua=Object(r.c)((function(e){return{currentUser:e.common.currentUser}}),(function(){return{}}))((function(e){var t=e.currentUser;return t?c.a.createElement(c.a.Fragment,null,c.a.createElement(w,{currentUser:t}),c.a.createElement(M,null,c.a.createElement(y.a,null,c.a.createElement(i.d,null,c.a.createElement(V,{path:"/student/account",component:Fe}),c.a.createElement(V,{path:"/student/settings",component:ue}),c.a.createElement(V,{path:"/student/songs",component:rt}),c.a.createElement(V,{path:"/teacher/accounts",component:Ht}),c.a.createElement(V,{path:"/teacher/courses",component:Ea}),c.a.createElement(V,{path:"/teacher/settings",component:ue}),c.a.createElement(V,{path:"/teacher/songs",component:Aa}),c.a.createElement(V,{path:"/admin/accounts",component:Ht}),c.a.createElement(V,{path:"/admin/courses",component:Ea}),c.a.createElement(V,{path:"/admin/settings",component:ue}),c.a.createElement(V,{path:"/admin/songs",component:Aa}),c.a.createElement(V,{path:"/admin/teachers",component:ka}),c.a.createElement(i.b,{component:H}))),c.a.createElement(B,null))):c.a.createElement(i.a,{to:"/login"})})),wa=a(273),Pa=a.n(wa),xa=a(274),Ra=a.n(xa),La=Object(v.a)((function(e){return{background:{alignItems:"center",backgroundImage:"url(".concat(Ra.a,")"),backgroundSize:"cover",display:"flex",height:"100%",justifyContent:"center"},logo:{marginBottom:e.spacing(4),width:160},panel:{alignItems:"center",borderRadius:"1rem",display:"flex",flexFlow:"column nowrap",overflowY:"scroll",padding:"2rem 4rem",position:"relative"},text:{color:e.palette.primary.main,fontStyle:"italic"}}})),Ia=function(e){var t=La();return c.a.createElement(Pa.a,{className:t.background},c.a.createElement(ee.a,{elevation:12,className:t.panel},c.a.createElement(C,{className:t.logo}),c.a.createElement(A.a,{className:t.text,variant:"h4"},"Loading...")))},Ga=a(122),Fa=a(403),qa=a(640),Ba=a(619),Wa=a(443),Ma=a.n(Wa),Ha=Object(v.a)((function(e){return{page:{"& p:not(:last-of-type)":{marginBottom:e.spacing(2)}},profile:{borderRadius:"100%",boxShadow:e.shadows[10],float:"right",marginBottom:e.spacing(2),marginLeft:e.spacing(2),width:"120px"}}})),Va=function(){var e=Ha();return c.a.createElement(te.a,{className:e.page,container:!0,spacing:2},c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(A.a,{align:"center",gutterBottom:!0,variant:"h5"},"What is Chem Cash?"),c.a.createElement("img",{className:e.profile,src:Ma.a}),c.a.createElement(A.a,{variant:"body2"},"Hi! I'm Joseph May, a high school chemistry teacher from Las Vegas. While I love teaching chemistry, I also love programming for the web, so why not combine the two."),c.a.createElement(A.a,{variant:"body2"},"Chem Cash is a points-based rewards system I use in my classroom. The idea for this site came from a colleage who was inspired by one of his own high school science teachers."),c.a.createElement(A.a,{variant:"body2"},"Students earn points in two ways: (1) through payouts based on their assessment scores and (2) with bonus points earned for anything I deam worthy of reward such as winning in-class competitions or going above and beyond to help me or a student."),c.a.createElement(A.a,{variant:"body2"},'These points can be used to "purchase" goods such as school supplies, electronics, and anything I can find for cheap or get for free.'),c.a.createElement(A.a,{variant:"body2"},"However, the hottest-selling item is song requests. During work time in my class I play music for my students. Each class period has its own playlist and students can only add songs to the playlist by spending their Chem Cash points."),c.a.createElement(A.a,{variant:"body2"},"I created this program to help manage all of the logistics behind this system of incentives. While it can support multiple teachers, I am running it on no-cost servers, so it was not intended to be a public program. Although, if you are interested in learning more, please reach out to me"," ",c.a.createElement(Ba.a,{href:"mailto:jwmay87+chemcash@gmail.com"},"here"),".")))},za=Object(r.c)((function(e){return Object(Y.a)({},e.auth)}),(function(e){return{onSubmit:function(t,a){return e({type:k,payload:le.a.Auth.login(t,a)})}}}))((function(e){return c.a.createElement(J.c,{initialValues:{username:"",password:""},validationSchema:Z.b({username:Z.c().required("Required"),password:Z.c().required("Required")}),onSubmit:function(t){!function(t,a){e.onSubmit(t,a)}(t.username,t.password)}},c.a.createElement(J.b,null,c.a.createElement(te.a,{container:!0,spacing:4},c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(oe,{errors:e.errors}),c.a.createElement(J.a,{component:$.a,disabled:e.inProgress,fullWidth:!0,label:"Username",name:"username",type:"text",variant:"outlined"})),c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(J.a,{component:$.a,disabled:e.inProgress,fullWidth:!0,label:"Password",name:"password",type:"password",variant:"outlined"})),c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(D.a,{color:"primary",disabled:e.inProgress,size:"large",type:"submit",variant:"contained"},e.inProgress?"Loading...":"Login")))))})),Ka=Object(v.a)((function(e){return{aboutLink:{bottom:e.spacing(2),position:"absolute",right:e.spacing(4)},loginLink:{marginBottom:e.spacing(2),"& > a":{textDecoration:"none"}},logo:{display:"block",margin:"0 auto",width:120},page:Object(St.a)({alignItems:"center",backgroundImage:"url(".concat(Ra.a,")"),backgroundSize:"cover",display:"flex",height:"100%",justifyContent:"center"},e.breakpoints.up("lg"),{backgroundSize:"initial",justifyContent:"flex-end"}),panel:Object(St.a)({borderRadius:"1rem",maxHeight:"90%",overflowY:"scroll",padding:"4rem 2rem",position:"relative",width:"80%"},e.breakpoints.up("lg"),{borderRadius:"0",height:"100%",maxHeight:"100%",width:"40%"}),progress:{height:10,left:"0",position:"absolute",top:"0",width:"100%"}}})),Qa=function(){var e=Ka();return c.a.createElement("span",{className:e.aboutLink},c.a.createElement(ge.a,{arrow:!0,enterTouchDelay:0,title:"Learn more"},c.a.createElement(Ga.a,{to:"/about"},c.a.createElement(Qe.a,{color:"secondary",fontSize:"small"}))))},Ya=function(){var e=Ka();return c.a.createElement("div",{className:e.loginLink},c.a.createElement(Ga.a,{to:"/login"},c.a.createElement(D.a,{color:"secondary",startIcon:c.a.createElement(qa.a,null)},"Login")))},Ja=Object(r.c)((function(e){return Object(Y.a)(Object(Y.a)({},e.auth),{},{currentUser:e.common.currentUser,pathname:e.router.location.pathname})}),(function(e){return{onUnload:function(){return e({type:"LOGIN_PAGE_UNLOADED"})}}}))((function(e){var t=e.currentUser,a=e.inProgress,n=e.onUnload,r=e.pathname,s=Ka();return Object(o.useEffect)((function(){return function(){return n()}}),[]),t?c.a.createElement(i.a,{to:"/"}):c.a.createElement(Pa.a,null,c.a.createElement("div",{className:s.page},c.a.createElement(ee.a,{elevation:12,className:s.panel},a&&c.a.createElement(Fa.a,{className:s.progress}),c.a.createElement(te.a,{container:!0,spacing:4},c.a.createElement(te.a,{item:!0,xs:12},c.a.createElement(C,{className:s.logo})),c.a.createElement(te.a,{item:!0,xs:12},r.includes("about")?c.a.createElement(c.a.Fragment,null,c.a.createElement(Ya,null),c.a.createElement(Va,null)):c.a.createElement(c.a.Fragment,null,c.a.createElement(Qa,null),c.a.createElement(za,null)))))))})),$a=a(328),Za=function(e){var t=e.snackbar,a=Object($a.b)().enqueueSnackbar;return Object(o.useEffect)((function(){t&&a(t.message,{variant:t.variant})}),[t]),e.children},Xa=Object(r.c)((function(e){return{snackbar:e.notifier.snackbar}}),(function(e){return{onSnackbarClose:function(){return e({type:"SNACKBAR_CLOSED"})}}}))((function(e){var t=c.a.createRef(),a=function(e){return function(){t.current.closeSnackbar(e)}};return c.a.createElement($a.a,{maxSnack:3,ref:t,action:function(e){return c.a.createElement(D.a,{onClick:a(e)},"Dismiss")},onClose:function(){e.onSnackbarClose()}},c.a.createElement(Za,{snackbar:e.snackbar},e.children))})),en=a(77),tn=a(444),an=a(78),nn=(a(565),a(420)),rn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:if(t.subtype===k||"REGISTER"===t.subtype)return Object(Y.a)(Object(Y.a)({},e),{},{inProgress:!0});break;case k:case"REGISTER":return Object(Y.a)(Object(Y.a)({},e),{},{inProgress:!1,errors:t.error?t.payload.errors:null});case"LOGIN_PAGE_UNLOADED":case"REGISTER_PAGE_UNLOADED":return{};default:return e}return e},on={appName:"Chem Cash",token:null,viewChangeCounter:0},cn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:on,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"APP_LOAD":return Object(Y.a)(Object(Y.a)({},e),{},{token:t.token||null,appLoaded:!0,currentUser:t.payload?t.payload.user:null,settings:t.payload?t.payload.settings:null});case"LOGOUT":return Object(Y.a)(Object(Y.a)({},e),{},{redirectTo:"/login",token:null,currentUser:null});case k:case"REGISTER":return Object(Y.a)(Object(Y.a)({},e),{},{redirectTo:t.error?null:"/",token:t.error?null:t.payload.user.token,currentUser:t.error?null:t.payload.user,settings:t.error?null:t.payload.settings});case"LOGIN_PAGE_UNLOADED":case"REGISTER_PAGE_UNLOADED":case"SETTINGS_PAGE_UNLOADED":return Object(Y.a)(Object(Y.a)({},e),{},{viewChangeCounter:e.viewChangeCounter+1});case"NAV_LOADED":case"NAV_TAB_CHANGE":return Object(Y.a)(Object(Y.a)({},e),{},{redirectTo:t.redirectTo});case"REDIRECT":return Object(Y.a)(Object(Y.a)({},e),{},{redirectTo:null});case"SETTINGS_SAVED":return Object(Y.a)(Object(Y.a)({},e),{},{currentUser:t.error?e.currentUser:t.payload[0].user,settings:t.error?e.settings:t.payload[1].settings});case"SPOTIFY_REMOVE_AUTH":return Object(Y.a)(Object(Y.a)({},e),{},{settings:t.error?e.settings:Object(Y.a)(Object(Y.a)({},e.settings),{},{spotifyTokens:void 0})});default:return e}},sn={courses:[],errors:null,importCount:null,inProgress:!1,pageLoaded:!1},ln=function(e,t){return e.lastName.localeCompare(t.lastName)},un=function(e,t){return e.period-t.period},mn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sn,t=arguments.length>1?arguments[1]:void 0,a=[];switch(t.type){case"ADD_COURSE":return Object(Y.a)(Object(Y.a)({},e),{},{courses:t.error?e.courses:[].concat(Object(me.a)(e.courses),[t.payload.course]).sort((function(e,t){return un(e,t)})),errors:t.error?t.payload.errors:null,inProgress:!1});case"ADD_STUDENT":return a=[],e.courses.forEach((function(e){var n=Object(Y.a)({},e);e._id.toString()===t.courseId&&(n.students=[].concat(Object(me.a)(e.students),[t.payload.user]).sort((function(e,t){return ln(e,t)}))),a.push(n)})),Object(Y.a)(Object(Y.a)({},e),{},{courses:t.error?e.courses:a,errors:t.error?t.payload.errors:null,inProgress:!1});case"ALERT_CLOSED":return Object(Y.a)(Object(Y.a)({},e),{},{importCount:null});case _:if("ADD_STUDENT"===t.subtype||"ADD_COURSE"===t.subtype||"UPDATE_COURSE"===t.subtype||"UPDATE_STUDENT"===t.subtype)return Object(Y.a)(Object(Y.a)({},e),{},{errors:null,inProgress:!0});if("COURSES_PAGE_LOADED"===t.subtype)return Object(Y.a)(Object(Y.a)({},e),{},{errors:null,pageLoaded:!0});if("IMPORT_STUDENTS"===t.subtype)return Object(Y.a)(Object(Y.a)({},e),{},{errors:null,importCount:null,inProgress:!0});break;case"COURSE_DIALOG_UNLOADED":case"STUDENT_DIALOG_UNLOADED":return Object(Y.a)(Object(Y.a)({},e),{},{errors:null});case"COURSES_PAGE_LOADED":case"STUDENT_SEARCH_LOADED":return Object(Y.a)(Object(Y.a)({},e),{},{courses:t.payload.courses,pageLoaded:!1});case"COURSES_PAGE_UNLOADED":case"STUDENT_SEARCH_UNLOADED":return sn;case"DELETE_COURSE":return Object(Y.a)(Object(Y.a)({},e),{},{courses:t.error?e.courses:e.courses.filter((function(e){return e.slug!==t.payload.course.slug}))});case"DELETE_STUDENT":return a=[],e.courses.forEach((function(e){var n=Object(Y.a)({},e);e._id.toString()===t.payload.course._id.toString()&&(n.students=e.students.filter((function(e){return e.username!==t.payload.user.username}))),a.push(n)})),Object(Y.a)(Object(Y.a)({},e),{},{courses:t.error?e.courses:a});case"IMPORT_STUDENTS":return!t.error&&t.payload.course.students.sort((function(e,t){return ln(e,t)})),Object(Y.a)(Object(Y.a)({},e),{},{courses:t.error?e.courses:e.courses.map((function(e){return e._id===t.payload.course._id?t.payload.course:e})),errors:t.error?t.payload.errors:null,importCount:t.error?null:t.payload.count,inProgress:!1});case"RESET_STUDENT_PASSWORD":return Object(Y.a)({},e);case"UPDATE_COURSE":return Object(Y.a)(Object(Y.a)({},e),{},{courses:t.error?e.courses:e.courses.map((function(e){return e._id===t.payload.course._id?t.payload.course:e})).sort((function(e,t){return un(e,t)})),errors:t.error?t.payload.errors:null,inProgress:!1});case"UPDATE_STUDENT":a=[];var n=t.payload.user;return e.courses.forEach((function(e){var r=Object(Y.a)({},e);e._id.toString()===t.courseId.toString()&&(r.students=e.students.map((function(e){return e._id.toString()===n._id.toString()?n:e})).sort((function(e,t){return ln(e,t)}))),a.push(r)})),Object(Y.a)(Object(Y.a)({},e),{},{courses:t.error?e.courses:a,errors:t.error?t.payload.errors:null,inProgress:!1});default:return e}return e},dn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NAV_LOADED":case"NAV_TAB_CHANGE":return Object(Y.a)(Object(Y.a)({},e),{},{navTabValue:t.value});case"NAV_UNLOADED":return{};default:return e}},pn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_COURSE":case"ADD_STUDENT":case"ADD_TEACHER":case"ADD_TRANSACTION":case"ADD_TRANSACTIONS":case"DELETE_COURSE":case"DELETE_SONG_REQUEST":case"DELETE_STUDENT":case"DELETE_TASK":case"DELETE_TEACHER":case"DELETE_TRANSACTION":case"IMPORT_SCORES":case"IMPORT_STUDENTS":case"RESET_STUDENT_PASSWORD":case"SETTINGS_SAVED":case"SUBMIT_SONG_REQUEST":case"UPDATE_COURSE":case"UPDATE_STUDENT":case"UPDATE_TASK":case"UPDATE_TEACHER":case"UPDATE_TRANSACTION":return Object(Y.a)(Object(Y.a)({},e),{},{snackbar:t.error?null:t.snackbar});case"SNACKBAR_CLOSED":return Object(Y.a)(Object(Y.a)({},e),{},{snackbar:null});default:return e}},En=a(445),fn={conversions:null,errors:null,importSummary:null,inProgress:!1,total:null,transactions:null},bn=function(e,t){var a=function(e,t){return e+t.amount},n=e.bonuses.reduce(a,0),r=e.purchases.reduce(a,0),o=e.scores.reduce((function(e,a){return e+xe(a,t)}),0);return{balance:n+r+o,bonuses:n,purchases:r,scores:o}},gn=function(e,t,a){if(a){var n=a._id.toString(),r=e.filter((function(e){return e.student._id.toString()===n}));return r&&(t.scores=Object(En.unionBy)(r,Object(me.a)(t.scores),"_id")),t}return null},On=function(e,t){for(var a=0,n=Object.keys(t);a<n.length;a++){var r=n[a];r.startsWith(e.type)&&(t[r]=[e].concat(Object(me.a)(t[r])))}return t},hn=function(e,t,a){if(a){var n=a._id.toString(),r=e.find((function(e){return e.student._id.toString()===n}));if(r)return On(r,t)}return null},yn=function(e,t){for(var a=0,n=Object.keys(t);a<n.length;a++){var r=n[a];r.startsWith(e.type)&&(t[r]=t[r].filter((function(t){return t._id!==e._id})))}return t},vn=function(e,t){for(var a=0,n=Object.keys(t);a<n.length;a++){var r=n[a];r.startsWith(e.type)&&(t[r]=t[r].map((function(t){return t._id===e._id?e:t})))}return t},Sn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ACCOUNT_VIEW_LOADED":return Object(Y.a)(Object(Y.a)({},e),{},{conversions:t.error?null:t.payload.scoreConverter,total:t.error?null:bn(t.payload.transactions,t.payload.scoreConverter),transactions:t.error?null:t.payload.transactions});case"ACCOUNT_VIEW_UNLOADED":return Object(Y.a)(Object(Y.a)({},e),{},{conversions:null,total:null,transactions:null});case"ACCOUNTS_PAGE_UNLOADED":case"ALERT_CLOSED":return Object(Y.a)(Object(Y.a)({},e),{},{importSummary:null});case"ADD_TRANSACTION":var a=t.error?{}:On(t.payload.transaction,Object(Y.a)({},e.transactions));return Object(Y.a)(Object(Y.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:a,total:t.error?e.total:bn(a,e.conversions)});case"ADD_TRANSACTIONS":var n=t.error?null:hn(t.payload.transactions,Object(Y.a)({},e.transactions),t.curStudent);return Object(Y.a)(Object(Y.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:n,total:t.error||!e.transactions?e.total:bn(n,e.conversions)});case _:if("ADD_TRANSACTION"===t.subtype||"ADD_TRANSACTIONS"===t.subtype||"DELETE_TRANSACTION"===t.subtype||"UPDATE_TRANSACTION"===t.subtype)return Object(Y.a)(Object(Y.a)({},e),{},{errors:null,inProgress:!0});if("IMPORT_SCORES"===t.subtype)return Object(Y.a)(Object(Y.a)({},e),{},{errors:null,importSummary:null,inProgress:!0});break;case"DELETE_TRANSACTION":var r=t.error?{}:yn(t.payload.transaction,Object(Y.a)({},e.transactions));return Object(Y.a)(Object(Y.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:r,total:t.error?e.total:bn(r,e.conversions)});case"IMPORT_SCORES":var o=t.error?null:gn(t.payload.scores,Object(Y.a)({},e.transactions),t.curStudent);return Object(Y.a)(Object(Y.a)({},e),{},{errors:t.error?t.payload.errors:null,importSummary:t.error?null:t.payload.results,inProgress:!1,transactions:t.error?e.transactions:o,total:t.error||!e.transactions?e.total:bn(o,e.conversions)});case"IMPORT_SCORES_DIALOG_UNLOADED":case"TRANSACTION_DIALOG_UNLOADED":case"TRANSACTIONS_DIALOG_UNLOADED":return Object(Y.a)(Object(Y.a)({},e),{},{errors:null});case"UPDATE_TRANSACTION":var c=t.error?{}:vn(t.payload.transaction,Object(Y.a)({},e.transactions));return Object(Y.a)(Object(Y.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,transactions:t.error?e.transactions:c,total:t.error?e.total:bn(c,e.conversions)});default:return e}return e},jn={errors:null,inProgress:!1,spotifyAuthUrl:null},An=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:if("SETTINGS_SAVED"===t.subtype)return Object(Y.a)(Object(Y.a)({},e),{},{inProgress:!0});break;case"SPOTIFY_LINKER_LOADED":return Object(Y.a)(Object(Y.a)({},e),{},{spotifyAuthUrl:t.payload.spotifyAuthUrl});case"SETTINGS_PAGE_UNLOADED":case"SPOTIFY_LINKER_UNLOADED":return jn;case"SETTINGS_SAVED":return Object(Y.a)(Object(Y.a)({},e),{},{inProgress:!1,errors:t.error?t.payload.errors:null});default:return e}return e},Dn={errors:null,inProgress:!1,tasks:[]},Nn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:if("TASKS_DIALOG_LOADED"===t.subtype)return Object(Y.a)(Object(Y.a)({},e),{},{inProgress:!0});break;case"DELETE_TASK":return Object(Y.a)(Object(Y.a)({},e),{},{tasks:t.error?e.tasks:e.tasks.filter((function(e){return e.slug!==t.payload.task.slug}))});case"TASKS_DIALOG_LOADED":return Object(Y.a)(Object(Y.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,tasks:t.error?[]:t.payload.tasks});case"TASKS_DIALOG_UNLOADED":return Dn;case"UPDATE_TASK":return Object(Y.a)(Object(Y.a)({},e),{},{tasks:t.error?e.tasks:e.tasks.map((function(e){return e.slug===t.payload.task.slug?t.payload.task:e}))});default:return e}return e},Tn={errors:null,inProgress:!1,teachers:[]},Cn=function(e,t){return e.lastName.localeCompare(t.lastName)},_n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TEACHER":return Object(Y.a)(Object(Y.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,teachers:t.error?e.teachers:[].concat(Object(me.a)(e.teachers),[t.payload.user]).sort((function(e,t){return Cn(e,t)}))});case _:if("ADD_TEACHER"===t.subtype||"UPDATE_TEACHER"===t.subtype)return Object(Y.a)(Object(Y.a)({},e),{},{inProgress:!0,errors:null});break;case"DELETE_TEACHER":return Object(Y.a)(Object(Y.a)({},e),{},{teachers:t.error?e.teachers:e.teachers.filter((function(e){return e.username!==t.payload.user.username}))});case"MANAGE_TEACHERS_PAGE_LOADED":return Object(Y.a)(Object(Y.a)({},e),{},{teachers:t.payload.users});case"MANAGE_TEACHERS_PAGE_UNLOADED":return Tn;case"TEACHER_DIALOG_UNLOADED":return Object(Y.a)(Object(Y.a)({},e),{},{errors:null});case"UPDATE_TEACHER":return Object(Y.a)(Object(Y.a)({},e),{},{errors:t.error?t.payload.errors:null,inProgress:!1,teachers:t.error?e.teachers:e.teachers.map((function(e){return e.username===t.payload.user.username?t.payload.user:e})).sort((function(e,t){return Cn(e,t)}))});default:return e}return e},kn={course:null,courses:[],courseSongs:[],errors:null,inProgress:!1,userSongs:[]},Un=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kn,t=arguments.length>1?arguments[1]:void 0,a=[];switch(t.type){case _:if("UPDATE_SONG_REQUEST"===t.subtype)return Object(Y.a)(Object(Y.a)({},e),{},{inProgress:!0,errors:null});break;case"DELETE_SONG_REQUEST":return e.courses.forEach((function(e){var n=Object(Y.a)({},e);n.songs=n.songs.filter((function(e){return e._id.toString()!==t.payload.song._id.toString()})),a.push(n)})),Object(Y.a)(Object(Y.a)({},e),{},{courses:t.error?e.courses:a});case"SONG_REQUESTS_DIALOG_UNLOADED":return Object(Y.a)(Object(Y.a)({},e),{},{errors:null});case"SONGS_PAGE_UNLOADED":return kn;case"STUDENT_SONGS_PAGE_LOADED":return Object(Y.a)(Object(Y.a)({},e),{},{userSongs:t.payload.songsByUser,courseSongs:t.payload.songsByCourse,course:t.payload.course});case"SUBMIT_SONG_REQUEST":return Object(Y.a)(Object(Y.a)({},e),{},{userSongs:[t.payload.song].concat(Object(me.a)(e.userSongs)),courseSongs:[t.payload.song].concat(Object(me.a)(e.courseSongs))});case"TEACHER_SONGS_PAGE_LOADED":return Object(Y.a)(Object(Y.a)({},e),{},{courses:t.payload.courses});case"UPDATE_SONG_REQUEST":return!t.error&&e.courses.forEach((function(e){var n=Object(Y.a)({},e);n.songs=n.songs.map((function(e){return e._id.toString()===t.payload.song._id.toString()?t.payload.song:e})),a.push(n)})),Object(Y.a)(Object(Y.a)({},e),{},{courses:t.error?e.courses:a,errors:t.error?t.payload.errors:null,inProgress:!1});default:return e}return e},wn=function(e){return function(t){return function(a){if((o=a.payload)&&"function"===typeof o.then){e.dispatch({type:_,subtype:a.type});var n=e.getState().viewChangeCounter,r=a.skipTracking;a.payload.then((function(t){var o=e.getState();(r||o.viewChangeCounter===n)&&(a.payload=t,e.dispatch({type:"ASYNC_END",promise:a.payload}),e.dispatch(a))}),(function(t){var o=e.getState();(r||o.viewChangeCounter===n)&&(a.error=!0,a.payload=t.response.body,a.skipTracking||e.dispatch({type:"ASYNC_END",promise:a.payload}),e.dispatch(a))}))}else{var o;t(a)}}}},Pn=function(e){return function(e){return function(t){"REGISTER"===t.type||t.type===k?t.error||(window.localStorage.setItem("jwt",t.payload.user.token),le.a.setToken(t.payload.user.token)):"LOGOUT"===t.type&&(window.localStorage.setItem("jwt",""),le.a.setToken(null)),e(t)}}};var xn,Rn=Object(an.a)(),Ln=Object(nn.a)(Rn),In=Object(en.createStore)((xn=Rn,Object(en.combineReducers)({auth:rn,common:cn,courses:mn,nav:dn,notifier:pn,scores:Sn,settings:An,tasks:Nn,teachers:_n,songs:Un,router:Object(n.b)(xn)})),Object(tn.composeWithDevTools)(Object(en.applyMiddleware)(Ln,wn,Pn))),Gn=Object(r.c)((function(e){return{appLoaded:e.common.appLoaded,redirectTo:e.common.redirectTo}}),(function(e){return{onLoad:function(t,a){return e({type:"APP_LOAD",payload:t,token:a,skipTracking:!0})},onRedirect:function(){return e({type:"REDIRECT"})}}}))((function(e){var t=e.appLoaded,a=e.redirectTo;return Object(o.useEffect)((function(){a&&(In.dispatch(Object(u.d)(a)),e.onRedirect())}),[a]),Object(o.useEffect)((function(){var t=window.localStorage.getItem("jwt");t&&le.a.setToken(t),e.onLoad(t?le.a.Auth.current():null,t)}),[]),t?c.a.createElement(m.a,{theme:h},c.a.createElement(d.a,null),c.a.createElement(Xa,null,c.a.createElement(o.Suspense,{fallback:c.a.createElement("p",null,"Loading...")},c.a.createElement(i.d,null,c.a.createElement(i.b,{exact:!0,path:"/login",component:Ja}),c.a.createElement(i.b,{exact:!0,path:"/about",component:Ja}),c.a.createElement(i.b,{path:"/",component:Ua}))))):c.a.createElement(m.a,{theme:h},c.a.createElement(d.a,null),c.a.createElement(Ia,null))}));l.a.render(c.a.createElement(r.a,{store:In},c.a.createElement(n.a,{history:Rn},c.a.createElement(i.d,null,c.a.createElement(i.b,{path:"/",component:Gn})))),document.getElementById("root"))}},[[454,1,2]]]);
//# sourceMappingURL=main.64946d7e.chunk.js.map